[0m12:15:12.088516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1A614830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1A9A43B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1A9A6A80>]}


============================== 12:15:12.096813 | 2d8b6855-d787-4858-90bf-c72e76f37285 ==============================
[0m12:15:12.096813 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:15:12.097797 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt debug', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m12:15:12.114143 [info ] [MainThread]: dbt version: 1.10.13
[0m12:15:12.115175 [info ] [MainThread]: python version: 3.12.10
[0m12:15:12.115175 [info ] [MainThread]: python path: C:\Users\delma\AppData\Local\Programs\Python\Python312\python.exe
[0m12:15:12.115175 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:15:16.513319 [info ] [MainThread]: Using profiles dir at C:\Users\delma\.dbt
[0m12:15:16.514669 [info ] [MainThread]: Using profiles.yml file at C:\Users\delma\.dbt\profiles.yml
[0m12:15:16.515587 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\dbt_project.yml
[0m12:15:16.516674 [info ] [MainThread]: adapter type: duckdb
[0m12:15:16.517709 [info ] [MainThread]: adapter version: 1.9.6
[0m12:15:16.589838 [info ] [MainThread]: Configuration:
[0m12:15:16.590948 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:15:16.592268 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:15:16.592268 [info ] [MainThread]: Required dependencies:
[0m12:15:16.593416 [debug] [MainThread]: Executing "git --help"
[0m12:15:16.595773 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:15:16.597780 [info ] [MainThread]: Connection:
[0m12:15:16.599793 [info ] [MainThread]:   database: warehouse
[0m12:15:16.602104 [info ] [MainThread]:   schema: main
[0m12:15:16.603235 [info ] [MainThread]:   path: warehouse.duckdb
[0m12:15:16.604486 [info ] [MainThread]:   config_options: None
[0m12:15:16.605435 [info ] [MainThread]:   extensions: None
[0m12:15:16.606559 [info ] [MainThread]:   settings: {}
[0m12:15:16.607481 [info ] [MainThread]:   external_root: .
[0m12:15:16.608435 [info ] [MainThread]:   use_credential_provider: None
[0m12:15:16.608435 [info ] [MainThread]:   attach: None
[0m12:15:16.609542 [info ] [MainThread]:   filesystems: None
[0m12:15:16.610475 [info ] [MainThread]:   remote: None
[0m12:15:16.611831 [info ] [MainThread]:   plugins: None
[0m12:15:16.611831 [info ] [MainThread]:   disable_transactions: False
[0m12:15:16.613025 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:15:16.780194 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:15:16.829602 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:15:16.829602 [debug] [MainThread]: On debug: select 1 as id
[0m12:15:16.829602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:16.845289 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m12:15:16.846272 [debug] [MainThread]: On debug: Close
[0m12:15:16.846272 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:15:16.847289 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:15:16.847289 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:15:16.848273 [debug] [MainThread]: Command `dbt debug` failed at 12:15:16.848273 after 5.00 seconds
[0m12:15:16.848273 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:15:16.848273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1AE3EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1ADF69C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1A87F0B0>]}
[0m12:15:16.848273 [debug] [MainThread]: Flushing usage events
[0m12:15:17.805028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:03.230257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00DC32870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00DF164B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00D516540>]}


============================== 12:19:03.233457 | e605187f-b51d-464e-a887-26f900faf7d9 ==============================
[0m12:19:03.233457 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:19:03.233457 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m12:19:03.244713 [info ] [MainThread]: dbt version: 1.10.13
[0m12:19:03.244713 [info ] [MainThread]: python version: 3.12.10
[0m12:19:03.245714 [info ] [MainThread]: python path: C:\Users\delma\AppData\Local\Programs\Python\Python312\python.exe
[0m12:19:03.245714 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:19:03.311020 [info ] [MainThread]: Using profiles dir at C:\Users\delma\.dbt
[0m12:19:03.311020 [info ] [MainThread]: Using profiles.yml file at C:\Users\delma\.dbt\profiles.yml
[0m12:19:03.311020 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\dbt_project.yml
[0m12:19:03.316960 [info ] [MainThread]: adapter type: duckdb
[0m12:19:03.316960 [info ] [MainThread]: adapter version: 1.9.6
[0m12:19:03.396040 [info ] [MainThread]: Configuration:
[0m12:19:03.396040 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:19:03.397039 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:19:03.398043 [info ] [MainThread]: Required dependencies:
[0m12:19:03.398043 [debug] [MainThread]: Executing "git --help"
[0m12:19:03.401042 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:19:03.402238 [info ] [MainThread]: Connection:
[0m12:19:03.402238 [info ] [MainThread]:   database: warehouse
[0m12:19:03.403237 [info ] [MainThread]:   schema: main
[0m12:19:03.404235 [info ] [MainThread]:   path: warehouse.duckdb
[0m12:19:03.404235 [info ] [MainThread]:   config_options: None
[0m12:19:03.405235 [info ] [MainThread]:   extensions: None
[0m12:19:03.405235 [info ] [MainThread]:   settings: {}
[0m12:19:03.405235 [info ] [MainThread]:   external_root: .
[0m12:19:03.406264 [info ] [MainThread]:   use_credential_provider: None
[0m12:19:03.406264 [info ] [MainThread]:   attach: None
[0m12:19:03.406264 [info ] [MainThread]:   filesystems: None
[0m12:19:03.407238 [info ] [MainThread]:   remote: None
[0m12:19:03.407238 [info ] [MainThread]:   plugins: None
[0m12:19:03.407238 [info ] [MainThread]:   disable_transactions: False
[0m12:19:03.408236 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:19:03.567830 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:19:03.611283 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:19:03.611283 [debug] [MainThread]: On debug: select 1 as id
[0m12:19:03.611283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:03.621544 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m12:19:03.622529 [debug] [MainThread]: On debug: Close
[0m12:19:03.622529 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:19:03.622529 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:19:03.622529 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:19:03.623981 [debug] [MainThread]: Command `dbt debug` failed at 12:19:03.623981 after 0.54 seconds
[0m12:19:03.623981 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:19:03.623981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00DC329F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00FA51430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00FA50830>]}
[0m12:19:03.623981 [debug] [MainThread]: Flushing usage events
[0m12:19:04.563548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:53.051688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB185E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAADE8B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB1000E00>]}


============================== 16:02:53.051688 | f0e2306a-8a8d-4d13-abbd-1fe89259ef43 ==============================
[0m16:02:53.051688 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:02:53.051688 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:02:53.198802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB2A2F3E0>]}
[0m16:02:53.246600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAE99F5C0>]}
[0m16:02:53.250608 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:02:53.401700 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:02:53.401700 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:02:53.401700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB2AB7C20>]}
[0m16:02:54.090427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB36F9730>]}
[0m16:02:54.128702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:02:54.130448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:02:54.150655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB32C2B10>]}
[0m16:02:54.150655 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m16:02:54.150655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB36B94C0>]}
[0m16:02:54.150655 [info ] [MainThread]: 
[0m16:02:54.160824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:54.160824 [info ] [MainThread]: 
[0m16:02:54.160824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:02:54.163864 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m16:02:54.220996 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:02:54.220996 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:02:54.220996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:54.231124 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:02:54.231124 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:02:54.241203 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:02:54.241203 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:02:54.241203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:54.243036 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:02:54.243036 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:02:54.243036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stage)
[0m16:02:54.243036 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m16:02:54.247951 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:02:54.247951 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:02:54.247951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:54.247951 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:02:54.247951 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:02:54.247951 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m16:02:54.247951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:54.247951 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:02:54.247951 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m16:02:54.247951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:54.247951 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:02:54.251647 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:02:54.251647 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:02:54.253657 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:02:54.253657 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m16:02:54.253657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_stage, now create_warehouse_main_marts)
[0m16:02:54.253657 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m16:02:54.255661 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:02:54.255661 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:02:54.255661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:54.255661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:02:54.255661 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:02:54.257665 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m16:02:54.257665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:54.257665 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:02:54.257665 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m16:02:54.257665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:54.257665 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:02:54.257665 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:02:54.257665 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:02:54.257665 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:02:54.257665 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m16:02:54.261796 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m16:02:54.264748 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:02:54.264748 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m16:02:54.264748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:54.264748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:54.264748 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:02:54.264748 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m16:02:54.271803 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:02:54.271803 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m16:02:54.271803 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m16:02:54.271803 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m16:02:54.271803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m16:02:54.271803 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:02:54.271803 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m16:02:54.271803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:54.282104 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:54.282104 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:02:54.282104 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m16:02:54.283949 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:02:54.283949 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m16:02:54.283949 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m16:02:54.283949 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m16:02:54.283949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB3715E80>]}
[0m16:02:54.283949 [debug] [MainThread]: Using duckdb connection "master"
[0m16:02:54.283949 [debug] [MainThread]: On master: BEGIN
[0m16:02:54.283949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:54.283949 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:02:54.283949 [debug] [MainThread]: On master: COMMIT
[0m16:02:54.283949 [debug] [MainThread]: Using duckdb connection "master"
[0m16:02:54.283949 [debug] [MainThread]: On master: COMMIT
[0m16:02:54.283949 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:02:54.283949 [debug] [MainThread]: On master: Close
[0m16:02:54.292117 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m16:02:54.292117 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m16:02:54.292117 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m16:02:54.292117 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m16:02:54.292117 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m16:02:54.292117 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m16:02:54.314487 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m16:02:54.314487 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:02:54.316492 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m16:02:54.316492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:02:54.316492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:02:54.316492 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:02:54.316492 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:02:54.322516 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:02:54.322516 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:02:54.322516 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: ROLLBACK
[0m16:02:54.328856 [debug] [Thread-1 (]: Failed to rollback 'model.tv_audience_mini.stg_audience'
[0m16:02:54.328856 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m16:02:54.330815 [debug] [Thread-1 (]: Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^
[0m16:02:54.332555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB3C00B00>]}
[0m16:02:54.332555 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main_stage.stg_audience ................... [[31mERROR[0m in 0.04s]
[0m16:02:54.332555 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m16:02:54.332555 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m16:02:54.332555 [debug] [Thread-4 (]: Marking all children of 'model.tv_audience_mini.stg_audience' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^.
[0m16:02:54.332555 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m16:02:54.332555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m16:02:54.332555 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m16:02:54.332555 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m16:02:54.338068 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m16:02:54.340074 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m16:02:54.340074 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:02:54.340074 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m16:02:54.340074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:54.340074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:02:54.342080 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:02:54.342080 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:02:54.342080 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:02:54.342080 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:02:54.342080 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: ROLLBACK
[0m16:02:54.344085 [debug] [Thread-1 (]: Failed to rollback 'model.tv_audience_mini.stg_dim_channels'
[0m16:02:54.344085 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m16:02:54.346090 [debug] [Thread-1 (]: Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^
[0m16:02:54.346090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e2306a-8a8d-4d13-abbd-1fe89259ef43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB3B79FA0>]}
[0m16:02:54.346090 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main_stage.stg_dim_channels ............... [[31mERROR[0m in 0.01s]
[0m16:02:54.346090 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m16:02:54.346090 [debug] [Thread-4 (]: Marking all children of 'model.tv_audience_mini.stg_dim_channels' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^.
[0m16:02:54.346090 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m16:02:54.346090 [info ] [Thread-1 (]: 3 of 4 SKIP relation main_marts.fact_audience .................................. [[33mSKIP[0m]
[0m16:02:54.346090 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m16:02:54.346090 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m16:02:54.346090 [info ] [Thread-1 (]: 4 of 4 SKIP relation main_marts.kpi_top10 ...................................... [[33mSKIP[0m]
[0m16:02:54.352141 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m16:02:54.352141 [debug] [MainThread]: Using duckdb connection "master"
[0m16:02:54.352141 [debug] [MainThread]: On master: BEGIN
[0m16:02:54.352141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:54.352141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:02:54.352141 [debug] [MainThread]: On master: COMMIT
[0m16:02:54.352141 [debug] [MainThread]: Using duckdb connection "master"
[0m16:02:54.352141 [debug] [MainThread]: On master: COMMIT
[0m16:02:54.354578 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:02:54.354578 [debug] [MainThread]: On master: Close
[0m16:02:54.354578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:54.354578 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m16:02:54.354578 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m16:02:54.354578 [debug] [MainThread]: Connection 'model.tv_audience_mini.stg_dim_channels' was properly closed.
[0m16:02:54.354578 [info ] [MainThread]: 
[0m16:02:54.354578 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m16:02:54.354578 [debug] [MainThread]: Command end result
[0m16:02:54.366319 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:02:54.366319 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:02:54.371218 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m16:02:54.371218 [info ] [MainThread]: 
[0m16:02:54.372723 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:02:54.372723 [info ] [MainThread]: 
[0m16:02:54.372723 [error] [MainThread]: [31mFailure in model stg_audience (models\staging\stg_audience.sql)[0m
[0m16:02:54.372723 [error] [MainThread]:   Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^
[0m16:02:54.372723 [info ] [MainThread]: 
[0m16:02:54.372723 [info ] [MainThread]:   compiled code at target\compiled\tv_audience_mini\models\staging\stg_audience.sql
[0m16:02:54.372723 [info ] [MainThread]: 
[0m16:02:54.372723 [error] [MainThread]: [31mFailure in model stg_dim_channels (models\staging\stg_dim_channels.sql)[0m
[0m16:02:54.372723 [error] [MainThread]:   Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^
[0m16:02:54.372723 [info ] [MainThread]: 
[0m16:02:54.383004 [info ] [MainThread]:   compiled code at target\compiled\tv_audience_mini\models\staging\stg_dim_channels.sql
[0m16:02:54.383004 [info ] [MainThread]: 
[0m16:02:54.383004 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m16:02:54.383004 [debug] [MainThread]: Command `dbt run` failed at 16:02:54.383004 after 1.47 seconds
[0m16:02:54.383004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB11F2CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB16710A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB16E7770>]}
[0m16:02:54.383004 [debug] [MainThread]: Flushing usage events
[0m16:02:55.205113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:26.596484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B11EF34A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B146DD4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B14417020>]}


============================== 16:08:26.599483 | e69990cd-dd85-4913-b512-16d66e103ab3 ==============================
[0m16:08:26.599483 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:08:26.600534 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:08:26.735712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e69990cd-dd85-4913-b512-16d66e103ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B168FCB90>]}
[0m16:08:26.772623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e69990cd-dd85-4913-b512-16d66e103ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B14AEAE10>]}
[0m16:08:26.774780 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:08:26.934159 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:08:27.007357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:27.007357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:27.035564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e69990cd-dd85-4913-b512-16d66e103ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B16A10770>]}
[0m16:08:27.081470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:08:27.081470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:08:27.097551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e69990cd-dd85-4913-b512-16d66e103ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B16D51340>]}
[0m16:08:27.097551 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m16:08:27.101663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e69990cd-dd85-4913-b512-16d66e103ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B12A4E600>]}
[0m16:08:27.101663 [info ] [MainThread]: 
[0m16:08:27.101663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:27.105931 [info ] [MainThread]: 
[0m16:08:27.106941 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:08:27.110949 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m16:08:27.158305 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:08:27.159299 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:08:27.159299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:27.173600 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:08:27.174620 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:08:27.175813 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:08:27.175813 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:08:27.176800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:27.176800 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:08:27.177804 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:08:27.177804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stage)
[0m16:08:27.178823 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m16:08:27.181814 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:08:27.181814 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:08:27.181814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:27.182820 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:27.183818 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:08:27.183818 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m16:08:27.184224 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:27.184224 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:08:27.184622 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m16:08:27.184622 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:27.184622 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:08:27.184622 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:08:27.185624 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:08:27.188625 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:08:27.188625 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m16:08:27.189625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_stage, now create_warehouse_main_marts)
[0m16:08:27.189625 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m16:08:27.190625 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:08:27.190625 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:08:27.190625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:27.191642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:27.192636 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:08:27.192636 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m16:08:27.192636 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:27.192636 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:08:27.192636 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m16:08:27.193642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:27.193642 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:08:27.193642 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:08:27.193642 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:08:27.194832 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:08:27.196176 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m16:08:27.197180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m16:08:27.200196 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:08:27.200196 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m16:08:27.200196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:27.201202 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:27.201202 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:08:27.201202 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m16:08:27.211487 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:08:27.212484 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m16:08:27.213509 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m16:08:27.213509 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m16:08:27.213509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m16:08:27.214487 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:08:27.214487 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m16:08:27.214487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:27.215685 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:27.215685 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:08:27.215685 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m16:08:27.217684 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:08:27.217684 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m16:08:27.218712 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m16:08:27.218712 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m16:08:27.219683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e69990cd-dd85-4913-b512-16d66e103ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B120CB680>]}
[0m16:08:27.219683 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:27.219683 [debug] [MainThread]: On master: BEGIN
[0m16:08:27.219683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:27.219683 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:08:27.220684 [debug] [MainThread]: On master: COMMIT
[0m16:08:27.220684 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:27.220684 [debug] [MainThread]: On master: COMMIT
[0m16:08:27.220684 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:08:27.220684 [debug] [MainThread]: On master: Close
[0m16:08:27.223683 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m16:08:27.223683 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m16:08:27.225866 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m16:08:27.225866 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m16:08:27.229379 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m16:08:27.230380 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m16:08:27.247875 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m16:08:27.248877 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:08:27.248877 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m16:08:27.248877 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:27.249872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:08:27.249872 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:08:27.249872 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:08:27.250873 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:08:27.250873 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:08:27.250873 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: ROLLBACK
[0m16:08:27.253872 [debug] [Thread-1 (]: Failed to rollback 'model.tv_audience_mini.stg_audience'
[0m16:08:27.253872 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m16:08:27.256101 [debug] [Thread-1 (]: Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^
[0m16:08:27.257103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e69990cd-dd85-4913-b512-16d66e103ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B170C2780>]}
[0m16:08:27.257103 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main_stage.stg_audience ................... [[31mERROR[0m in 0.03s]
[0m16:08:27.258086 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m16:08:27.258086 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m16:08:27.259085 [debug] [Thread-4 (]: Marking all children of 'model.tv_audience_mini.stg_audience' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^.
[0m16:08:27.259085 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m16:08:27.260085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m16:08:27.260085 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m16:08:27.261085 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m16:08:27.262087 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m16:08:27.264102 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m16:08:27.265251 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:08:27.265251 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m16:08:27.265251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:27.266335 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:08:27.266335 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:08:27.266335 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:08:27.267334 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:08:27.267334 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:08:27.267334 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: ROLLBACK
[0m16:08:27.269352 [debug] [Thread-1 (]: Failed to rollback 'model.tv_audience_mini.stg_dim_channels'
[0m16:08:27.269352 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m16:08:27.270351 [debug] [Thread-1 (]: Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^
[0m16:08:27.271351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e69990cd-dd85-4913-b512-16d66e103ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B17199370>]}
[0m16:08:27.271351 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main_stage.stg_dim_channels ............... [[31mERROR[0m in 0.01s]
[0m16:08:27.272352 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m16:08:27.272352 [debug] [Thread-4 (]: Marking all children of 'model.tv_audience_mini.stg_dim_channels' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^.
[0m16:08:27.273335 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m16:08:27.273335 [info ] [Thread-1 (]: 3 of 4 SKIP relation main_marts.fact_audience .................................. [[33mSKIP[0m]
[0m16:08:27.274500 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m16:08:27.274500 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m16:08:27.274500 [info ] [Thread-1 (]: 4 of 4 SKIP relation main_marts.kpi_top10 ...................................... [[33mSKIP[0m]
[0m16:08:27.276590 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m16:08:27.276590 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:27.277589 [debug] [MainThread]: On master: BEGIN
[0m16:08:27.277589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:27.277589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:08:27.277589 [debug] [MainThread]: On master: COMMIT
[0m16:08:27.277589 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:27.278606 [debug] [MainThread]: On master: COMMIT
[0m16:08:27.278606 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:08:27.278606 [debug] [MainThread]: On master: Close
[0m16:08:27.278606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:27.278606 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m16:08:27.278606 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m16:08:27.279591 [debug] [MainThread]: Connection 'model.tv_audience_mini.stg_dim_channels' was properly closed.
[0m16:08:27.279591 [info ] [MainThread]: 
[0m16:08:27.279591 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m16:08:27.280590 [debug] [MainThread]: Command end result
[0m16:08:27.290791 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:08:27.292793 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:08:27.296044 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m16:08:27.296044 [info ] [MainThread]: 
[0m16:08:27.298047 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:08:27.298047 [info ] [MainThread]: 
[0m16:08:27.299062 [error] [MainThread]: [31mFailure in model stg_audience (models\staging\stg_audience.sql)[0m
[0m16:08:27.300045 [error] [MainThread]:   Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^
[0m16:08:27.301068 [info ] [MainThread]: 
[0m16:08:27.302079 [info ] [MainThread]:   compiled code at target\compiled\tv_audience_mini\models\staging\stg_audience.sql
[0m16:08:27.303043 [info ] [MainThread]: 
[0m16:08:27.304044 [error] [MainThread]: [31mFailure in model stg_dim_channels (models\staging\stg_dim_channels.sql)[0m
[0m16:08:27.304044 [error] [MainThread]:   Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^
[0m16:08:27.304044 [info ] [MainThread]: 
[0m16:08:27.306246 [info ] [MainThread]:   compiled code at target\compiled\tv_audience_mini\models\staging\stg_dim_channels.sql
[0m16:08:27.306246 [info ] [MainThread]: 
[0m16:08:27.307246 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m16:08:27.308688 [debug] [MainThread]: Command `dbt run` failed at 16:08:27.308688 after 0.91 seconds
[0m16:08:27.308688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B14526F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B169C79B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B143EF590>]}
[0m16:08:27.308688 [debug] [MainThread]: Flushing usage events
[0m16:08:28.107459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:32.955382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AA28E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AA1FF5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AA1FECC0>]}


============================== 16:10:32.955382 | a76b3efc-2e9e-4e49-aff0-a44e34c16760 ==============================
[0m16:10:32.955382 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:10:32.955382 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m16:10:33.093069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a76b3efc-2e9e-4e49-aff0-a44e34c16760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AC1D99D0>]}
[0m16:10:33.138733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a76b3efc-2e9e-4e49-aff0-a44e34c16760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A9D7A150>]}
[0m16:10:33.138733 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:10:33.295471 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:10:33.356537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:33.356537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:33.379733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a76b3efc-2e9e-4e49-aff0-a44e34c16760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AC1151F0>]}
[0m16:10:33.421607 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:10:33.427400 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:10:33.440213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a76b3efc-2e9e-4e49-aff0-a44e34c16760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AC621130>]}
[0m16:10:33.440213 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m16:10:33.440213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76b3efc-2e9e-4e49-aff0-a44e34c16760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256ABA0E1E0>]}
[0m16:10:33.440213 [info ] [MainThread]: 
[0m16:10:33.440213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:33.440213 [info ] [MainThread]: 
[0m16:10:33.440213 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:10:33.449547 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m16:10:33.493193 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:10:33.493193 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:10:33.493193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:33.507611 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:10:33.509616 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:10:33.511621 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:10:33.511621 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:10:33.511621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:33.511621 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:10:33.511621 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:10:33.513626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m16:10:33.513626 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m16:10:33.513626 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:10:33.513626 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:10:33.513626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:33.513626 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.513626 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:10:33.513626 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m16:10:33.513626 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.513626 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:10:33.513626 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m16:10:33.513626 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.513626 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:10:33.513626 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:10:33.513626 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:10:33.513626 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.513626 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m16:10:33.513626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_stage)
[0m16:10:33.513626 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m16:10:33.513626 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:10:33.513626 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:10:33.513626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:33.523769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.523769 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:10:33.523769 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m16:10:33.523769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.523769 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:10:33.523769 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m16:10:33.523769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.523769 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:10:33.523769 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:10:33.523769 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:10:33.523769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.523769 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m16:10:33.523769 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m16:10:33.530093 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:10:33.530093 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m16:10:33.530093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:33.530093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.530093 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:10:33.530093 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m16:10:33.539500 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:10:33.539500 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m16:10:33.541505 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m16:10:33.541505 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m16:10:33.541505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m16:10:33.543539 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:10:33.543539 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m16:10:33.543539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:33.543539 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:33.543539 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:10:33.543539 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m16:10:33.543539 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:10:33.543539 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m16:10:33.543539 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m16:10:33.543539 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m16:10:33.543539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76b3efc-2e9e-4e49-aff0-a44e34c16760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256ABA0E1E0>]}
[0m16:10:33.543539 [debug] [MainThread]: Using duckdb connection "master"
[0m16:10:33.543539 [debug] [MainThread]: On master: BEGIN
[0m16:10:33.543539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:33.543539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:10:33.543539 [debug] [MainThread]: On master: COMMIT
[0m16:10:33.543539 [debug] [MainThread]: Using duckdb connection "master"
[0m16:10:33.543539 [debug] [MainThread]: On master: COMMIT
[0m16:10:33.543539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:10:33.550222 [debug] [MainThread]: On master: Close
[0m16:10:33.550222 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m16:10:33.550222 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m16:10:33.550222 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m16:10:33.550222 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m16:10:33.553751 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m16:10:33.553751 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m16:10:33.573962 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m16:10:33.573962 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:10:33.573962 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m16:10:33.573962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:33.573962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:10:33.573962 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:10:33.573962 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:10:33.573962 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:10:33.579921 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:10:33.579921 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: ROLLBACK
[0m16:10:33.579921 [debug] [Thread-1 (]: Failed to rollback 'model.tv_audience_mini.stg_audience'
[0m16:10:33.579921 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m16:10:33.584292 [debug] [Thread-1 (]: Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^
[0m16:10:33.584292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76b3efc-2e9e-4e49-aff0-a44e34c16760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AC1AF4A0>]}
[0m16:10:33.584292 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main_stage.stg_audience ................... [[31mERROR[0m in 0.03s]
[0m16:10:33.584292 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m16:10:33.584292 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m16:10:33.584292 [debug] [Thread-4 (]: Marking all children of 'model.tv_audience_mini.stg_audience' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^.
[0m16:10:33.584292 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m16:10:33.584292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m16:10:33.584292 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m16:10:33.584292 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m16:10:33.584292 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m16:10:33.592457 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m16:10:33.594463 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:10:33.594463 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m16:10:33.594463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:33.594463 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:10:33.594463 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:10:33.594463 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:10:33.594463 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:10:33.596467 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:10:33.596467 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: ROLLBACK
[0m16:10:33.598471 [debug] [Thread-1 (]: Failed to rollback 'model.tv_audience_mini.stg_dim_channels'
[0m16:10:33.598471 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m16:10:33.598471 [debug] [Thread-1 (]: Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^
[0m16:10:33.598471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76b3efc-2e9e-4e49-aff0-a44e34c16760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256ACA68680>]}
[0m16:10:33.598471 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main_stage.stg_dim_channels ............... [[31mERROR[0m in 0.01s]
[0m16:10:33.598471 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m16:10:33.598471 [debug] [Thread-4 (]: Marking all children of 'model.tv_audience_mini.stg_dim_channels' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^.
[0m16:10:33.598471 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m16:10:33.598471 [info ] [Thread-1 (]: 3 of 4 SKIP relation main_marts.fact_audience .................................. [[33mSKIP[0m]
[0m16:10:33.604694 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m16:10:33.604694 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m16:10:33.604694 [info ] [Thread-1 (]: 4 of 4 SKIP relation main_marts.kpi_top10 ...................................... [[33mSKIP[0m]
[0m16:10:33.604694 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m16:10:33.604694 [debug] [MainThread]: Using duckdb connection "master"
[0m16:10:33.604694 [debug] [MainThread]: On master: BEGIN
[0m16:10:33.604694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:33.604694 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:10:33.604694 [debug] [MainThread]: On master: COMMIT
[0m16:10:33.604694 [debug] [MainThread]: Using duckdb connection "master"
[0m16:10:33.604694 [debug] [MainThread]: On master: COMMIT
[0m16:10:33.604694 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:10:33.604694 [debug] [MainThread]: On master: Close
[0m16:10:33.604694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:33.604694 [debug] [MainThread]: Connection 'create_warehouse_main_stage' was properly closed.
[0m16:10:33.604694 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m16:10:33.604694 [debug] [MainThread]: Connection 'model.tv_audience_mini.stg_dim_channels' was properly closed.
[0m16:10:33.604694 [info ] [MainThread]: 
[0m16:10:33.604694 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m16:10:33.604694 [debug] [MainThread]: Command end result
[0m16:10:33.621614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:10:33.625118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:10:33.627125 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m16:10:33.627125 [info ] [MainThread]: 
[0m16:10:33.627125 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:10:33.627125 [info ] [MainThread]: 
[0m16:10:33.627125 [error] [MainThread]: [31mFailure in model stg_audience (models\staging\stg_audience.sql)[0m
[0m16:10:33.627125 [error] [MainThread]:   Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^
[0m16:10:33.627125 [info ] [MainThread]: 
[0m16:10:33.627125 [info ] [MainThread]:   compiled code at target\compiled\tv_audience_mini\models\staging\stg_audience.sql
[0m16:10:33.627125 [info ] [MainThread]: 
[0m16:10:33.635651 [error] [MainThread]: [31mFailure in model stg_dim_channels (models\staging\stg_dim_channels.sql)[0m
[0m16:10:33.635651 [error] [MainThread]:   Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^
[0m16:10:33.636655 [info ] [MainThread]: 
[0m16:10:33.636655 [info ] [MainThread]:   compiled code at target\compiled\tv_audience_mini\models\staging\stg_dim_channels.sql
[0m16:10:33.636655 [info ] [MainThread]: 
[0m16:10:33.636655 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m16:10:33.636655 [debug] [MainThread]: Command `dbt run` failed at 16:10:33.636655 after 0.88 seconds
[0m16:10:33.636655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AA1319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A9F42F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A6E97F50>]}
[0m16:10:33.636655 [debug] [MainThread]: Flushing usage events
[0m16:10:34.467053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:21.775590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873EA0B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873EE3DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873EE3FC50>]}


============================== 16:14:21.781576 | 79cf6adf-2567-4c67-8673-bff64ff308d7 ==============================
[0m16:14:21.781576 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:14:21.783573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:14:21.917649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79cf6adf-2567-4c67-8673-bff64ff308d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873CA80560>]}
[0m16:14:21.955759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79cf6adf-2567-4c67-8673-bff64ff308d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873F2110A0>]}
[0m16:14:21.956759 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:14:22.116096 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:14:22.180737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:22.180737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:22.200956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79cf6adf-2567-4c67-8673-bff64ff308d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187413D2990>]}
[0m16:14:22.238422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:14:22.239424 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:14:22.252608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79cf6adf-2567-4c67-8673-bff64ff308d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874130EFF0>]}
[0m16:14:22.253608 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m16:14:22.253608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79cf6adf-2567-4c67-8673-bff64ff308d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187416EF920>]}
[0m16:14:22.254717 [info ] [MainThread]: 
[0m16:14:22.255774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:22.256747 [info ] [MainThread]: 
[0m16:14:22.257785 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:14:22.260751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m16:14:22.307040 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:14:22.307040 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:14:22.307040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:22.317021 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:14:22.318029 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:14:22.320022 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:14:22.320022 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:14:22.320022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:22.321044 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:14:22.321044 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:14:22.322046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stage)
[0m16:14:22.322046 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m16:14:22.325235 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:14:22.326363 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:14:22.326363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:22.327327 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:14:22.327327 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:14:22.328325 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m16:14:22.328325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:14:22.328325 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:14:22.328325 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m16:14:22.328325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:14:22.329324 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:14:22.329324 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:14:22.329324 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:14:22.330336 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:14:22.330336 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m16:14:22.330336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_stage, now create_warehouse_main_marts)
[0m16:14:22.330336 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m16:14:22.331461 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:14:22.332471 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:14:22.332471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:22.332471 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:14:22.333464 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:14:22.333464 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m16:14:22.333464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:14:22.334547 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:14:22.334547 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m16:14:22.334547 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:14:22.334547 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:14:22.335572 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:14:22.335572 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:14:22.335879 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:14:22.335879 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m16:14:22.337907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m16:14:22.340908 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:14:22.340908 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m16:14:22.340908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:22.341906 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:14:22.341906 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:14:22.341906 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m16:14:22.350155 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:14:22.351185 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m16:14:22.352155 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m16:14:22.352155 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m16:14:22.352155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m16:14:22.353154 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:14:22.353154 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m16:14:22.354172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:22.354172 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:14:22.354172 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:14:22.354172 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m16:14:22.356316 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:14:22.357330 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m16:14:22.357330 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m16:14:22.357330 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m16:14:22.358329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79cf6adf-2567-4c67-8673-bff64ff308d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018741A86450>]}
[0m16:14:22.358329 [debug] [MainThread]: Using duckdb connection "master"
[0m16:14:22.358329 [debug] [MainThread]: On master: BEGIN
[0m16:14:22.358329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:22.359324 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:14:22.359324 [debug] [MainThread]: On master: COMMIT
[0m16:14:22.359324 [debug] [MainThread]: Using duckdb connection "master"
[0m16:14:22.359324 [debug] [MainThread]: On master: COMMIT
[0m16:14:22.360366 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:14:22.360366 [debug] [MainThread]: On master: Close
[0m16:14:22.363323 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m16:14:22.363323 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m16:14:22.364399 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m16:14:22.364399 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m16:14:22.368448 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m16:14:22.368448 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m16:14:22.385718 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m16:14:22.385718 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:14:22.386719 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m16:14:22.386719 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:22.386719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:14:22.387718 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:14:22.387718 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:14:22.387718 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:14:22.388735 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:14:22.388735 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: ROLLBACK
[0m16:14:22.391720 [debug] [Thread-1 (]: Failed to rollback 'model.tv_audience_mini.stg_audience'
[0m16:14:22.391720 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m16:14:22.393719 [debug] [Thread-1 (]: Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^
[0m16:14:22.393719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79cf6adf-2567-4c67-8673-bff64ff308d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873EE17B30>]}
[0m16:14:22.394867 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main_stage.stg_audience ................... [[31mERROR[0m in 0.03s]
[0m16:14:22.396038 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m16:14:22.396038 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m16:14:22.397021 [debug] [Thread-4 (]: Marking all children of 'model.tv_audience_mini.stg_audience' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^.
[0m16:14:22.397021 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m16:14:22.398021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m16:14:22.398021 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m16:14:22.399021 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m16:14:22.400020 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m16:14:22.402022 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m16:14:22.403021 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:14:22.403021 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m16:14:22.403021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:22.404022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:14:22.404022 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:14:22.404022 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:14:22.405242 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:14:22.405242 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:14:22.405242 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: ROLLBACK
[0m16:14:22.407407 [debug] [Thread-1 (]: Failed to rollback 'model.tv_audience_mini.stg_dim_channels'
[0m16:14:22.407407 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m16:14:22.409405 [debug] [Thread-1 (]: Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^
[0m16:14:22.409405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79cf6adf-2567-4c67-8673-bff64ff308d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018741B58980>]}
[0m16:14:22.409405 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main_stage.stg_dim_channels ............... [[31mERROR[0m in 0.01s]
[0m16:14:22.410405 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m16:14:22.411406 [debug] [Thread-4 (]: Marking all children of 'model.tv_audience_mini.stg_dim_channels' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^.
[0m16:14:22.411406 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m16:14:22.411406 [info ] [Thread-1 (]: 3 of 4 SKIP relation main_marts.fact_audience .................................. [[33mSKIP[0m]
[0m16:14:22.412408 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m16:14:22.413407 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m16:14:22.413407 [info ] [Thread-1 (]: 4 of 4 SKIP relation main_marts.kpi_top10 ...................................... [[33mSKIP[0m]
[0m16:14:22.414480 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m16:14:22.414480 [debug] [MainThread]: Using duckdb connection "master"
[0m16:14:22.414480 [debug] [MainThread]: On master: BEGIN
[0m16:14:22.415513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:22.415513 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:14:22.415513 [debug] [MainThread]: On master: COMMIT
[0m16:14:22.415513 [debug] [MainThread]: Using duckdb connection "master"
[0m16:14:22.415513 [debug] [MainThread]: On master: COMMIT
[0m16:14:22.416678 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:14:22.416678 [debug] [MainThread]: On master: Close
[0m16:14:22.416678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:22.416678 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m16:14:22.416678 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m16:14:22.417660 [debug] [MainThread]: Connection 'model.tv_audience_mini.stg_dim_channels' was properly closed.
[0m16:14:22.417660 [info ] [MainThread]: 
[0m16:14:22.418659 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m16:14:22.418659 [debug] [MainThread]: Command end result
[0m16:14:22.429658 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:14:22.431660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:14:22.434824 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m16:14:22.434824 [info ] [MainThread]: 
[0m16:14:22.435918 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:14:22.436897 [info ] [MainThread]: 
[0m16:14:22.439613 [error] [MainThread]: [31mFailure in model stg_audience (models\staging\stg_audience.sql)[0m
[0m16:14:22.440640 [error] [MainThread]:   Runtime Error in model stg_audience (models\staging\stg_audience.sql)
  Catalog Error: Table with name audience_raw does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 13:   from stage.audience_raw
                  ^
[0m16:14:22.442619 [info ] [MainThread]: 
[0m16:14:22.444635 [info ] [MainThread]:   compiled code at target\compiled\tv_audience_mini\models\staging\stg_audience.sql
[0m16:14:22.445846 [info ] [MainThread]: 
[0m16:14:22.445846 [error] [MainThread]: [31mFailure in model stg_dim_channels (models\staging\stg_dim_channels.sql)[0m
[0m16:14:22.446829 [error] [MainThread]:   Runtime Error in model stg_dim_channels (models\staging\stg_dim_channels.sql)
  Catalog Error: Table with name dim_channels_raw does not exist!
  Did you mean "main.sqlite_master"?
  
  LINE 9: from stage.dim_channels_raw
               ^
[0m16:14:22.446829 [info ] [MainThread]: 
[0m16:14:22.446829 [info ] [MainThread]:   compiled code at target\compiled\tv_audience_mini\models\staging\stg_dim_channels.sql
[0m16:14:22.447828 [info ] [MainThread]: 
[0m16:14:22.447828 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m16:14:22.448829 [debug] [MainThread]: Command `dbt run` failed at 16:14:22.448829 after 1.23 seconds
[0m16:14:22.449830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873FAFD8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874136E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873EDF2F60>]}
[0m16:14:22.449830 [debug] [MainThread]: Flushing usage events
[0m16:14:23.763860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:52.334479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002573D5D4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002573DF97E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002574067A090>]}


============================== 16:18:52.337494 | b8f0cdf4-b912-455f-8948-6fc092ece36d ==============================
[0m16:18:52.337494 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:18:52.340478 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m16:18:52.356197 [info ] [MainThread]: dbt version: 1.10.13
[0m16:18:52.357210 [info ] [MainThread]: python version: 3.12.10
[0m16:18:52.357210 [info ] [MainThread]: python path: C:\Users\delma\AppData\Local\Programs\Python\Python312\python.exe
[0m16:18:52.357210 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m16:18:52.421089 [info ] [MainThread]: Using profiles dir at C:\Users\delma\.dbt
[0m16:18:52.422075 [info ] [MainThread]: Using profiles.yml file at C:\Users\delma\.dbt\profiles.yml
[0m16:18:52.422075 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\dbt_project.yml
[0m16:18:52.424073 [info ] [MainThread]: adapter type: duckdb
[0m16:18:52.424073 [info ] [MainThread]: adapter version: 1.9.6
[0m16:18:52.482264 [info ] [MainThread]: Configuration:
[0m16:18:52.484264 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:18:52.485435 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:18:52.488593 [info ] [MainThread]: Required dependencies:
[0m16:18:52.488593 [debug] [MainThread]: Executing "git --help"
[0m16:18:52.831100 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:18:52.831100 [debug] [MainThread]: STDERR: "b''"
[0m16:18:52.832114 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:18:52.832114 [info ] [MainThread]: Connection:
[0m16:18:52.833112 [info ] [MainThread]:   database: warehouse
[0m16:18:52.833112 [info ] [MainThread]:   schema: main
[0m16:18:52.833112 [info ] [MainThread]:   path: C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\warehouse.duckdb
[0m16:18:52.834108 [info ] [MainThread]:   config_options: None
[0m16:18:52.834108 [info ] [MainThread]:   extensions: None
[0m16:18:52.834108 [info ] [MainThread]:   settings: {}
[0m16:18:52.835206 [info ] [MainThread]:   external_root: .
[0m16:18:52.835206 [info ] [MainThread]:   use_credential_provider: None
[0m16:18:52.835206 [info ] [MainThread]:   attach: None
[0m16:18:52.835206 [info ] [MainThread]:   filesystems: None
[0m16:18:52.836272 [info ] [MainThread]:   remote: None
[0m16:18:52.837272 [info ] [MainThread]:   plugins: None
[0m16:18:52.839291 [info ] [MainThread]:   disable_transactions: False
[0m16:18:52.841289 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:18:52.991446 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:18:53.029275 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:18:53.029275 [debug] [MainThread]: On debug: select 1 as id
[0m16:18:53.029275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:53.038672 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m16:18:53.039720 [debug] [MainThread]: On debug: Close
[0m16:18:53.039720 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:18:53.040784 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:18:53.040784 [debug] [MainThread]: Command `dbt debug` succeeded at 16:18:53.040784 after 0.84 seconds
[0m16:18:53.041701 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:18:53.041701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257412F3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025742B51160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025740F510A0>]}
[0m16:18:53.041701 [debug] [MainThread]: Flushing usage events
[0m16:18:53.872212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:59.300863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C149B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C1F762D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C1F763C0>]}


============================== 16:18:59.303865 | aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7 ==============================
[0m16:18:59.303865 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:18:59.304991 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\delma\\.dbt', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:18:59.438577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C3D01970>]}
[0m16:18:59.475530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C1F77D40>]}
[0m16:18:59.476719 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:18:59.618739 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:18:59.665209 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:18:59.666321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C4044770>]}
[0m16:19:00.332708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C3671160>]}
[0m16:19:00.368129 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:19:00.370463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:19:00.383502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C4276360>]}
[0m16:19:00.383502 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m16:19:00.385518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C42C7C80>]}
[0m16:19:00.386518 [info ] [MainThread]: 
[0m16:19:00.387518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:00.389519 [info ] [MainThread]: 
[0m16:19:00.390501 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:19:00.395179 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m16:19:00.440080 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:19:00.440080 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:19:00.440080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:00.450375 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:19:00.451376 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:19:00.452375 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m16:19:00.452375 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m16:19:00.452375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:00.453359 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:00.454616 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:19:00.454616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m16:19:00.454616 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m16:19:00.458783 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:19:00.458783 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:19:00.458783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:00.459767 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:00.459767 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:19:00.459767 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m16:19:00.460786 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:00.460786 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:19:00.460786 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m16:19:00.460786 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:00.461766 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:19:00.461766 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m16:19:00.461766 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m16:19:00.475785 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:19:00.476784 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m16:19:00.476784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_stage)
[0m16:19:00.476784 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m16:19:00.478248 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:19:00.478248 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m16:19:00.478248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:00.479270 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:00.480301 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:19:00.480301 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m16:19:00.480301 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:00.480301 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:19:00.481283 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m16:19:00.481283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:00.481283 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:19:00.482299 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m16:19:00.482299 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m16:19:00.483304 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:19:00.484300 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m16:19:00.485300 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m16:19:00.488304 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:19:00.488304 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m16:19:00.488304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:00.488304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:00.489284 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:19:00.489284 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m16:19:00.497239 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:19:00.498237 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m16:19:00.499236 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m16:19:00.499236 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m16:19:00.499236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m16:19:00.500236 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:19:00.500236 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m16:19:00.501239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:00.501239 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:00.501239 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:19:00.501239 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m16:19:00.503236 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:19:00.504438 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m16:19:00.504438 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m16:19:00.504438 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m16:19:00.505439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C3C40A70>]}
[0m16:19:00.505439 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:00.505439 [debug] [MainThread]: On master: BEGIN
[0m16:19:00.505439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:00.505439 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:00.506613 [debug] [MainThread]: On master: COMMIT
[0m16:19:00.506613 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:00.506613 [debug] [MainThread]: On master: COMMIT
[0m16:19:00.506613 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:00.506613 [debug] [MainThread]: On master: Close
[0m16:19:00.513630 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m16:19:00.513630 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m16:19:00.516039 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m16:19:00.516039 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m16:19:00.519033 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m16:19:00.520032 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m16:19:00.537699 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m16:19:00.537699 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:19:00.538699 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m16:19:00.538699 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:00.538699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.538699 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:19:00.539682 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m16:19:00.539682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:00.543689 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:19:00.543689 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience__dbt_tmp" rename to "stg_audience"
[0m16:19:00.544846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.549924 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m16:19:00.550941 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:19:00.550941 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m16:19:00.553943 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:19:00.558158 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m16:19:00.558158 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

      drop view if exists "warehouse"."main_stage"."stg_audience__dbt_backup" cascade
    
[0m16:19:00.559158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.560159 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m16:19:00.561158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C36735C0>]}
[0m16:19:00.562157 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_stage.stg_audience ....................... [[32mOK[0m in 0.05s]
[0m16:19:00.563158 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m16:19:00.563158 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m16:19:00.563158 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m16:19:00.564165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m16:19:00.564165 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m16:19:00.565272 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m16:19:00.566369 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m16:19:00.568367 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m16:19:00.569367 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:19:00.569367 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m16:19:00.569367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:00.569367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.570350 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:19:00.570350 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m16:19:00.570350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.572369 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:19:00.572369 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" rename to "stg_dim_channels"
[0m16:19:00.573368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.573368 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m16:19:00.573368 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:19:00.574463 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m16:19:00.576718 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:00.577710 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m16:19:00.577710 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

      drop view if exists "warehouse"."main_stage"."stg_dim_channels__dbt_backup" cascade
    
[0m16:19:00.578711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.578711 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m16:19:00.579716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C4729250>]}
[0m16:19:00.579716 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main_stage.stg_dim_channels ................... [[32mOK[0m in 0.02s]
[0m16:19:00.580717 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m16:19:00.580717 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m16:19:00.580717 [info ] [Thread-1 (]: 3 of 4 START sql view model main_marts.fact_audience ........................... [RUN]
[0m16:19:00.581736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_dim_channels, now model.tv_audience_mini.fact_audience)
[0m16:19:00.582715 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.fact_audience
[0m16:19:00.583722 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.fact_audience"
[0m16:19:00.584870 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.fact_audience
[0m16:19:00.587001 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.fact_audience"
[0m16:19:00.587986 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m16:19:00.587986 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: BEGIN
[0m16:19:00.587986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:00.588992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.588992 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m16:19:00.588992 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

  
  create view "warehouse"."main_marts"."fact_audience__dbt_tmp" as (
    with m as (
  select
    a.date,
    a.country,
    coalesce(d.channel_std, upper(a.channel)) as channel_std,
    a.program,
    a.viewers
  from "warehouse"."main_stage"."stg_audience" a
  left join "warehouse"."main_stage"."stg_dim_channels" d
    on a.country = d.country
   and upper(a.channel) = d.alias
)
select * from m
  );

[0m16:19:00.590011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:00.591989 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m16:19:00.591989 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience__dbt_tmp" rename to "fact_audience"
[0m16:19:00.591989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.592986 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m16:19:00.592986 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m16:19:00.594001 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m16:19:00.596235 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:00.597252 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m16:19:00.598252 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

      drop view if exists "warehouse"."main_marts"."fact_audience__dbt_backup" cascade
    
[0m16:19:00.598252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.599268 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: Close
[0m16:19:00.599268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C47B6840>]}
[0m16:19:00.599268 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_marts.fact_audience ...................... [[32mOK[0m in 0.02s]
[0m16:19:00.602252 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m16:19:00.602252 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m16:19:00.603236 [info ] [Thread-1 (]: 4 of 4 START sql view model main_marts.kpi_top10 ............................... [RUN]
[0m16:19:00.605407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.fact_audience, now model.tv_audience_mini.kpi_top10)
[0m16:19:00.605407 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.kpi_top10
[0m16:19:00.607253 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.kpi_top10"
[0m16:19:00.608229 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.kpi_top10
[0m16:19:00.610245 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.kpi_top10"
[0m16:19:00.611246 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m16:19:00.611246 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: BEGIN
[0m16:19:00.611246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:00.612229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.612229 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m16:19:00.612229 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

  
  create view "warehouse"."main_marts"."kpi_top10__dbt_tmp" as (
    with base as (
  select
    date, country, channel_std, program, viewers,
    row_number() over (partition by date, country order by viewers desc) as rk
  from "warehouse"."main_marts"."fact_audience"
)
select
  date, country, channel_std, program, viewers,
  rk as rank_in_country
from base
where rk <= 10
order by date, country, rk
  );

[0m16:19:00.613250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:00.615480 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m16:19:00.615480 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10__dbt_tmp" rename to "kpi_top10"
[0m16:19:00.615480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.616547 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m16:19:00.616547 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m16:19:00.617548 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m16:19:00.619531 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:00.620550 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m16:19:00.621548 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

      drop view if exists "warehouse"."main_marts"."kpi_top10__dbt_backup" cascade
    
[0m16:19:00.621548 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:00.622547 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: Close
[0m16:19:00.622547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac6b8a3-6fdb-48b9-9ca6-bf2fa42181c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C47D7320>]}
[0m16:19:00.623547 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_marts.kpi_top10 .......................... [[32mOK[0m in 0.02s]
[0m16:19:00.624659 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m16:19:00.624659 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:00.625706 [debug] [MainThread]: On master: BEGIN
[0m16:19:00.625706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:00.625706 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:00.625706 [debug] [MainThread]: On master: COMMIT
[0m16:19:00.626705 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:00.626705 [debug] [MainThread]: On master: COMMIT
[0m16:19:00.626705 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:00.626705 [debug] [MainThread]: On master: Close
[0m16:19:00.626705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:00.626705 [debug] [MainThread]: Connection 'create_warehouse_main_stage' was properly closed.
[0m16:19:00.627721 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m16:19:00.627721 [debug] [MainThread]: Connection 'model.tv_audience_mini.kpi_top10' was properly closed.
[0m16:19:00.627721 [info ] [MainThread]: 
[0m16:19:00.627721 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m16:19:00.629705 [debug] [MainThread]: Command end result
[0m16:19:00.640964 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:19:00.641981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:19:00.646368 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m16:19:00.646368 [info ] [MainThread]: 
[0m16:19:00.646368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:00.648369 [info ] [MainThread]: 
[0m16:19:00.650369 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:19:00.651368 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:00.651368 after 1.49 seconds
[0m16:19:00.651368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C25AE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BEA9C0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C1D13770>]}
[0m16:19:00.651368 [debug] [MainThread]: Flushing usage events
[0m16:19:01.349202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:11.175453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D921C47F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D921B35BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D921F30BC0>]}


============================== 16:19:11.179974 | 7aff93ba-8ba3-49e7-be3a-e3cada2f6fdc ==============================
[0m16:19:11.179974 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:19:11.182150 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\delma\\OneDrive\\Documents\\tv_audience_mini_pipeline\\dbt_project\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m16:19:11.336084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aff93ba-8ba3-49e7-be3a-e3cada2f6fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D923EA7E90>]}
[0m16:19:11.380453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aff93ba-8ba3-49e7-be3a-e3cada2f6fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D91F8779B0>]}
[0m16:19:11.381444 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:19:11.558073 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:19:11.632979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:11.633979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:11.655347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aff93ba-8ba3-49e7-be3a-e3cada2f6fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D92404B440>]}
[0m16:19:11.696561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:19:11.698577 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:19:11.720487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aff93ba-8ba3-49e7-be3a-e3cada2f6fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9244D0680>]}
[0m16:19:11.721590 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m16:19:11.721590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aff93ba-8ba3-49e7-be3a-e3cada2f6fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D92445C5C0>]}
[0m16:19:11.722488 [info ] [MainThread]: 
[0m16:19:11.723488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:11.724528 [info ] [MainThread]: 
[0m16:19:11.724528 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:19:11.727876 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m16:19:11.775740 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:19:11.775740 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m16:19:11.775740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:11.787361 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:19:11.787361 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m16:19:11.788212 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m16:19:11.799767 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:19:11.800703 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m16:19:11.801816 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m16:19:11.801816 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m16:19:11.801816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m16:19:11.803934 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:19:11.803934 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m16:19:11.803934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:11.803934 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:11.805107 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m16:19:11.805107 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m16:19:11.807277 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:19:11.808278 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m16:19:11.808278 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m16:19:11.809314 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m16:19:11.809314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aff93ba-8ba3-49e7-be3a-e3cada2f6fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D922933290>]}
[0m16:19:11.809314 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:11.810278 [debug] [MainThread]: On master: BEGIN
[0m16:19:11.810278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:11.810278 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:11.810278 [debug] [MainThread]: On master: COMMIT
[0m16:19:11.810278 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:11.811278 [debug] [MainThread]: On master: COMMIT
[0m16:19:11.811278 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:11.811278 [debug] [MainThread]: On master: Close
[0m16:19:11.814462 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m16:19:11.814462 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m16:19:11.815463 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m16:19:11.815463 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m16:19:11.824948 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m16:19:11.826124 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m16:19:11.836436 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m16:19:11.837436 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m16:19:11.837436 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m16:19:11.837436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:11.838437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:11.838437 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m16:19:11.838437 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.852435 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:19:11.855439 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m16:19:11.856436 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m16:19:11.856436 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m16:19:11.857453 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.04s]
[0m16:19:11.858435 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m16:19:11.858435 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m16:19:11.858435 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m16:19:11.860436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m16:19:11.860436 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m16:19:11.862437 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m16:19:11.863436 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m16:19:11.865437 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m16:19:11.865437 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m16:19:11.865437 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m16:19:11.866437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.866437 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:11.866437 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m16:19:11.866437 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.870435 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:19:11.871459 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m16:19:11.872456 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m16:19:11.872456 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m16:19:11.872456 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.01s]
[0m16:19:11.874666 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m16:19:11.874666 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m16:19:11.875905 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m16:19:11.875905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m16:19:11.876905 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m16:19:11.879923 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m16:19:11.880904 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m16:19:11.881905 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m16:19:11.882905 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m16:19:11.882905 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m16:19:11.882905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.883906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:11.883906 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m16:19:11.883906 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.886217 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:11.887217 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m16:19:11.888218 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m16:19:11.888218 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m16:19:11.888218 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.01s]
[0m16:19:11.891216 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m16:19:11.891216 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m16:19:11.891216 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m16:19:11.893217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m16:19:11.893728 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m16:19:11.895969 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m16:19:11.896968 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m16:19:11.898968 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m16:19:11.898968 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m16:19:11.899976 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m16:19:11.899976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.899976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:11.899976 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m16:19:11.900967 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.903460 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:11.904461 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m16:19:11.905262 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m16:19:11.905262 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m16:19:11.905262 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m16:19:11.907344 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m16:19:11.907344 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m16:19:11.907344 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m16:19:11.908372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m16:19:11.908372 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m16:19:11.911344 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m16:19:11.912345 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m16:19:11.913345 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m16:19:11.914345 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m16:19:11.914345 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m16:19:11.914345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.914345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:11.915543 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m16:19:11.915543 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.917623 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:11.918721 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m16:19:11.918721 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m16:19:11.919722 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m16:19:11.919722 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m16:19:11.920776 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m16:19:11.920776 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m16:19:11.920776 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m16:19:11.922738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m16:19:11.922738 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m16:19:11.924923 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m16:19:11.926054 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m16:19:11.928053 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m16:19:11.928053 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m16:19:11.928053 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m16:19:11.929053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.929053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:11.929053 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m16:19:11.929053 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.931052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:11.932052 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m16:19:11.932052 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m16:19:11.933099 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m16:19:11.933099 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m16:19:11.935690 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m16:19:11.935690 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m16:19:11.935690 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m16:19:11.939921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m16:19:11.939921 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m16:19:11.941913 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m16:19:11.943018 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m16:19:11.944025 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m16:19:11.945207 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m16:19:11.945207 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m16:19:11.945207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.946383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:11.946383 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m16:19:11.946383 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.948381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:11.948381 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m16:19:11.949725 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m16:19:11.949725 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m16:19:11.950733 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m16:19:11.953734 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m16:19:11.953734 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m16:19:11.953734 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m16:19:11.959163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m16:19:11.960031 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m16:19:11.962030 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m16:19:11.963030 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m16:19:11.965031 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m16:19:11.967031 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m16:19:11.967031 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m16:19:11.967031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.968319 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:11.968319 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m16:19:11.968319 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.970340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:11.971358 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m16:19:11.972344 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m16:19:11.972344 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m16:19:11.972344 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m16:19:11.974329 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m16:19:11.974329 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m16:19:11.974329 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m16:19:11.976378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m16:19:11.976378 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m16:19:11.978328 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m16:19:11.979329 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m16:19:11.981626 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m16:19:11.982553 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m16:19:11.982553 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m16:19:11.982553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.983553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:11.983553 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m16:19:11.983553 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.985778 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:11.987773 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m16:19:11.987773 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m16:19:11.988791 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m16:19:11.988791 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.01s]
[0m16:19:11.990772 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m16:19:11.990772 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m16:19:11.990772 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m16:19:11.991812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m16:19:11.992773 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m16:19:11.994890 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m16:19:11.995990 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m16:19:11.996991 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m16:19:11.998011 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m16:19:11.998011 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m16:19:11.998011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:11.999008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:11.999008 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m16:19:11.999008 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m16:19:11.999996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:12.001991 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m16:19:12.002995 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m16:19:12.002995 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m16:19:12.002995 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m16:19:12.004023 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m16:19:12.004023 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m16:19:12.004023 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m16:19:12.005144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m16:19:12.005144 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m16:19:12.008222 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m16:19:12.009222 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m16:19:12.011220 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m16:19:12.012220 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m16:19:12.012220 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m16:19:12.012220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:12.013238 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:12.013238 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m16:19:12.013238 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m16:19:12.014501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:12.016484 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m16:19:12.016484 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m16:19:12.017498 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m16:19:12.017498 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m16:19:12.018586 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m16:19:12.018586 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m16:19:12.018586 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m16:19:12.019580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m16:19:12.020579 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m16:19:12.023577 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m16:19:12.024697 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m16:19:12.025827 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m16:19:12.026826 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m16:19:12.026826 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m16:19:12.026826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:12.027826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:12.027826 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m16:19:12.027826 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m16:19:12.028826 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:12.029828 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m16:19:12.030830 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m16:19:12.030830 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m16:19:12.030830 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m16:19:12.031969 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m16:19:12.032866 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m16:19:12.032866 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m16:19:12.034286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m16:19:12.034286 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m16:19:12.036602 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m16:19:12.037636 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m16:19:12.038620 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m16:19:12.039619 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m16:19:12.039619 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m16:19:12.039619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:12.040618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:12.040618 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m16:19:12.040618 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m16:19:12.041619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:12.042604 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m16:19:12.043603 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m16:19:12.043603 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m16:19:12.043603 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m16:19:12.046752 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m16:19:12.046752 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m16:19:12.046752 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m16:19:12.047752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m16:19:12.047752 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m16:19:12.051780 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m16:19:12.052752 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m16:19:12.089126 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m16:19:12.090125 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m16:19:12.090125 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m16:19:12.090125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:12.091125 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:12.091125 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m16:19:12.092126 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m16:19:12.092126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:12.093128 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m16:19:12.094129 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m16:19:12.094129 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m16:19:12.094129 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.05s]
[0m16:19:12.098429 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m16:19:12.098429 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m16:19:12.098429 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m16:19:12.101596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m16:19:12.101596 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m16:19:12.104751 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m16:19:12.105965 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m16:19:12.108008 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m16:19:12.108008 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m16:19:12.109015 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m16:19:12.109015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:12.109015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:12.109015 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m16:19:12.109015 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:19:12.116371 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:19:12.117876 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m16:19:12.118882 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m16:19:12.118882 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m16:19:12.119882 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m16:19:12.121882 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m16:19:12.121882 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:12.122933 [debug] [MainThread]: On master: BEGIN
[0m16:19:12.122933 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:12.122933 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:12.122933 [debug] [MainThread]: On master: COMMIT
[0m16:19:12.123939 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:12.123939 [debug] [MainThread]: On master: COMMIT
[0m16:19:12.123939 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:12.123939 [debug] [MainThread]: On master: Close
[0m16:19:12.123939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:12.123939 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m16:19:12.125008 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m16:19:12.125008 [info ] [MainThread]: 
[0m16:19:12.127212 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m16:19:12.133223 [debug] [MainThread]: Command end result
[0m16:19:12.145498 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m16:19:12.147533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m16:19:12.151532 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\delma\OneDrive\Documents\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m16:19:12.151532 [info ] [MainThread]: 
[0m16:19:12.154885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:12.157145 [info ] [MainThread]: 
[0m16:19:12.158058 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m16:19:12.160017 [debug] [MainThread]: Command `dbt test` succeeded at 16:19:12.160017 after 1.09 seconds
[0m16:19:12.160017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D921FA0C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D92208F200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D92208F020>]}
[0m16:19:12.160017 [debug] [MainThread]: Flushing usage events
[0m16:19:12.776473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:14.039564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E81FF9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E7B4F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E7B4FA70>]}


============================== 18:05:14.042555 | 59aaba56-a196-4a46-ba59-3d70116bddb6 ==============================
[0m18:05:14.042555 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:05:14.043563 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m18:05:14.179413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E986D5B0>]}
[0m18:05:14.218160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E7BDA5D0>]}
[0m18:05:14.220166 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m18:05:14.368648 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:05:14.416191 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:05:14.420736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E81FCCE0>]}
[0m18:05:15.079326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA04BB00>]}
[0m18:05:15.114864 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m18:05:15.116922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m18:05:15.129673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA04A390>]}
[0m18:05:15.129673 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m18:05:15.130712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA1E4470>]}
[0m18:05:15.131723 [info ] [MainThread]: 
[0m18:05:15.132765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:15.132765 [info ] [MainThread]: 
[0m18:05:15.133719 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:05:15.136110 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m18:05:15.185518 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m18:05:15.185518 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m18:05:15.185518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:15.195262 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:05:15.196338 [debug] [ThreadPool]: On list_warehouse: Close
[0m18:05:15.197356 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m18:05:15.197356 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m18:05:15.197356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:15.198341 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:15.199355 [debug] [ThreadPool]: On list_warehouse: Close
[0m18:05:15.199355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m18:05:15.199355 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m18:05:15.202366 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m18:05:15.203354 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m18:05:15.203354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:15.203354 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:15.204453 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m18:05:15.204453 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m18:05:15.204453 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.205457 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m18:05:15.205457 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m18:05:15.205457 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.206556 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m18:05:15.206556 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m18:05:15.206556 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m18:05:15.206556 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.206556 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m18:05:15.207551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_stage)
[0m18:05:15.207551 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m18:05:15.208551 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m18:05:15.208551 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m18:05:15.208551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:15.209559 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.209559 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m18:05:15.209559 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m18:05:15.210551 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.210551 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m18:05:15.210551 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m18:05:15.210551 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.211534 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m18:05:15.211534 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m18:05:15.211534 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m18:05:15.212572 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.212572 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m18:05:15.213539 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m18:05:15.215734 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m18:05:15.216733 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m18:05:15.216733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:15.216733 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.216733 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m18:05:15.216733 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m18:05:15.225375 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:05:15.225375 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m18:05:15.226391 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m18:05:15.226391 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m18:05:15.226391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m18:05:15.228413 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m18:05:15.228413 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m18:05:15.228413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:15.228413 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:15.229392 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m18:05:15.229392 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m18:05:15.231407 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:05:15.231407 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m18:05:15.232408 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m18:05:15.232408 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m18:05:15.233408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA546450>]}
[0m18:05:15.233408 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:15.233408 [debug] [MainThread]: On master: BEGIN
[0m18:05:15.233408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:15.233408 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:15.234465 [debug] [MainThread]: On master: COMMIT
[0m18:05:15.234465 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:15.234465 [debug] [MainThread]: On master: COMMIT
[0m18:05:15.234465 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:15.234465 [debug] [MainThread]: On master: Close
[0m18:05:15.236552 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m18:05:15.236552 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m18:05:15.237541 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m18:05:15.237541 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m18:05:15.241540 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m18:05:15.242539 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m18:05:15.258973 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m18:05:15.259968 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m18:05:15.259968 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m18:05:15.259968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:05:15.260967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:15.260967 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m18:05:15.260967 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m18:05:15.261968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:15.265120 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m18:05:15.265120 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience" rename to "stg_audience__dbt_backup"
[0m18:05:15.266287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.268304 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m18:05:15.268304 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience__dbt_tmp" rename to "stg_audience"
[0m18:05:15.269306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.276571 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m18:05:15.276571 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m18:05:15.276571 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m18:05:15.282552 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:05:15.284639 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m18:05:15.285690 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

      drop view if exists "warehouse"."main_stage"."stg_audience__dbt_backup" cascade
    
[0m18:05:15.286533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:15.287545 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m18:05:15.288547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E57037D0>]}
[0m18:05:15.289548 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_stage.stg_audience ....................... [[32mOK[0m in 0.05s]
[0m18:05:15.289548 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m18:05:15.290550 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m18:05:15.290550 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m18:05:15.291543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m18:05:15.291543 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m18:05:15.292543 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m18:05:15.292543 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m18:05:15.294543 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m18:05:15.295632 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m18:05:15.295632 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m18:05:15.295632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:15.296634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.296634 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m18:05:15.296634 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m18:05:15.297633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.298634 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m18:05:15.298634 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels" rename to "stg_dim_channels__dbt_backup"
[0m18:05:15.299633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.300634 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m18:05:15.300634 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" rename to "stg_dim_channels"
[0m18:05:15.301633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.301633 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m18:05:15.302968 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m18:05:15.302968 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m18:05:15.305367 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:15.306466 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m18:05:15.306466 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

      drop view if exists "warehouse"."main_stage"."stg_dim_channels__dbt_backup" cascade
    
[0m18:05:15.307487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:15.308492 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m18:05:15.308492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA9E9130>]}
[0m18:05:15.308492 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main_stage.stg_dim_channels ................... [[32mOK[0m in 0.02s]
[0m18:05:15.309979 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m18:05:15.309979 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m18:05:15.310989 [info ] [Thread-1 (]: 3 of 4 START sql view model main_marts.fact_audience ........................... [RUN]
[0m18:05:15.310989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_dim_channels, now model.tv_audience_mini.fact_audience)
[0m18:05:15.310989 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.fact_audience
[0m18:05:15.312985 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.fact_audience"
[0m18:05:15.313987 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.fact_audience
[0m18:05:15.315104 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.fact_audience"
[0m18:05:15.316182 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m18:05:15.316182 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: BEGIN
[0m18:05:15.317167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:15.317167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.317167 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m18:05:15.317167 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

  
  create view "warehouse"."main_marts"."fact_audience__dbt_tmp" as (
    with m as (
  select
    a.date,
    a.country,
    coalesce(d.channel_std, upper(a.channel)) as channel_std,
    a.program,
    a.viewers
  from "warehouse"."main_stage"."stg_audience" a
  left join "warehouse"."main_stage"."stg_dim_channels" d
    on a.country = d.country
   and upper(a.channel) = d.alias
)
select * from m
  );

[0m18:05:15.318166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:15.320678 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m18:05:15.321697 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience" rename to "fact_audience__dbt_backup"
[0m18:05:15.321697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.322692 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m18:05:15.323922 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience__dbt_tmp" rename to "fact_audience"
[0m18:05:15.323922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.324958 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m18:05:15.324958 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m18:05:15.324958 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m18:05:15.327984 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:15.329997 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m18:05:15.329997 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

      drop view if exists "warehouse"."main_marts"."fact_audience__dbt_backup" cascade
    
[0m18:05:15.331016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:15.331998 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: Close
[0m18:05:15.331998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EAA60080>]}
[0m18:05:15.331998 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_marts.fact_audience ...................... [[32mOK[0m in 0.02s]
[0m18:05:15.332997 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m18:05:15.332997 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m18:05:15.333996 [info ] [Thread-1 (]: 4 of 4 START sql view model main_marts.kpi_top10 ............................... [RUN]
[0m18:05:15.333996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.fact_audience, now model.tv_audience_mini.kpi_top10)
[0m18:05:15.333996 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.kpi_top10
[0m18:05:15.335420 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.kpi_top10"
[0m18:05:15.336455 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.kpi_top10
[0m18:05:15.338474 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.kpi_top10"
[0m18:05:15.338474 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m18:05:15.339472 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: BEGIN
[0m18:05:15.339472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:15.339472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.339472 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m18:05:15.340472 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

  
  create view "warehouse"."main_marts"."kpi_top10__dbt_tmp" as (
    with base as (
  select
    date, country, channel_std, program, viewers,
    row_number() over (partition by date, country order by viewers desc) as rk
  from "warehouse"."main_marts"."fact_audience"
)
select
  date, country, channel_std, program, viewers,
  rk as rank_in_country
from base
where rk <= 10
order by date, country, rk
  );

[0m18:05:15.341471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:15.343471 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m18:05:15.343471 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10" rename to "kpi_top10__dbt_backup"
[0m18:05:15.343471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.345546 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m18:05:15.345546 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10__dbt_tmp" rename to "kpi_top10"
[0m18:05:15.345546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:15.346591 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m18:05:15.346591 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m18:05:15.346591 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m18:05:15.349591 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:05:15.351592 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m18:05:15.351592 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

      drop view if exists "warehouse"."main_marts"."kpi_top10__dbt_backup" cascade
    
[0m18:05:15.352592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:15.353593 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: Close
[0m18:05:15.353593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59aaba56-a196-4a46-ba59-3d70116bddb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA9E5D90>]}
[0m18:05:15.354682 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_marts.kpi_top10 .......................... [[32mOK[0m in 0.02s]
[0m18:05:15.361710 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m18:05:15.361710 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:15.361710 [debug] [MainThread]: On master: BEGIN
[0m18:05:15.362833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:15.362833 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:15.362833 [debug] [MainThread]: On master: COMMIT
[0m18:05:15.362833 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:15.362833 [debug] [MainThread]: On master: COMMIT
[0m18:05:15.363838 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:15.363838 [debug] [MainThread]: On master: Close
[0m18:05:15.363838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:15.363838 [debug] [MainThread]: Connection 'create_warehouse_main_stage' was properly closed.
[0m18:05:15.364940 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m18:05:15.364940 [debug] [MainThread]: Connection 'model.tv_audience_mini.kpi_top10' was properly closed.
[0m18:05:15.364940 [info ] [MainThread]: 
[0m18:05:15.364940 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:05:15.366017 [debug] [MainThread]: Command end result
[0m18:05:15.378203 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m18:05:15.379188 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m18:05:15.383187 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m18:05:15.384190 [info ] [MainThread]: 
[0m18:05:15.384190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:15.384190 [info ] [MainThread]: 
[0m18:05:15.384190 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:05:15.385318 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:15.385318 after 1.47 seconds
[0m18:05:15.385318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E7BD9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E834E9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E834E8A0>]}
[0m18:05:15.385318 [debug] [MainThread]: Flushing usage events
[0m18:05:16.143512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:11.129863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B444DB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B44C1FBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B44C1E8A0>]}


============================== 11:38:11.136461 | a1a87015-1f60-4398-a6ee-520bf049cdcd ==============================
[0m11:38:11.136461 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:11.137485 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:38:11.343192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B455D3AA0>]}
[0m11:38:11.422563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B44F83500>]}
[0m11:38:11.427580 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:11.652700 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:11.773510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:11.773510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:11.800780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B46E737A0>]}
[0m11:38:11.855320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:11.859585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:11.885232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B46FEB980>]}
[0m11:38:11.885232 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:11.886232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B4718E180>]}
[0m11:38:11.887218 [info ] [MainThread]: 
[0m11:38:11.888214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:11.888214 [info ] [MainThread]: 
[0m11:38:11.889216 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:11.894217 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:38:11.981563 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:11.981563 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:11.981563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:11.994878 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:38:11.996293 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:38:11.998304 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:11.998304 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:11.998304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:11.999303 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:12.000310 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:38:12.001309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stage)
[0m11:38:12.001309 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m11:38:12.005307 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:12.006322 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:38:12.006322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:12.007306 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:12.008323 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:12.008323 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m11:38:12.009330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:12.009330 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:12.009330 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m11:38:12.009330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:12.010307 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m11:38:12.010307 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:12.010307 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m11:38:12.011308 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:12.011308 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m11:38:12.012307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_stage, now create_warehouse_main_marts)
[0m11:38:12.012307 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m11:38:12.013307 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:12.013307 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:38:12.013307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:12.014834 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:12.015850 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:12.015850 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m11:38:12.015850 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:12.015850 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:12.016849 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m11:38:12.016849 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:12.017850 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m11:38:12.017850 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:12.017850 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m11:38:12.017850 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:12.018847 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m11:38:12.019878 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m11:38:12.022846 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:12.023863 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:12.023863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:12.023863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:12.023863 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:12.023863 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:12.040644 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:38:12.041638 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:12.042621 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:12.042621 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:12.044119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m11:38:12.045141 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:12.045141 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:12.045141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:12.046140 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:12.046140 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:12.046140 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:12.049146 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:38:12.050139 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:12.050139 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:12.050139 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:12.051139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B46FEAC00>]}
[0m11:38:12.052123 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:12.052123 [debug] [MainThread]: On master: BEGIN
[0m11:38:12.052123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:12.052123 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:12.053122 [debug] [MainThread]: On master: COMMIT
[0m11:38:12.053122 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:12.053122 [debug] [MainThread]: On master: COMMIT
[0m11:38:12.053122 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:12.054165 [debug] [MainThread]: On master: Close
[0m11:38:12.058339 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m11:38:12.059425 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m11:38:12.059425 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m11:38:12.059425 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m11:38:12.063434 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m11:38:12.064434 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m11:38:12.087361 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m11:38:12.088358 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:12.088358 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m11:38:12.088358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:12.089368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:12.089368 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:12.090347 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m11:38:12.091344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:12.095343 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:12.096373 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience" rename to "stg_audience__dbt_backup"
[0m11:38:12.096373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.099370 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:12.099370 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience__dbt_tmp" rename to "stg_audience"
[0m11:38:12.099370 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.108382 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m11:38:12.109382 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:12.109382 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m11:38:12.113382 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:38:12.120905 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:12.120905 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

      drop view if exists "warehouse"."main_stage"."stg_audience__dbt_backup" cascade
    
[0m11:38:12.122890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:12.123889 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m11:38:12.125894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B471922A0>]}
[0m11:38:12.125894 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_stage.stg_audience ....................... [[32mOK[0m in 0.07s]
[0m11:38:12.126893 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m11:38:12.126893 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m11:38:12.127890 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m11:38:12.127890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m11:38:12.127890 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m11:38:12.129892 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m11:38:12.129892 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m11:38:12.131923 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m11:38:12.132906 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:12.132906 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m11:38:12.133907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:12.133907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:12.133907 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:12.134905 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m11:38:12.134905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.137911 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:12.137911 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels" rename to "stg_dim_channels__dbt_backup"
[0m11:38:12.138888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.141905 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:12.141905 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" rename to "stg_dim_channels"
[0m11:38:12.142906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.144906 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m11:38:12.144906 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:12.144906 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m11:38:12.147978 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:12.148981 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:12.148981 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

      drop view if exists "warehouse"."main_stage"."stg_dim_channels__dbt_backup" cascade
    
[0m11:38:12.150980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:12.150980 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m11:38:12.151980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B475EF3B0>]}
[0m11:38:12.151980 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main_stage.stg_dim_channels ................... [[32mOK[0m in 0.02s]
[0m11:38:12.152983 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m11:38:12.152983 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m11:38:12.154209 [info ] [Thread-1 (]: 3 of 4 START sql view model main_marts.fact_audience ........................... [RUN]
[0m11:38:12.154209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_dim_channels, now model.tv_audience_mini.fact_audience)
[0m11:38:12.154209 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.fact_audience
[0m11:38:12.157217 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.fact_audience"
[0m11:38:12.158217 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.fact_audience
[0m11:38:12.159232 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.fact_audience"
[0m11:38:12.160238 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:12.160238 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: BEGIN
[0m11:38:12.161229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:12.161229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.161229 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:12.162231 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

  
  create view "warehouse"."main_marts"."fact_audience__dbt_tmp" as (
    with m as (
  select
    a.date,
    a.country,
    coalesce(d.channel_std, upper(a.channel)) as channel_std,
    a.program,
    a.viewers
  from "warehouse"."main_stage"."stg_audience" a
  left join "warehouse"."main_stage"."stg_dim_channels" d
    on a.country = d.country
   and upper(a.channel) = d.alias
)
select * from m
  );

[0m11:38:12.163230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:12.165445 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:12.165445 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience" rename to "fact_audience__dbt_backup"
[0m11:38:12.166421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.167422 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:12.167422 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience__dbt_tmp" rename to "fact_audience"
[0m11:38:12.168424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.169424 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m11:38:12.169424 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:12.169424 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m11:38:12.172423 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:12.174704 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:12.175890 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

      drop view if exists "warehouse"."main_marts"."fact_audience__dbt_backup" cascade
    
[0m11:38:12.176860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:12.177990 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: Close
[0m11:38:12.178866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B47658B90>]}
[0m11:38:12.178866 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_marts.fact_audience ...................... [[32mOK[0m in 0.02s]
[0m11:38:12.178866 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m11:38:12.180242 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m11:38:12.180242 [info ] [Thread-1 (]: 4 of 4 START sql view model main_marts.kpi_top10 ............................... [RUN]
[0m11:38:12.180242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.fact_audience, now model.tv_audience_mini.kpi_top10)
[0m11:38:12.180242 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.kpi_top10
[0m11:38:12.182263 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.kpi_top10"
[0m11:38:12.183254 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.kpi_top10
[0m11:38:12.185717 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.kpi_top10"
[0m11:38:12.186738 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:12.186738 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: BEGIN
[0m11:38:12.186738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:12.186738 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.187739 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:12.187739 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

  
  create view "warehouse"."main_marts"."kpi_top10__dbt_tmp" as (
    with base as (
  select
    date, country, channel_std, program, viewers,
    row_number() over (partition by date, country order by viewers desc) as rk
  from "warehouse"."main_marts"."fact_audience"
)
select
  date, country, channel_std, program, viewers,
  rk as rank_in_country
from base
where rk <= 10
order by date, country, rk
  );

[0m11:38:12.189828 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:12.191744 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:12.191744 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10" rename to "kpi_top10__dbt_backup"
[0m11:38:12.191744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.194040 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:12.195044 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10__dbt_tmp" rename to "kpi_top10"
[0m11:38:12.195044 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:12.196042 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m11:38:12.196042 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:12.197044 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m11:38:12.199042 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:12.201101 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:12.201101 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

      drop view if exists "warehouse"."main_marts"."kpi_top10__dbt_backup" cascade
    
[0m11:38:12.202145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:12.203641 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: Close
[0m11:38:12.203641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a87015-1f60-4398-a6ee-520bf049cdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B4765AD20>]}
[0m11:38:12.203641 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_marts.kpi_top10 .......................... [[32mOK[0m in 0.02s]
[0m11:38:12.204718 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m11:38:12.204718 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:12.204718 [debug] [MainThread]: On master: BEGIN
[0m11:38:12.205779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:12.205779 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:12.205779 [debug] [MainThread]: On master: COMMIT
[0m11:38:12.205779 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:12.206868 [debug] [MainThread]: On master: COMMIT
[0m11:38:12.206868 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:12.206868 [debug] [MainThread]: On master: Close
[0m11:38:12.207875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:12.207875 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m11:38:12.207875 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m11:38:12.207875 [debug] [MainThread]: Connection 'model.tv_audience_mini.kpi_top10' was properly closed.
[0m11:38:12.207875 [info ] [MainThread]: 
[0m11:38:12.207875 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m11:38:12.208875 [debug] [MainThread]: Command end result
[0m11:38:12.262176 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:12.264213 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:12.268441 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:12.268441 [info ] [MainThread]: 
[0m11:38:12.268441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:12.269455 [info ] [MainThread]: 
[0m11:38:12.269455 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:38:12.269455 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:12.269455 after 1.36 seconds
[0m11:38:12.270441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B44B88860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B424BF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B4548EE70>]}
[0m11:38:12.270441 [debug] [MainThread]: Flushing usage events
[0m11:38:13.401564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:15.280046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DEA60D520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DEA60FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DEA60FD70>]}


============================== 11:38:15.283048 | 423ab7d3-8006-4f74-8317-67cd47bd448d ==============================
[0m11:38:15.283048 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:15.283048 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None'}
[0m11:38:15.291274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184861B9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184855DC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848825FEC0>]}


============================== 11:38:15.294902 | 36683f54-8702-4318-ab91-c015f2714896 ==============================
[0m11:38:15.294902 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:15.294902 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m11:38:15.518156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184899B5010>]}
[0m11:38:15.518156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '423ab7d3-8006-4f74-8317-67cd47bd448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DEC990740>]}
[0m11:38:15.570089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018489AE3530>]}
[0m11:38:15.571089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '423ab7d3-8006-4f74-8317-67cd47bd448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DEAAF07A0>]}
[0m11:38:15.572075 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:15.572075 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:15.803697 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:15.807021 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:15.897565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:15.897565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:15.909079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:15.909079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:15.928986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '423ab7d3-8006-4f74-8317-67cd47bd448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DEC319580>]}
[0m11:38:15.937986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018489AC2360>]}
[0m11:38:15.983463 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:15.985834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:15.985834 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:15.987898 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:16.008423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848A4A8DA0>]}
[0m11:38:16.008423 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:16.008423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848A4DAC90>]}
[0m11:38:16.010422 [info ] [MainThread]: 
[0m11:38:16.010422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:16.010422 [info ] [MainThread]: 
[0m11:38:16.011422 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:16.013421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '423ab7d3-8006-4f74-8317-67cd47bd448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DECB35550>]}
[0m11:38:16.014420 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:16.014420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:38:16.014420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '423ab7d3-8006-4f74-8317-67cd47bd448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DEC32DFA0>]}
[0m11:38:16.018438 [info ] [MainThread]: 
[0m11:38:16.018438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:16.018438 [info ] [MainThread]: 
[0m11:38:16.019422 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:16.022887 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:16.081481 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:16.081481 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:16.082481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:16.091766 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:16.091766 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:16.092765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:16.096009 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:38:16.097009 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:38:16.099025 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:16.099025 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:16.099025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:16.100027 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:16.101009 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:38:16.102009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m11:38:16.102009 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m11:38:16.106287 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:16.107315 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:38:16.107315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:16.108298 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:16.109297 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:16.109297 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m11:38:16.109297 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:16.110298 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:16.110298 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m11:38:16.110298 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:16.111302 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m11:38:16.111302 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:16.112300 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m11:38:16.112300 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:16.112300 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m11:38:16.113299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_stage)
[0m11:38:16.113299 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m11:38:16.114413 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:16.114413 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:38:16.115559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:16.115559 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:16.116540 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:16.116540 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m11:38:16.117556 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:16.117556 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:16.117556 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m11:38:16.118541 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:16.118541 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m11:38:16.118541 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:16.119557 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m11:38:16.119557 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:16.119557 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m11:38:16.121443 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:16.125053 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:16.125053 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:16.125053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:16.125053 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:16.126142 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:16.126142 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:16.138689 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:38:16.139697 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:16.140697 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:16.140697 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:16.141696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:16.143680 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:16.143680 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:16.143680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:16.144781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:16.144781 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:16.144781 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:16.146880 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:38:16.149269 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:16.150286 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:16.150286 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:16.151270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848589BD70>]}
[0m11:38:16.151270 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:16.152269 [debug] [MainThread]: On master: BEGIN
[0m11:38:16.152269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:16.153269 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:38:16.153269 [debug] [MainThread]: On master: COMMIT
[0m11:38:16.154270 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:16.154270 [debug] [MainThread]: On master: COMMIT
[0m11:38:16.155270 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:16.155270 [debug] [MainThread]: On master: Close
[0m11:38:16.159270 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m11:38:16.159270 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m11:38:16.159270 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m11:38:16.160272 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m11:38:16.164291 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m11:38:16.165271 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m11:38:16.197814 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m11:38:16.199809 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:16.199809 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m11:38:16.199809 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:16.200816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:16.200816 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:16.200816 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m11:38:16.200816 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m11:38:16.200816 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:16.201816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:16.201816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:16.202842 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:16.203831 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:16.203831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:16.206002 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:16.206002 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience" rename to "stg_audience__dbt_backup"
[0m11:38:16.207013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.210026 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:16.210026 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience__dbt_tmp" rename to "stg_audience"
[0m11:38:16.211023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.218983 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m11:38:16.219983 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:16.219983 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m11:38:16.223115 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:38:16.227645 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:16.227645 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

      drop view if exists "warehouse"."main_stage"."stg_audience__dbt_backup" cascade
    
[0m11:38:16.230045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:16.234156 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m11:38:16.236349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848A94AE70>]}
[0m11:38:16.237352 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_stage.stg_audience ....................... [[32mOK[0m in 0.07s]
[0m11:38:16.238350 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m11:38:16.238350 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m11:38:16.239374 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m11:38:16.240426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m11:38:16.240426 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m11:38:16.242334 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m11:38:16.243332 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m11:38:16.245959 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m11:38:16.246856 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:16.246856 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m11:38:16.246856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:16.247856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:16.247856 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:16.248860 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m11:38:16.248860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.251856 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:16.251856 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels" rename to "stg_dim_channels__dbt_backup"
[0m11:38:16.251856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.253855 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:16.254997 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" rename to "stg_dim_channels"
[0m11:38:16.254997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.256096 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m11:38:16.256096 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:16.256096 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m11:38:16.259093 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:16.261094 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:16.262094 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

      drop view if exists "warehouse"."main_stage"."stg_dim_channels__dbt_backup" cascade
    
[0m11:38:16.263094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:16.265230 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m11:38:16.266382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848A91BE00>]}
[0m11:38:16.267382 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main_stage.stg_dim_channels ................... [[32mOK[0m in 0.03s]
[0m11:38:16.268480 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m11:38:16.269381 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m11:38:16.269381 [info ] [Thread-1 (]: 3 of 4 START sql view model main_marts.fact_audience ........................... [RUN]
[0m11:38:16.270499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_dim_channels, now model.tv_audience_mini.fact_audience)
[0m11:38:16.270499 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.fact_audience
[0m11:38:16.273603 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.fact_audience"
[0m11:38:16.273603 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.fact_audience
[0m11:38:16.276584 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.fact_audience"
[0m11:38:16.276584 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:16.277690 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: BEGIN
[0m11:38:16.277690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:16.277690 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.277690 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:16.278745 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

  
  create view "warehouse"."main_marts"."fact_audience__dbt_tmp" as (
    with m as (
  select
    a.date,
    a.country,
    coalesce(d.channel_std, upper(a.channel)) as channel_std,
    a.program,
    a.viewers
  from "warehouse"."main_stage"."stg_audience" a
  left join "warehouse"."main_stage"."stg_dim_channels" d
    on a.country = d.country
   and upper(a.channel) = d.alias
)
select * from m
  );

[0m11:38:16.280825 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:16.283807 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:16.285169 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience" rename to "fact_audience__dbt_backup"
[0m11:38:16.286515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.289508 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:16.290525 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience__dbt_tmp" rename to "fact_audience"
[0m11:38:16.290525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.292378 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m11:38:16.293508 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:16.293508 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m11:38:16.296370 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:16.301350 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:16.301350 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

      drop view if exists "warehouse"."main_marts"."fact_audience__dbt_backup" cascade
    
[0m11:38:16.302349 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m11:38:16.303356 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:16.303356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:16.303356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:16.304665 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:16.304665 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: Close
[0m11:38:16.304665 [info ] [MainThread]: 
[0m11:38:16.304665 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.29 seconds (0.29s).
 '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848A998830>]}
[0m11:38:16.306017 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\dev\tv_audience_mini_pipeline\warehouse.duckdb": Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus.
  
  File is already open in 
  C:\Users\delma\AppData\Local\Programs\Python\Python312\python.exe (PID 27400)
[0m11:38:16.306017 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_marts.fact_audience ...................... [[32mOK[0m in 0.03s]
[0m11:38:16.307526 [debug] [MainThread]: Command `dbt test` failed at 11:38:16.307526 after 1.17 seconds
[0m11:38:16.307526 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m11:38:16.307526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DEB18F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DECE72A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DECE989E0>]}
[0m11:38:16.308531 [debug] [MainThread]: Flushing usage events
[0m11:38:16.308531 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m11:38:16.309676 [info ] [Thread-1 (]: 4 of 4 START sql view model main_marts.kpi_top10 ............................... [RUN]
[0m11:38:16.309676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.fact_audience, now model.tv_audience_mini.kpi_top10)
[0m11:38:16.310647 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.kpi_top10
[0m11:38:16.313682 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.kpi_top10"
[0m11:38:16.313682 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.kpi_top10
[0m11:38:16.316442 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.kpi_top10"
[0m11:38:16.317451 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:16.317451 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: BEGIN
[0m11:38:16.318431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:16.318431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:16.318431 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:16.319441 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

  
  create view "warehouse"."main_marts"."kpi_top10__dbt_tmp" as (
    with base as (
  select
    date, country, channel_std, program, viewers,
    row_number() over (partition by date, country order by viewers desc) as rk
  from "warehouse"."main_marts"."fact_audience"
)
select
  date, country, channel_std, program, viewers,
  rk as rank_in_country
from base
where rk <= 10
order by date, country, rk
  );

[0m11:38:16.321077 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:16.323092 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:16.324539 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10" rename to "kpi_top10__dbt_backup"
[0m11:38:16.325702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:16.328780 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:16.328780 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10__dbt_tmp" rename to "kpi_top10"
[0m11:38:16.329774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:16.330769 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m11:38:16.330769 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:16.331772 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m11:38:16.333799 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:16.337521 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:16.337521 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

      drop view if exists "warehouse"."main_marts"."kpi_top10__dbt_backup" cascade
    
[0m11:38:16.340526 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:16.341517 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: Close
[0m11:38:16.342514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36683f54-8702-4318-ab91-c015f2714896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848A90CCB0>]}
[0m11:38:16.343510 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_marts.kpi_top10 .......................... [[32mOK[0m in 0.03s]
[0m11:38:16.343510 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m11:38:16.346224 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:16.346224 [debug] [MainThread]: On master: BEGIN
[0m11:38:16.346224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:16.347237 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:38:16.348206 [debug] [MainThread]: On master: COMMIT
[0m11:38:16.348206 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:16.348206 [debug] [MainThread]: On master: COMMIT
[0m11:38:16.349224 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:16.350234 [debug] [MainThread]: On master: Close
[0m11:38:16.350234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:16.351209 [debug] [MainThread]: Connection 'create_warehouse_main_stage' was properly closed.
[0m11:38:16.351209 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:16.351209 [debug] [MainThread]: Connection 'model.tv_audience_mini.kpi_top10' was properly closed.
[0m11:38:16.352215 [info ] [MainThread]: 
[0m11:38:16.353218 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:38:16.354579 [debug] [MainThread]: Command end result
[0m11:38:16.415139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:16.417970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:16.421832 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:16.421832 [info ] [MainThread]: 
[0m11:38:16.422946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:16.422946 [info ] [MainThread]: 
[0m11:38:16.422946 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:38:16.423945 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:16.423945 after 1.27 seconds
[0m11:38:16.423945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018487BE2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848840F0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184857BE390>]}
[0m11:38:16.423945 [debug] [MainThread]: Flushing usage events
[0m11:38:17.292698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:17.393888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:19.231869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CAB29B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CAB67F500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CAB67D640>]}


============================== 11:38:19.235092 | 505b077f-a843-4e8f-b064-18b1c1938309 ==============================
[0m11:38:19.235092 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:19.235092 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:38:19.332978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FB9EB320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FBE1F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FBE1F980>]}


============================== 11:38:19.337306 | 1da57415-ac0b-4966-a77f-e12e0e2428e7 ==============================
[0m11:38:19.337306 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:19.337306 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m11:38:19.432120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '505b077f-a843-4e8f-b064-18b1c1938309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CAD512540>]}
[0m11:38:19.480555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '505b077f-a843-4e8f-b064-18b1c1938309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CA93E7E60>]}
[0m11:38:19.483542 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:19.542445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1da57415-ac0b-4966-a77f-e12e0e2428e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FE167710>]}
[0m11:38:19.610738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1da57415-ac0b-4966-a77f-e12e0e2428e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC99DA60>]}
[0m11:38:19.611759 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:19.770398 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:19.845792 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:19.863470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:19.863470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:19.891707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '505b077f-a843-4e8f-b064-18b1c1938309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CADBF7C20>]}
[0m11:38:19.939268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:19.941274 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:19.954481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:19.954481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:19.972975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '505b077f-a843-4e8f-b064-18b1c1938309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CADBF4AD0>]}
[0m11:38:19.972975 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:19.974981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '505b077f-a843-4e8f-b064-18b1c1938309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CADF11280>]}
[0m11:38:19.976486 [info ] [MainThread]: 
[0m11:38:19.976486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:19.976486 [info ] [MainThread]: 
[0m11:38:19.976486 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:19.985002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m11:38:19.986749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1da57415-ac0b-4966-a77f-e12e0e2428e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FE2ED5B0>]}
[0m11:38:20.046997 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:20.049004 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:20.069168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1da57415-ac0b-4966-a77f-e12e0e2428e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FE67E870>]}
[0m11:38:20.069168 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:20.069168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1da57415-ac0b-4966-a77f-e12e0e2428e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC34D850>]}
[0m11:38:20.077669 [info ] [MainThread]: 
[0m11:38:20.079680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:20.079680 [info ] [MainThread]: 
[0m11:38:20.079680 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:20.086939 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:38:20.098034 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:20.098034 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:20.098034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:20.120076 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m11:38:20.120076 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:20.122085 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:20.138536 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m11:38:20.144418 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:20.146425 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:20.148432 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:20.148432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m11:38:20.150441 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:20.150441 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:20.150441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:20.150441 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:20.150441 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:20.150441 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:20.159036 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:38:20.160065 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:20.161874 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:20.161874 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:20.161874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '505b077f-a843-4e8f-b064-18b1c1938309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CADDEDB50>]}
[0m11:38:20.163881 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:20.163881 [debug] [MainThread]: On master: BEGIN
[0m11:38:20.163881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:20.163881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:38:20.163881 [debug] [MainThread]: On master: COMMIT
[0m11:38:20.165887 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:20.165887 [debug] [MainThread]: On master: COMMIT
[0m11:38:20.165887 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:20.165887 [debug] [MainThread]: On master: Close
[0m11:38:20.168696 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:20.168696 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:38:20.171998 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:20.171998 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:20.194093 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:20.197202 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:20.216031 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:20.218932 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:20.218932 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:38:20.219945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:20.220945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.220945 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:20.221945 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.223945 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:20.223945 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:20.223945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:20.231730 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:38:20.237874 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:38:20.238860 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:20.239860 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:38:20.240860 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.07s]
[0m11:38:20.241873 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:20.241873 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:20.242874 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:38:20.243861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:38:20.243861 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:20.248956 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:20.250956 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:20.254091 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:20.255091 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:20.256133 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:38:20.256133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.257149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.258149 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:20.259150 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.265804 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:20.266821 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:38:20.267821 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:38:20.268823 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:38:20.268823 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.03s]
[0m11:38:20.269807 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:20.269807 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:20.269807 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:38:20.270821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:38:20.270821 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:20.274935 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:20.276007 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:20.278020 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:20.279007 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:20.279007 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:38:20.279007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.280007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.280007 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:20.280007 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.283005 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:20.284172 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:38:20.284172 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:38:20.285190 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:38:20.285190 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.01s]
[0m11:38:20.286231 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:20.286231 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:20.286231 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:38:20.287246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:38:20.287246 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:20.290232 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:20.291243 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:20.292232 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:20.293247 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:20.293247 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:38:20.293247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.294380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.294380 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:20.294380 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.299506 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:38:20.300521 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:38:20.301522 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:38:20.301522 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:38:20.301522 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.02s]
[0m11:38:20.302521 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:20.302521 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:20.302521 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:38:20.303522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:38:20.303522 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:20.306696 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:20.306696 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:20.308695 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:20.309683 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:20.309683 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:38:20.309683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.310681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:20.310681 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:20.310681 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.313707 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:20.315840 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:38:20.316858 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:38:20.318283 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:38:20.318283 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.02s]
[0m11:38:20.319302 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:20.320303 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:20.320303 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:38:20.321303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:38:20.322303 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:20.327205 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:20.329934 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:20.329934 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:20.329934 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:20.332004 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:20.332004 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:20.333005 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:20.333005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:20.333005 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:20.333988 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:38:20.333988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.335133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.335133 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:20.335133 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.338332 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:20.339350 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:38:20.341147 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:38:20.341147 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:38:20.341147 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.02s]
[0m11:38:20.341147 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:20.342156 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:20.342156 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:38:20.342156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:38:20.343156 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:20.345262 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:20.345262 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:20.347381 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:20.347381 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:20.347381 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:38:20.348398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.348398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.349381 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:20.349381 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.351397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.352398 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:38:20.352398 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:38:20.353399 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:38:20.353399 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:20.353399 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:20.354508 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:20.354508 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:38:20.354508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:38:20.355654 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:20.358646 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:20.359646 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:20.361628 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:20.362646 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:20.362646 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:38:20.363629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.363629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.364702 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:20.364702 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.365802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.366786 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:38:20.367803 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:38:20.367803 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:38:20.368803 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:38:20.368803 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:20.369802 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:20.369802 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:38:20.369802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:38:20.369802 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:20.374029 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:20.375353 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:20.377325 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:20.378385 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:20.378385 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:38:20.378385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.379444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.380323 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:20.380323 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.383510 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:20.384603 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:38:20.385721 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:38:20.385721 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:38:20.386722 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.02s]
[0m11:38:20.387721 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:20.387721 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:20.388722 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:38:20.388722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:38:20.388722 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:20.391723 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:20.391723 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:20.393722 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:20.393722 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:20.393722 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:38:20.393722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.394950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:20.394950 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:20.394950 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.396990 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.398192 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:38:20.398192 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:38:20.399226 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:38:20.399226 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:20.400203 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:20.400203 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:20.400203 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:38:20.401203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:38:20.401203 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:20.404319 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:20.404319 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:20.406375 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:20.407376 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:20.407376 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:38:20.407376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.408359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.408359 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:20.408359 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.410359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.411376 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:38:20.412377 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:38:20.412377 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:38:20.412377 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:20.413402 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:20.413402 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:20.413402 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:38:20.414546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:38:20.414546 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:20.416772 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:20.417756 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:20.419771 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:20.420772 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:20.420772 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:38:20.420772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.421755 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:20.421755 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:20.422771 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.422771 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.423755 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:38:20.424948 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:38:20.424948 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:38:20.425991 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:38:20.425991 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:20.425991 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:20.425991 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:20.425991 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:20.425991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:20.425991 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m11:38:20.425991 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:38:20.427499 [info ] [MainThread]: 
[0m11:38:20.427499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:38:20.427499 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:38:20.427499 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:20.427499 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\dev\tv_audience_mini_pipeline\warehouse.duckdb": Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus.
  
  File is already open in 
  C:\Users\delma\AppData\Local\Programs\Python\Python312\python.exe (PID 19276)
[0m11:38:20.428505 [debug] [MainThread]: Command `dbt run` failed at 11:38:20.428505 after 1.22 seconds
[0m11:38:20.428505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC8AF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC96DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FE6F3F80>]}
[0m11:38:20.428505 [debug] [MainThread]: Flushing usage events
[0m11:38:20.430507 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:20.431508 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:20.433545 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:20.433545 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:20.434646 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:38:20.434646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.434646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.435671 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:20.435671 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.436671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.437684 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:38:20.438685 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:38:20.438685 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:38:20.438685 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:38:20.439685 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:20.439685 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:20.439685 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:38:20.440684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:38:20.440684 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:20.444796 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:20.444796 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:20.485238 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:20.486341 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:20.486341 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:38:20.486341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.487339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.487339 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:20.488341 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:20.489318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:20.490339 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:38:20.491319 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:38:20.491319 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:38:20.491319 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.05s]
[0m11:38:20.492340 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:20.492340 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:20.492340 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:38:20.493335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:38:20.493335 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:20.497628 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:20.498616 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:20.500609 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:20.500609 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:20.501587 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:38:20.501587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:20.501587 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:20.502638 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:20.502638 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:38:20.510154 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:38:20.512142 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:38:20.513157 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:38:20.513157 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:38:20.514359 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:38:20.514359 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:20.516410 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:20.516410 [debug] [MainThread]: On master: BEGIN
[0m11:38:20.516410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:20.517466 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:20.517466 [debug] [MainThread]: On master: COMMIT
[0m11:38:20.517466 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:20.517466 [debug] [MainThread]: On master: COMMIT
[0m11:38:20.518515 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:20.518515 [debug] [MainThread]: On master: Close
[0m11:38:20.518515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:20.519410 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m11:38:20.519410 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:38:20.519410 [info ] [MainThread]: 
[0m11:38:20.519410 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m11:38:20.520410 [debug] [MainThread]: Command end result
[0m11:38:20.535810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:20.537678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:20.543679 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:20.543679 [info ] [MainThread]: 
[0m11:38:20.543679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:20.544763 [info ] [MainThread]: 
[0m11:38:20.544763 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:38:20.544763 [debug] [MainThread]: Command `dbt test` succeeded at 11:38:20.544763 after 1.44 seconds
[0m11:38:20.545879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CAB6A1F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CAB948680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CAC15F6E0>]}
[0m11:38:20.545879 [debug] [MainThread]: Flushing usage events
[0m11:38:21.493645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:21.591988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:23.574252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18E387A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C190F85640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C190F854C0>]}


============================== 11:38:23.577338 | 3c8e7a43-9362-43c6-8f07-b40050ec7694 ==============================
[0m11:38:23.577338 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:23.575319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687850B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026878F8F980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026878F8EC60>]}
[0m11:38:23.578336 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}


============================== 11:38:23.578336 | 6224eac1-39c1-4ad8-b907-74159dc01cc1 ==============================
[0m11:38:23.578336 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:23.579323 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None'}
[0m11:38:23.805829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6224eac1-39c1-4ad8-b907-74159dc01cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268789CA810>]}
[0m11:38:23.812786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C192CC19D0>]}
[0m11:38:23.856851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6224eac1-39c1-4ad8-b907-74159dc01cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026876657E60>]}
[0m11:38:23.858849 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:23.862731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19096DA60>]}
[0m11:38:23.863720 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:24.103480 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:24.116741 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:24.192233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:24.193138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:24.215022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:24.215022 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:24.220122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1925FFFB0>]}
[0m11:38:24.245256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6224eac1-39c1-4ad8-b907-74159dc01cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687AE60D70>]}
[0m11:38:24.274466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:24.276620 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:24.294514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C192E669C0>]}
[0m11:38:24.294514 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:24.294514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C192E3BF80>]}
[0m11:38:24.295666 [info ] [MainThread]: 
[0m11:38:24.296649 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:24.296649 [info ] [MainThread]: 
[0m11:38:24.296649 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:24.298651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:24.300653 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:38:24.301653 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:24.331651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6224eac1-39c1-4ad8-b907-74159dc01cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B27FFB0>]}
[0m11:38:24.331651 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:24.331651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6224eac1-39c1-4ad8-b907-74159dc01cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B26B740>]}
[0m11:38:24.333306 [info ] [MainThread]: 
[0m11:38:24.333306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:24.334329 [info ] [MainThread]: 
[0m11:38:24.334329 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:24.338435 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:24.367249 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:24.368245 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:24.368245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:24.381932 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:38:24.382931 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:38:24.383932 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:24.383932 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:24.385054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:24.386172 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:24.387154 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:38:24.388170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_marts)
[0m11:38:24.388170 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m11:38:24.393157 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:24.393157 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:38:24.393157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:24.394325 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:24.395306 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:24.395306 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m11:38:24.396349 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:24.396349 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:24.396349 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m11:38:24.397350 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:24.397350 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m11:38:24.397350 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:24.398352 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m11:38:24.398352 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:24.398352 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m11:38:24.399397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_marts, now create_warehouse_main_stage)
[0m11:38:24.399397 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m11:38:24.400352 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:24.400352 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:38:24.401459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:24.401459 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:24.401459 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:24.402351 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:24.402351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:24.402351 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:24.402351 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m11:38:24.403350 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:24.403350 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:24.403350 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m11:38:24.403350 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:24.404571 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m11:38:24.404571 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:24.404571 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m11:38:24.405723 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:24.405723 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m11:38:24.407036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:24.411042 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:24.411042 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:24.411042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:24.412043 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:24.412043 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:24.412043 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:24.422278 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:38:24.423263 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:24.424335 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:24.425445 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:24.425445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:24.427445 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:24.427445 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:24.427445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:24.428445 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:24.428445 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:24.428445 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:24.431430 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:38:24.431430 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:24.432933 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:24.432933 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:24.433954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C192DA6BA0>]}
[0m11:38:24.433954 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:24.433954 [debug] [MainThread]: On master: BEGIN
[0m11:38:24.433954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:24.435049 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:24.435049 [debug] [MainThread]: On master: COMMIT
[0m11:38:24.435049 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:24.435049 [debug] [MainThread]: On master: COMMIT
[0m11:38:24.436170 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:24.436170 [debug] [MainThread]: On master: Close
[0m11:38:24.439150 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m11:38:24.439150 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m11:38:24.440150 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m11:38:24.440150 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m11:38:24.445275 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m11:38:24.445275 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m11:38:24.467930 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m11:38:24.468930 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:24.468930 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m11:38:24.469915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:24.469915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.470914 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:24.470914 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m11:38:24.471915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.476084 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:24.476084 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience" rename to "stg_audience__dbt_backup"
[0m11:38:24.477086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.480118 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:24.480118 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience__dbt_tmp" rename to "stg_audience"
[0m11:38:24.481164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.489618 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m11:38:24.489618 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:24.490618 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m11:38:24.495978 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:24.500314 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m11:38:24.501319 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:24.501319 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:24.501319 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

      drop view if exists "warehouse"."main_stage"."stg_audience__dbt_backup" cascade
    
[0m11:38:24.501319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:24.503325 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:24.503325 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:24.503325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:24.503325 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.505729 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m11:38:24.506788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18E48FCE0>]}
[0m11:38:24.507816 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_stage.stg_audience ....................... [[32mOK[0m in 0.07s]
[0m11:38:24.507816 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m11:38:24.507816 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m11:38:24.508820 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m11:38:24.508820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m11:38:24.509737 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m11:38:24.510731 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m11:38:24.511728 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m11:38:24.513744 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m11:38:24.514878 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:24.514878 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m11:38:24.514878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:24.514878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.515995 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:24.515995 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m11:38:24.515995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.518469 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:24.519492 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels" rename to "stg_dim_channels__dbt_backup"
[0m11:38:24.519492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.521485 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:24.521485 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" rename to "stg_dim_channels"
[0m11:38:24.522487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.523486 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m11:38:24.523486 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:24.523486 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m11:38:24.526673 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:24.527690 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:24.527690 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

      drop view if exists "warehouse"."main_stage"."stg_dim_channels__dbt_backup" cascade
    
[0m11:38:24.529678 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.529678 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m11:38:24.530690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1935E0920>]}
[0m11:38:24.530690 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main_stage.stg_dim_channels ................... [[32mOK[0m in 0.02s]
[0m11:38:24.531690 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m11:38:24.531690 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m11:38:24.531690 [info ] [Thread-1 (]: 3 of 4 START sql view model main_marts.fact_audience ........................... [RUN]
[0m11:38:24.533198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_dim_channels, now model.tv_audience_mini.fact_audience)
[0m11:38:24.534228 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.fact_audience
[0m11:38:24.537379 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.fact_audience"
[0m11:38:24.538378 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.fact_audience
[0m11:38:24.542379 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.fact_audience"
[0m11:38:24.543391 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:24.544458 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: BEGIN
[0m11:38:24.544458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:24.545522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.546522 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:24.546522 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

  
  create view "warehouse"."main_marts"."fact_audience__dbt_tmp" as (
    with m as (
  select
    a.date,
    a.country,
    coalesce(d.channel_std, upper(a.channel)) as channel_std,
    a.program,
    a.viewers
  from "warehouse"."main_stage"."stg_audience" a
  left join "warehouse"."main_stage"."stg_dim_channels" d
    on a.country = d.country
   and upper(a.channel) = d.alias
)
select * from m
  );

[0m11:38:24.549507 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:24.552521 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:24.553506 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience" rename to "fact_audience__dbt_backup"
[0m11:38:24.554652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.557747 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:24.557747 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience__dbt_tmp" rename to "fact_audience"
[0m11:38:24.558746 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.560730 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m11:38:24.561747 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:24.561747 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m11:38:24.564788 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:24.566881 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:24.566881 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

      drop view if exists "warehouse"."main_marts"."fact_audience__dbt_backup" cascade
    
[0m11:38:24.568865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.569880 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: Close
[0m11:38:24.569880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1936480B0>]}
[0m11:38:24.569880 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_marts.fact_audience ...................... [[32mOK[0m in 0.04s]
[0m11:38:24.570864 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m11:38:24.570864 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m11:38:24.571865 [info ] [Thread-1 (]: 4 of 4 START sql view model main_marts.kpi_top10 ............................... [RUN]
[0m11:38:24.571865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.fact_audience, now model.tv_audience_mini.kpi_top10)
[0m11:38:24.572898 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.kpi_top10
[0m11:38:24.573884 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.kpi_top10"
[0m11:38:24.574907 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.kpi_top10
[0m11:38:24.576931 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.kpi_top10"
[0m11:38:24.577929 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:24.578938 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: BEGIN
[0m11:38:24.578938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:24.579930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.579930 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:24.579930 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

  
  create view "warehouse"."main_marts"."kpi_top10__dbt_tmp" as (
    with base as (
  select
    date, country, channel_std, program, viewers,
    row_number() over (partition by date, country order by viewers desc) as rk
  from "warehouse"."main_marts"."fact_audience"
)
select
  date, country, channel_std, program, viewers,
  rk as rank_in_country
from base
where rk <= 10
order by date, country, rk
  );

[0m11:38:24.581933 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:24.584062 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:24.585047 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10" rename to "kpi_top10__dbt_backup"
[0m11:38:24.585047 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.587110 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:24.588118 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10__dbt_tmp" rename to "kpi_top10"
[0m11:38:24.588118 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:24.589110 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m11:38:24.590110 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:24.590110 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m11:38:24.590110 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m11:38:24.591095 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:24.591095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:24.591095 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:24.592094 [info ] [MainThread]: 
[0m11:38:24.592094 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m11:38:24.592094 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\dev\tv_audience_mini_pipeline\warehouse.duckdb": Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus.
  
  File is already open in 
  C:\Users\delma\AppData\Local\Programs\Python\Python312\python.exe (PID 31964)
[0m11:38:24.592094 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:24.593095 [debug] [MainThread]: Command `dbt test` failed at 11:38:24.593095 after 1.12 seconds
[0m11:38:24.594288 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:24.594288 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

      drop view if exists "warehouse"."main_marts"."kpi_top10__dbt_backup" cascade
    
[0m11:38:24.594288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268789CA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B1A6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B5ED250>]}
[0m11:38:24.594288 [debug] [MainThread]: Flushing usage events
[0m11:38:24.595252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:24.596352 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: Close
[0m11:38:24.596352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c8e7a43-9362-43c6-8f07-b40050ec7694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19350D3A0>]}
[0m11:38:24.597351 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_marts.kpi_top10 .......................... [[32mOK[0m in 0.02s]
[0m11:38:24.597351 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m11:38:24.598349 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:24.598349 [debug] [MainThread]: On master: BEGIN
[0m11:38:24.599338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:24.599338 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:24.599338 [debug] [MainThread]: On master: COMMIT
[0m11:38:24.599338 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:24.599338 [debug] [MainThread]: On master: COMMIT
[0m11:38:24.600335 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:24.600335 [debug] [MainThread]: On master: Close
[0m11:38:24.600335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:24.600335 [debug] [MainThread]: Connection 'create_warehouse_main_stage' was properly closed.
[0m11:38:24.600335 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:24.601336 [debug] [MainThread]: Connection 'model.tv_audience_mini.kpi_top10' was properly closed.
[0m11:38:24.601336 [info ] [MainThread]: 
[0m11:38:24.601336 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m11:38:24.602336 [debug] [MainThread]: Command end result
[0m11:38:24.657952 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:24.660955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:24.666582 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:24.667566 [info ] [MainThread]: 
[0m11:38:24.667566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:24.667566 [info ] [MainThread]: 
[0m11:38:24.667566 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:38:24.668569 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:24.668569 after 1.20 seconds
[0m11:38:24.668569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C191277650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1914CC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1908B3FB0>]}
[0m11:38:24.669561 [debug] [MainThread]: Flushing usage events
[0m11:38:25.475357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:25.567559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:27.550620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B148410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39A9571A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39AD5ED80>]}


============================== 11:38:27.556637 | dcebcd34-15fd-43fa-96b5-b850869f5a73 ==============================
[0m11:38:27.556637 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:27.557636 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt test', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:38:27.578117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F106ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169EE43B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F04E9F40>]}


============================== 11:38:27.582078 | 22030748-0bbe-4be8-aa92-8026813dcbe7 ==============================
[0m11:38:27.582078 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:27.582078 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\delma\\.dbt', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:38:27.779225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcebcd34-15fd-43fa-96b5-b850869f5a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39BB7FF50>]}
[0m11:38:27.788050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F0B01400>]}
[0m11:38:27.829517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcebcd34-15fd-43fa-96b5-b850869f5a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F398988C80>]}
[0m11:38:27.831411 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:27.841491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F100FC50>]}
[0m11:38:27.843485 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:28.087633 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:28.097857 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:28.182797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:28.182797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:28.200426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:28.200426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:28.226530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcebcd34-15fd-43fa-96b5-b850869f5a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39D2012B0>]}
[0m11:38:28.232542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F29A58B0>]}
[0m11:38:28.291516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:28.293522 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:28.305241 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:28.306564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:28.323623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F2D4E930>]}
[0m11:38:28.323623 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:28.323623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F2861310>]}
[0m11:38:28.325630 [info ] [MainThread]: 
[0m11:38:28.325630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcebcd34-15fd-43fa-96b5-b850869f5a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39D720140>]}
[0m11:38:28.325630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:28.325630 [info ] [MainThread]: 
[0m11:38:28.325630 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:28.325630 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:28.325630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcebcd34-15fd-43fa-96b5-b850869f5a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39D6DBF50>]}
[0m11:38:28.325630 [info ] [MainThread]: 
[0m11:38:28.325630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:28.325630 [info ] [MainThread]: 
[0m11:38:28.325630 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:28.325630 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:38:28.338608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m11:38:28.412457 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:28.413456 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:28.413456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:28.417609 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:28.418685 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:28.418685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:28.438690 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m11:38:28.440160 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:38:28.443167 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:28.443167 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:28.443167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:28.444427 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:28.447065 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:38:28.448071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stage)
[0m11:38:28.448071 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stage"
"
[0m11:38:28.454597 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:28.454597 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:38:28.454597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:28.455660 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:28.456901 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:28.456901 [debug] [ThreadPool]: On create_warehouse_main_stage: BEGIN
[0m11:38:28.458270 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:28.458270 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:28.459270 [debug] [ThreadPool]: On create_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_stage"} */

    
    
        create schema if not exists "warehouse"."main_stage"
    
[0m11:38:28.459270 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:28.460272 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m11:38:28.461269 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stage"
[0m11:38:28.461269 [debug] [ThreadPool]: On create_warehouse_main_stage: COMMIT
[0m11:38:28.462269 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:28.462269 [debug] [ThreadPool]: On create_warehouse_main_stage: Close
[0m11:38:28.463748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_main_stage, now create_warehouse_main_marts)
[0m11:38:28.463748 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_marts"
"
[0m11:38:28.465885 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:28.465885 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:38:28.465885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:28.467179 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:28.468197 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:28.468197 [debug] [ThreadPool]: On create_warehouse_main_marts: BEGIN
[0m11:38:28.468197 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:28.469195 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:28.469195 [debug] [ThreadPool]: On create_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "create_warehouse_main_marts"} */

    
    
        create schema if not exists "warehouse"."main_marts"
    
[0m11:38:28.470196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:28.470196 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m11:38:28.471197 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_marts"
[0m11:38:28.471197 [debug] [ThreadPool]: On create_warehouse_main_marts: COMMIT
[0m11:38:28.471197 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:28.471197 [debug] [ThreadPool]: On create_warehouse_main_marts: Close
[0m11:38:28.473197 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m11:38:28.478416 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:28.479416 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:28.479416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:28.479416 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:28.480417 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:28.480417 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:28.492936 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:38:28.493953 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:28.496197 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:28.496197 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:28.497181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m11:38:28.500203 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:28.501198 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:28.502198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:28.502198 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:28.503181 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:28.503181 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:28.508775 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:38:28.510792 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:28.512771 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:28.512771 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:28.513787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F2860650>]}
[0m11:38:28.514922 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:28.514922 [debug] [MainThread]: On master: BEGIN
[0m11:38:28.514922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:28.516107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:28.516107 [debug] [MainThread]: On master: COMMIT
[0m11:38:28.516107 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:28.516107 [debug] [MainThread]: On master: COMMIT
[0m11:38:28.517100 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:28.517100 [debug] [MainThread]: On master: Close
[0m11:38:28.521113 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_audience
[0m11:38:28.521113 [info ] [Thread-1 (]: 1 of 4 START sql view model main_stage.stg_audience ............................ [RUN]
[0m11:38:28.522113 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.tv_audience_mini.stg_audience'
[0m11:38:28.523098 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_audience
[0m11:38:28.532598 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_audience"
[0m11:38:28.534743 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_audience
[0m11:38:28.541376 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m11:38:28.541376 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:28.542376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m11:38:28.545495 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:28.545495 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:28.546466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:28.565978 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_audience"
[0m11:38:28.567984 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:28.567984 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: BEGIN
[0m11:38:28.567984 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:28.569479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.570525 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:28.571547 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

  
  create view "warehouse"."main_stage"."stg_audience__dbt_tmp" as (
    with raw as (
  select
    cast(date as date) as date,
    upper(country) as country,
    trim(channel) as channel,
    trim(program) as program,
    viewers::bigint as viewers,
    cast(loaded_at as timestamp) as loaded_at
  from stage.audience_raw
),
tag as (
  select
    *,
    row_number() over (
      partition by date, country, channel, program
      order by loaded_at desc, program asc
    ) as rk
  from raw
)
select * from tag where rk = 1
  );

[0m11:38:28.572554 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.580721 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:28.581720 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience" rename to "stg_audience__dbt_backup"
[0m11:38:28.582723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.587937 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:28.588937 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */
alter view "warehouse"."main_stage"."stg_audience__dbt_tmp" rename to "stg_audience"
[0m11:38:28.589936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.605232 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m11:38:28.606384 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:28.606384 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: COMMIT
[0m11:38:28.612359 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:28.619621 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_audience"
[0m11:38:28.619621 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_audience"} */

      drop view if exists "warehouse"."main_stage"."stg_audience__dbt_backup" cascade
    
[0m11:38:28.621605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.624814 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_audience: Close
[0m11:38:28.627875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F04C3EC0>]}
[0m11:38:28.628863 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_stage.stg_audience ....................... [[32mOK[0m in 0.10s]
[0m11:38:28.628863 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_audience
[0m11:38:28.630353 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.stg_dim_channels
[0m11:38:28.631398 [info ] [Thread-1 (]: 2 of 4 START sql view model main_stage.stg_dim_channels ........................ [RUN]
[0m11:38:28.631398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_audience, now model.tv_audience_mini.stg_dim_channels)
[0m11:38:28.632863 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.stg_dim_channels
[0m11:38:28.634992 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.stg_dim_channels"
[0m11:38:28.636057 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.stg_dim_channels
[0m11:38:28.640216 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.stg_dim_channels"
[0m11:38:28.641212 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:28.641212 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: BEGIN
[0m11:38:28.641212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:28.642234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.642234 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:28.642234 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

  
  create view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" as (
    select
  upper(country) as country,
  trim(alias) as alias,
  trim(channel_std) as channel_std
from stage.dim_channels_raw
  );

[0m11:38:28.643229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:28.645423 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:28.646421 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels" rename to "stg_dim_channels__dbt_backup"
[0m11:38:28.646421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:28.648405 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:28.649406 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */
alter view "warehouse"."main_stage"."stg_dim_channels__dbt_tmp" rename to "stg_dim_channels"
[0m11:38:28.649406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:28.650420 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m11:38:28.651426 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:28.651426 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: COMMIT
[0m11:38:28.654556 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:28.654556 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m11:38:28.655605 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:28.655605 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.stg_dim_channels"
[0m11:38:28.655605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:28.656588 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m11:38:28.656588 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.stg_dim_channels"} */

      drop view if exists "warehouse"."main_stage"."stg_dim_channels__dbt_backup" cascade
    
[0m11:38:28.656588 [info ] [MainThread]: 
[0m11:38:28.656588 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:38:28.657588 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\dev\tv_audience_mini_pipeline\warehouse.duckdb": Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus.
  
  File is already open in 
  C:\Users\delma\AppData\Local\Programs\Python\Python312\python.exe (PID 33656)
[0m11:38:28.657588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.657588 [debug] [MainThread]: Command `dbt test` failed at 11:38:28.657588 after 1.22 seconds
[0m11:38:28.658590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39AD5ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B8FD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39B713770>]}
[0m11:38:28.658590 [debug] [Thread-1 (]: On model.tv_audience_mini.stg_dim_channels: Close
[0m11:38:28.658590 [debug] [MainThread]: Flushing usage events
[0m11:38:28.658590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F315D070>]}
[0m11:38:28.659592 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main_stage.stg_dim_channels ................... [[32mOK[0m in 0.03s]
[0m11:38:28.659592 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.stg_dim_channels
[0m11:38:28.660590 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.fact_audience
[0m11:38:28.660590 [info ] [Thread-1 (]: 3 of 4 START sql view model main_marts.fact_audience ........................... [RUN]
[0m11:38:28.660590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.stg_dim_channels, now model.tv_audience_mini.fact_audience)
[0m11:38:28.661607 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.fact_audience
[0m11:38:28.663590 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.fact_audience"
[0m11:38:28.664780 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.fact_audience
[0m11:38:28.666936 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.fact_audience"
[0m11:38:28.667934 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:28.667934 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: BEGIN
[0m11:38:28.667934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:28.668934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.668934 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:28.668934 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

  
  create view "warehouse"."main_marts"."fact_audience__dbt_tmp" as (
    with m as (
  select
    a.date,
    a.country,
    coalesce(d.channel_std, upper(a.channel)) as channel_std,
    a.program,
    a.viewers
  from "warehouse"."main_stage"."stg_audience" a
  left join "warehouse"."main_stage"."stg_dim_channels" d
    on a.country = d.country
   and upper(a.channel) = d.alias
)
select * from m
  );

[0m11:38:28.670917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.673212 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:28.673212 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience" rename to "fact_audience__dbt_backup"
[0m11:38:28.673212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:28.675263 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:28.676360 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */
alter view "warehouse"."main_marts"."fact_audience__dbt_tmp" rename to "fact_audience"
[0m11:38:28.676360 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:28.677360 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m11:38:28.677360 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:28.678360 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: COMMIT
[0m11:38:28.681343 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:28.683359 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.fact_audience"
[0m11:38:28.683359 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.fact_audience"} */

      drop view if exists "warehouse"."main_marts"."fact_audience__dbt_backup" cascade
    
[0m11:38:28.685594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.686595 [debug] [Thread-1 (]: On model.tv_audience_mini.fact_audience: Close
[0m11:38:28.686595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F31E8E90>]}
[0m11:38:28.687578 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_marts.fact_audience ...................... [[32mOK[0m in 0.03s]
[0m11:38:28.687578 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.fact_audience
[0m11:38:28.688584 [debug] [Thread-1 (]: Began running node model.tv_audience_mini.kpi_top10
[0m11:38:28.688584 [info ] [Thread-1 (]: 4 of 4 START sql view model main_marts.kpi_top10 ............................... [RUN]
[0m11:38:28.688584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tv_audience_mini.fact_audience, now model.tv_audience_mini.kpi_top10)
[0m11:38:28.689577 [debug] [Thread-1 (]: Began compiling node model.tv_audience_mini.kpi_top10
[0m11:38:28.691595 [debug] [Thread-1 (]: Writing injected SQL for node "model.tv_audience_mini.kpi_top10"
[0m11:38:28.691595 [debug] [Thread-1 (]: Began executing node model.tv_audience_mini.kpi_top10
[0m11:38:28.694793 [debug] [Thread-1 (]: Writing runtime sql for node "model.tv_audience_mini.kpi_top10"
[0m11:38:28.695851 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:28.695851 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: BEGIN
[0m11:38:28.695851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:28.696852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:28.696852 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:28.696852 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

  
  create view "warehouse"."main_marts"."kpi_top10__dbt_tmp" as (
    with base as (
  select
    date, country, channel_std, program, viewers,
    row_number() over (partition by date, country order by viewers desc) as rk
  from "warehouse"."main_marts"."fact_audience"
)
select
  date, country, channel_std, program, viewers,
  rk as rank_in_country
from base
where rk <= 10
order by date, country, rk
  );

[0m11:38:28.699034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.700235 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:28.700235 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10" rename to "kpi_top10__dbt_backup"
[0m11:38:28.701246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:28.703242 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:28.703242 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */
alter view "warehouse"."main_marts"."kpi_top10__dbt_tmp" rename to "kpi_top10"
[0m11:38:28.703242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:28.704258 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m11:38:28.704258 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:28.705369 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: COMMIT
[0m11:38:28.708353 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:28.711369 [debug] [Thread-1 (]: Using duckdb connection "model.tv_audience_mini.kpi_top10"
[0m11:38:28.711369 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "model.tv_audience_mini.kpi_top10"} */

      drop view if exists "warehouse"."main_marts"."kpi_top10__dbt_backup" cascade
    
[0m11:38:28.713352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:28.713352 [debug] [Thread-1 (]: On model.tv_audience_mini.kpi_top10: Close
[0m11:38:28.714417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22030748-0bbe-4be8-aa92-8026813dcbe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F30EDDC0>]}
[0m11:38:28.714417 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_marts.kpi_top10 .......................... [[32mOK[0m in 0.02s]
[0m11:38:28.714417 [debug] [Thread-1 (]: Finished running node model.tv_audience_mini.kpi_top10
[0m11:38:28.715493 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:28.716492 [debug] [MainThread]: On master: BEGIN
[0m11:38:28.716492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:28.716492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:28.717492 [debug] [MainThread]: On master: COMMIT
[0m11:38:28.717492 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:28.717492 [debug] [MainThread]: On master: COMMIT
[0m11:38:28.717492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:28.718492 [debug] [MainThread]: On master: Close
[0m11:38:28.718492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:28.718492 [debug] [MainThread]: Connection 'create_warehouse_main_marts' was properly closed.
[0m11:38:28.718492 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m11:38:28.718492 [debug] [MainThread]: Connection 'model.tv_audience_mini.kpi_top10' was properly closed.
[0m11:38:28.719493 [info ] [MainThread]: 
[0m11:38:28.719493 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:38:28.720492 [debug] [MainThread]: Command end result
[0m11:38:28.774590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:28.776648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:28.780665 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:28.781665 [info ] [MainThread]: 
[0m11:38:28.781665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:28.781665 [info ] [MainThread]: 
[0m11:38:28.781665 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:38:28.782646 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:28.782646 after 1.31 seconds
[0m11:38:28.782646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F2BA2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F31AC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169F31AE930>]}
[0m11:38:28.783667 [debug] [MainThread]: Flushing usage events
[0m11:38:29.681105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:29.783344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:31.729326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E6EEB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9B3A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9B393D0>]}


============================== 11:38:31.732328 | 22a9fe97-660a-48b5-9481-ade361bf3350 ==============================
[0m11:38:31.732328 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:31.733328 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None'}
[0m11:38:31.824588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4E5F8BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4EF16090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4C4EC2F0>]}


============================== 11:38:31.831732 | d1a85b97-1d5a-4e68-96be-0b2ab8f1a17b ==============================
[0m11:38:31.831732 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:31.832731 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m11:38:31.962255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a9fe97-660a-48b5-9481-ade361bf3350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB8F7C50>]}
[0m11:38:32.019567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a9fe97-660a-48b5-9481-ade361bf3350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB33A030>]}
[0m11:38:32.020566 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:32.055544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1a85b97-1d5a-4e68-96be-0b2ab8f1a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4C6FC9B0>]}
[0m11:38:32.116710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1a85b97-1d5a-4e68-96be-0b2ab8f1a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4ED106B0>]}
[0m11:38:32.117710 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:32.245750 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:32.332939 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:32.338332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:32.338332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:32.365008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22a9fe97-660a-48b5-9481-ade361bf3350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB9B7C20>]}
[0m11:38:32.419527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:32.421508 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:32.431485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:32.431485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:32.445392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22a9fe97-660a-48b5-9481-ade361bf3350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EBE10320>]}
[0m11:38:32.445392 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:32.445392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a9fe97-660a-48b5-9481-ade361bf3350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB1AFE00>]}
[0m11:38:32.447622 [info ] [MainThread]: 
[0m11:38:32.447622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:32.447622 [info ] [MainThread]: 
[0m11:38:32.448605 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:32.451622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m11:38:32.458857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1a85b97-1d5a-4e68-96be-0b2ab8f1a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D50891430>]}
[0m11:38:32.511628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:32.512615 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:32.512615 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:32.513632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:32.513632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:32.526240 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:38:32.526240 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:32.526240 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:32.530228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1a85b97-1d5a-4e68-96be-0b2ab8f1a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D510642C0>]}
[0m11:38:32.530228 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:32.530228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1a85b97-1d5a-4e68-96be-0b2ab8f1a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D50885E20>]}
[0m11:38:32.532253 [info ] [MainThread]: 
[0m11:38:32.532253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:32.532253 [info ] [MainThread]: 
[0m11:38:32.533258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:32.538475 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:38:32.539463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:38:32.539463 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:32.540478 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:32.541477 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:32.541477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m11:38:32.543461 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:32.543461 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:32.543461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:32.544593 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:32.544593 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:32.544593 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:32.547618 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:38:32.548621 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:32.549620 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:32.549620 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:32.550621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a9fe97-660a-48b5-9481-ade361bf3350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E711BB60>]}
[0m11:38:32.550621 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:32.550621 [debug] [MainThread]: On master: BEGIN
[0m11:38:32.550621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:32.551644 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:32.551644 [debug] [MainThread]: On master: COMMIT
[0m11:38:32.551644 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:32.551644 [debug] [MainThread]: On master: COMMIT
[0m11:38:32.552618 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:32.552618 [debug] [MainThread]: On master: Close
[0m11:38:32.554741 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:32.554741 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:38:32.555808 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:32.555808 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:32.568290 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:32.569289 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:32.587751 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:32.587751 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:32.588756 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:38:32.588756 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:32.589752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.589752 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:32.589752 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.596272 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:32.602293 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:38:32.603293 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:32.603293 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:38:32.604454 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.05s]
[0m11:38:32.605565 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:32.606566 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:32.606566 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:38:32.607566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:38:32.607566 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:32.610549 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:32.610549 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:32.613323 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:32.613323 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:32.613323 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:38:32.614373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.614373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.614373 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:32.614373 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
ience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.615354 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:32.615354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:32.617353 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:32.618354 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:38:32.619353 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:38:32.619353 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:38:32.620353 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.01s]
[0m11:38:32.620353 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:32.620353 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:32.621337 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:38:32.621337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:38:32.621337 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:32.625460 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:32.626459 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:32.627444 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:32.628457 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:32.628457 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:38:32.629473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.629473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.629473 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:32.630478 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.632487 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:32.633490 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:38:32.634647 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:38:32.634647 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:38:32.634647 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.01s]
[0m11:38:32.635746 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:32.635746 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:32.636727 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:38:32.636727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:38:32.636727 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:32.639163 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:32.640220 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:32.642181 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:32.642181 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:32.643183 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:38:32.643183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.643183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.644182 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:32.644182 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.645794 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:32.646891 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:38:32.647927 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:38:32.647927 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:38:32.648920 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:32.648920 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:32.648920 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:32.649921 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:38:32.649921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:38:32.649921 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:32.652903 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:32.653904 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:32.656112 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:32.656112 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:32.657110 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:38:32.657110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.658094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.658094 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:32.658094 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.661102 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:32.662094 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:38:32.663117 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:38:32.663117 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:38:32.664224 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:32.664224 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:32.664224 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:32.665207 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:38:32.665207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:38:32.665207 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:32.668291 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:32.669289 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:32.670272 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:32.671289 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:32.671289 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:38:32.672295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.672295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.672295 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:32.673586 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.674673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.675779 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:38:32.676831 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:38:32.676831 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:38:32.676831 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:32.677795 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:32.677795 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:32.678814 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:38:32.678814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:38:32.678814 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:32.681811 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:32.682809 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:32.683809 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:32.684898 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:32.684898 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:38:32.684898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.685978 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:32.685978 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:32.685978 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.688007 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:32.689496 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:38:32.689496 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:38:32.690500 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:38:32.690500 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:32.691501 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:32.691501 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:32.691501 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:38:32.692500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:38:32.692500 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:32.695768 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:32.695768 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:32.698761 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:32.699761 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:32.699761 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:38:32.699761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.700761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.700761 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:32.700761 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.702761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.703779 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:38:32.704939 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:32.704939 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:38:32.704939 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:32.705975 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:38:32.705975 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:38:32.706983 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:32.706983 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:32.707995 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:38:32.707995 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:38:32.707995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:38:32.708978 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:32.708978 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:32.708978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:32.711993 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:32.711993 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:32.714187 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:32.715204 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:32.716360 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:38:32.717343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.718343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.718343 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:32.719359 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.722502 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:32.723007 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:38:32.724050 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:38:32.724050 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:38:32.724050 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.02s]
[0m11:38:32.725179 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:32.725179 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:32.725179 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:38:32.726273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:38:32.726273 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:32.729274 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:32.730274 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:32.731278 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:32.732277 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:32.732277 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:38:32.733277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.733277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:32.733277 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:32.733277 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.736485 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:32.737502 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:38:32.738501 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:38:32.738501 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:38:32.739503 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:32.739503 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:32.740502 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:32.740502 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:38:32.740502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:38:32.741512 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:32.744675 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:32.744675 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:32.747035 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:32.748018 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:32.748018 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:38:32.748018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.748018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.749401 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:32.749401 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.751034 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:32.752020 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:38:32.753020 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:38:32.753020 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:38:32.754021 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:32.754021 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:32.754021 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:32.755125 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:38:32.755125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:38:32.755125 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:32.758239 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:32.759224 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:32.761226 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:32.762224 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:32.762224 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:38:32.762224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.763225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.763225 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:32.763225 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.764347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.765381 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:38:32.766418 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:38:32.766418 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:38:32.767392 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:38:32.767392 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:32.767392 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:32.768394 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:38:32.768394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:38:32.768394 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:32.771407 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:32.772407 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:32.773407 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:32.774556 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:32.774556 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:38:32.774556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.774556 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:32.775657 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:32.775657 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.776658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.777661 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:38:32.777661 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:38:32.778660 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:38:32.778660 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:38:32.779660 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:32.779660 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:32.779660 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:38:32.779660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:38:32.780659 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:32.783660 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:32.784792 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:32.796190 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:38:32.797189 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:38:32.797189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:32.797189 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m11:38:32.797189 [info ] [MainThread]: 
[0m11:38:32.798633 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m11:38:32.798633 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\dev\tv_audience_mini_pipeline\warehouse.duckdb": Le processus ne peut pas accéder au fichier car ce fichier est utilisé par un autre processus.
  
  File is already open in 
  C:\Users\delma\AppData\Local\Programs\Python\Python312\python.exe (PID 22892)
[0m11:38:32.799638 [debug] [MainThread]: Command `dbt run` failed at 11:38:32.798633 after 1.10 seconds
[0m11:38:32.799638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D4F000800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D507F6FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D515EBB60>]}
[0m11:38:32.799638 [debug] [MainThread]: Flushing usage events
[0m11:38:32.820997 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:32.822012 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:32.822012 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:38:32.823013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.823013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.824143 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:32.824143 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:32.825149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:32.826266 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:38:32.827249 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:38:32.827249 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:38:32.827249 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.05s]
[0m11:38:32.828248 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:32.828248 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:32.828248 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:38:32.829249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:38:32.829249 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:32.832676 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:32.833675 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:32.835674 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:32.835674 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:32.836675 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:38:32.836675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:32.836675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:32.837658 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:32.837658 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:38:32.843701 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:32.845813 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:38:32.846970 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:38:32.846970 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:38:32.846970 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:38:32.847935 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:32.847935 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:32.847935 [debug] [MainThread]: On master: BEGIN
[0m11:38:32.849248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:32.849248 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:32.849248 [debug] [MainThread]: On master: COMMIT
[0m11:38:32.850275 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:32.850275 [debug] [MainThread]: On master: COMMIT
[0m11:38:32.850275 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:32.850275 [debug] [MainThread]: On master: Close
[0m11:38:32.850275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:32.851673 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m11:38:32.851673 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:38:32.851673 [info ] [MainThread]: 
[0m11:38:32.852276 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:38:32.853258 [debug] [MainThread]: Command end result
[0m11:38:32.868602 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:32.870602 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:32.875900 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:32.875900 [info ] [MainThread]: 
[0m11:38:32.875900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:32.876899 [info ] [MainThread]: 
[0m11:38:32.876899 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:38:32.877898 [debug] [MainThread]: Command `dbt test` succeeded at 11:38:32.877898 after 1.27 seconds
[0m11:38:32.877898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9999A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9E634D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9DF1B80>]}
[0m11:38:32.878899 [debug] [MainThread]: Flushing usage events
[0m11:38:33.675029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:33.778380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:35.764623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA218592E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA21B455B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA21B442F0>]}


============================== 11:38:35.769743 | 078635a8-7e2a-4a98-afb1-1ed9bb941eef ==============================
[0m11:38:35.769743 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:35.769743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m11:38:35.974773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '078635a8-7e2a-4a98-afb1-1ed9bb941eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA21E8FCE0>]}
[0m11:38:36.031106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '078635a8-7e2a-4a98-afb1-1ed9bb941eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA1EEC7F50>]}
[0m11:38:36.032112 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:36.256351 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:36.350286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:36.350286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:36.380574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '078635a8-7e2a-4a98-afb1-1ed9bb941eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA21859400>]}
[0m11:38:36.441953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:36.444221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:36.468006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '078635a8-7e2a-4a98-afb1-1ed9bb941eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23ADFDA0>]}
[0m11:38:36.468904 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:36.468904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '078635a8-7e2a-4a98-afb1-1ed9bb941eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA21E73CB0>]}
[0m11:38:36.470915 [info ] [MainThread]: 
[0m11:38:36.470915 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:36.470915 [info ] [MainThread]: 
[0m11:38:36.471886 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:36.475999 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:36.541870 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:36.541870 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:36.541870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:36.556438 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:38:36.556438 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:36.556438 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:36.578157 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:38:36.584221 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:36.584221 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:36.584221 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:36.584221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:36.588875 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:36.588875 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:36.588875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:36.588875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:36.588875 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:36.588875 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:36.592491 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:38:36.594532 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:36.594532 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:36.594532 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:36.594532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '078635a8-7e2a-4a98-afb1-1ed9bb941eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23AC6090>]}
[0m11:38:36.594532 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:36.594532 [debug] [MainThread]: On master: BEGIN
[0m11:38:36.594532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:36.594532 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:38:36.594532 [debug] [MainThread]: On master: COMMIT
[0m11:38:36.594532 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:36.594532 [debug] [MainThread]: On master: COMMIT
[0m11:38:36.594532 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:36.594532 [debug] [MainThread]: On master: Close
[0m11:38:36.594532 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:36.604249 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:38:36.604249 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:36.604249 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:36.605258 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:36.605258 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:36.621697 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:36.621697 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:36.621697 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:38:36.621697 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:36.621697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.621697 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:36.621697 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.637064 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:38:36.639073 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:38:36.639073 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:36.639073 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:38:36.639073 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.03s]
[0m11:38:36.639073 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:36.639073 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:36.639073 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:38:36.639073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:38:36.639073 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:36.639073 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:36.639073 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:36.651486 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:36.651486 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:36.651486 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:38:36.651486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.651486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.651486 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:36.651486 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.651486 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:38:36.651486 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:38:36.651486 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:38:36.651486 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:38:36.651486 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.01s]
[0m11:38:36.651486 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:36.651486 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:36.651486 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:38:36.651486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:38:36.651486 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:36.667387 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:36.667387 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:36.667387 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:36.667387 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:36.667387 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:38:36.667387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.667387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.667387 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:36.667387 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.667387 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:36.667387 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:38:36.667387 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:38:36.667387 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:38:36.667387 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.02s]
[0m11:38:36.683021 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:36.683021 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:36.683021 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:38:36.683021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:38:36.683021 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:36.686899 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:36.688905 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:36.690648 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:36.690648 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:36.690648 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:38:36.690648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.690648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.690648 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:36.690648 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.690648 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:36.698761 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:38:36.698761 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:38:36.698761 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:38:36.698761 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.02s]
[0m11:38:36.698761 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:36.698761 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:36.698761 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:38:36.698761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:38:36.698761 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:36.698761 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:36.698761 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:36.698761 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:36.698761 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:36.698761 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:38:36.698761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.698761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.698761 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:36.709636 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.711644 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:36.713648 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:38:36.714655 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:38:36.714655 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:38:36.714655 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.02s]
[0m11:38:36.714655 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:36.714655 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:36.716660 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:38:36.716660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:38:36.716660 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:36.716660 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:36.716660 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:36.716660 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:36.716660 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:36.716660 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:38:36.716660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.716660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.716660 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:36.716660 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.716660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.727942 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:38:36.727942 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:38:36.727942 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:38:36.728976 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:36.728976 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:36.730010 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:36.730010 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:38:36.730010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:38:36.730969 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:36.735043 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:36.737184 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:36.739182 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:36.740167 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:36.740167 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:38:36.740167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.741167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.741167 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:36.741167 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.743166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.744320 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:38:36.745435 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:38:36.745435 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:38:36.747421 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.02s]
[0m11:38:36.747421 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:36.747421 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:36.748446 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:38:36.748446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:38:36.748446 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:36.751436 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:36.751970 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:36.754000 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:36.755134 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:36.755134 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:38:36.755134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.756277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.756277 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:36.756277 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.758260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.759260 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:38:36.760276 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:38:36.760276 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:38:36.760276 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:38:36.761271 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:36.761271 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:36.761271 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:38:36.762260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:38:36.762260 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:36.765459 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:36.765459 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:36.767459 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:36.767459 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:36.768458 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:38:36.768458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.768458 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.769442 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:36.769442 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.772443 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:36.773461 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:38:36.774607 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:38:36.774607 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:38:36.774607 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.01s]
[0m11:38:36.775696 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:36.775696 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:36.776716 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:38:36.776716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:38:36.776716 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:36.779854 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:36.779854 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:36.781713 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:36.782698 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:36.782698 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:38:36.782698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.782698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.783797 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:36.784154 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.785209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.786355 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:38:36.786355 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:38:36.787354 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:38:36.787354 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:36.787354 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:36.788354 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:36.788354 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:38:36.788354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:38:36.789348 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:36.791355 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:36.792354 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:36.793339 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:36.794396 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:36.794396 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:38:36.794396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.795468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.795468 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:36.795468 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.797468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.798471 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:38:36.798471 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:38:36.799471 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:38:36.799471 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:36.800470 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:36.800470 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:36.800470 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:38:36.801469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:38:36.801469 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:36.804518 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:36.804518 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:36.806791 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:36.806791 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:36.807684 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:38:36.807684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.808682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.808682 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:36.808682 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.809686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.810685 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:38:36.810685 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:38:36.810685 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:38:36.811706 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:38:36.811706 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:36.812700 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:36.812700 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:38:36.812700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:38:36.813700 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:36.815956 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:36.816956 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:36.817961 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:36.818940 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:36.818940 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:38:36.818940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.819958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.819958 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:36.819958 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.820957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.821944 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:38:36.822943 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:38:36.824040 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:38:36.824740 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:38:36.825814 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:36.825814 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:36.826789 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:38:36.826789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:38:36.826789 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:36.831792 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:36.833792 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:36.878460 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:36.879443 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:36.879443 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:38:36.879443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.880505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.880505 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:36.881462 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:36.882443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:36.883443 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:38:36.884523 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:38:36.884523 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:38:36.885643 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.06s]
[0m11:38:36.886643 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:36.887660 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:36.887660 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:38:36.888666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:38:36.888666 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:36.892660 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:36.893645 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:36.895841 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:36.895841 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:36.896843 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:38:36.896843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:36.896843 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:36.897825 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:36.897825 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:38:36.905030 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:38:36.906142 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:38:36.907142 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:38:36.907142 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:38:36.908180 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:38:36.908180 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:36.909142 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:36.909142 [debug] [MainThread]: On master: BEGIN
[0m11:38:36.909142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:36.910300 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:36.910300 [debug] [MainThread]: On master: COMMIT
[0m11:38:36.910300 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:36.910300 [debug] [MainThread]: On master: COMMIT
[0m11:38:36.911330 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:36.911330 [debug] [MainThread]: On master: Close
[0m11:38:36.911330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:36.911330 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:36.912329 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:38:36.912329 [info ] [MainThread]: 
[0m11:38:36.912329 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m11:38:36.913330 [debug] [MainThread]: Command end result
[0m11:38:36.928031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:36.930031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:36.934645 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:36.935763 [info ] [MainThread]: 
[0m11:38:36.935763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:36.935763 [info ] [MainThread]: 
[0m11:38:36.935763 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:38:36.936740 [debug] [MainThread]: Command `dbt test` succeeded at 11:38:36.936740 after 1.30 seconds
[0m11:38:36.936740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA1EE78F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA21C3F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23F59D30>]}
[0m11:38:36.937746 [debug] [MainThread]: Flushing usage events
[0m11:38:37.873370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:39.975474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81842BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818911430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8155F7FB0>]}


============================== 11:38:39.979494 | c19f3cb8-35d1-4a85-b593-14dfbedb2e85 ==============================
[0m11:38:39.979494 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:39.979494 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:38:40.204735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c19f3cb8-35d1-4a85-b593-14dfbedb2e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81A272780>]}
[0m11:38:40.253674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c19f3cb8-35d1-4a85-b593-14dfbedb2e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818AA1E80>]}
[0m11:38:40.255320 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:40.469857 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:40.571358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:40.571358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:40.603335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c19f3cb8-35d1-4a85-b593-14dfbedb2e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81A948BF0>]}
[0m11:38:40.662984 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:40.665075 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:40.688995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c19f3cb8-35d1-4a85-b593-14dfbedb2e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81ADA76B0>]}
[0m11:38:40.688995 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:40.689965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c19f3cb8-35d1-4a85-b593-14dfbedb2e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81A942AB0>]}
[0m11:38:40.690963 [info ] [MainThread]: 
[0m11:38:40.690963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:40.691963 [info ] [MainThread]: 
[0m11:38:40.691963 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:40.695477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:40.764886 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:40.764886 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:40.764886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:40.776281 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:38:40.776281 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:40.777281 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:40.790630 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:38:40.791664 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:40.792773 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:40.793646 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:40.793646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:40.796893 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:40.796893 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:40.796893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:40.797890 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:40.797890 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:40.798890 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:40.801878 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:38:40.802880 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:40.803879 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:40.803879 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:40.804992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c19f3cb8-35d1-4a85-b593-14dfbedb2e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8160B79E0>]}
[0m11:38:40.806100 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:40.806100 [debug] [MainThread]: On master: BEGIN
[0m11:38:40.806100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:40.807093 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:40.807093 [debug] [MainThread]: On master: COMMIT
[0m11:38:40.807093 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:40.807093 [debug] [MainThread]: On master: COMMIT
[0m11:38:40.808093 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:40.808093 [debug] [MainThread]: On master: Close
[0m11:38:40.811093 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:40.811093 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:38:40.812091 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:40.812091 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:40.827450 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:40.828449 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:40.844903 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:40.846100 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:40.846100 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:38:40.846100 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:40.847096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:40.847096 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:40.848094 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.854289 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:38:40.857368 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:38:40.858368 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:40.858368 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:38:40.858368 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.05s]
[0m11:38:40.859879 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:40.859879 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:40.859879 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:38:40.860889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:38:40.860889 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:40.864242 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:40.864242 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:40.866391 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:40.867379 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:40.867379 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:38:40.867379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.868380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:40.868380 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:40.868380 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.871364 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:40.872383 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:38:40.873380 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:38:40.873380 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:38:40.873380 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.01s]
[0m11:38:40.874500 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:40.874500 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:40.874500 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:38:40.875616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:38:40.875616 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:40.879594 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:40.880621 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:40.881610 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:40.882611 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:40.882611 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:38:40.882611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.883595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:40.883595 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:40.884691 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.887762 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:40.889776 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:38:40.890777 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:38:40.890777 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:38:40.891779 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.02s]
[0m11:38:40.892778 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:40.892778 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:40.893761 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:38:40.893761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:38:40.893761 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:40.897082 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:40.898067 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:40.900075 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:40.900075 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:40.900075 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:38:40.901115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.901115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:40.901115 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:40.902069 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.904213 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:40.905190 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:38:40.906280 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:38:40.906280 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:38:40.907275 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:40.907275 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:40.907275 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:40.908277 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:38:40.908277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:38:40.908277 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:40.911274 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:40.911274 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:40.913274 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:40.914354 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:40.914354 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:38:40.914354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.915482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:40.915482 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:40.915482 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.918502 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:40.919490 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:38:40.919490 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:38:40.920489 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:38:40.920489 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:40.921488 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:40.921488 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:40.921488 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:38:40.922486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:38:40.922486 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:40.924744 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:40.925954 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:40.927955 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:40.927955 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:40.928970 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:38:40.928970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.928970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:40.929939 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:40.929939 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.931943 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:40.932956 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:38:40.933955 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:38:40.933955 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:38:40.933955 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:40.935076 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:40.935076 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:40.937158 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:38:40.937158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:38:40.937158 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:40.940164 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:40.941162 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:40.943159 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:40.943159 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:40.943159 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:38:40.944246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.944246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:40.944246 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:40.945271 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.946477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:40.947474 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:38:40.948488 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:38:40.948488 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:38:40.949491 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:40.949491 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:40.950477 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:40.950477 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:38:40.950477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:38:40.951490 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:40.953488 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:40.954636 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:40.957741 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:40.958740 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:40.958740 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:38:40.960266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.960266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:40.960266 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:40.961295 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.962280 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:40.963280 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:38:40.964299 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:38:40.964299 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:38:40.965450 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:38:40.965450 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:40.965450 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:40.966449 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:38:40.966449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:38:40.966449 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:40.969446 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:40.970438 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:40.971436 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:40.972436 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:40.972436 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:38:40.972436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.973436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:40.973436 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:40.973436 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.976621 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:40.978629 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:38:40.978629 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:38:40.979624 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:38:40.979624 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.01s]
[0m11:38:40.980619 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:40.980619 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:40.980619 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:38:40.981620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:38:40.981620 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:40.983634 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:40.984813 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:40.985895 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:40.986895 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:40.986895 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:38:40.987891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:40.987891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:40.987891 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:40.987891 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:40.989892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:40.990892 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:38:40.991894 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:38:40.991894 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:38:40.992888 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:40.992888 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:40.992888 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:40.993906 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:38:40.993906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:38:40.993906 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:40.997144 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:40.997144 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:40.999144 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:41.000146 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:41.000146 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:38:41.000146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:41.001143 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:41.001143 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:41.001143 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:41.003130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:41.003130 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:38:41.004195 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:38:41.004195 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:38:41.005207 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:41.005207 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:41.005207 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:41.006329 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:38:41.006329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:38:41.006329 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:41.009307 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:41.010325 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:41.011307 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:41.012334 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:41.012334 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:38:41.013324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:41.013324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:41.013324 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:41.013324 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:38:41.014518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:41.015687 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:38:41.016832 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:38:41.016832 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:38:41.017642 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:38:41.017642 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:41.017642 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:41.018625 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:38:41.018625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:38:41.018625 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:41.021629 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:41.022646 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:41.023628 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:41.024702 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:41.024702 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:38:41.024702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:41.024702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:41.025839 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:41.025839 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:41.026840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:41.027835 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:38:41.028851 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:38:41.028851 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:38:41.028851 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:38:41.029851 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:41.029851 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:41.029851 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:38:41.030834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:38:41.030834 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:41.035071 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:41.035071 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:41.075541 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:41.076619 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:41.077524 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:38:41.077524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:41.078542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:41.078542 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:41.078542 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:41.079541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:41.080526 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:38:41.081542 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:38:41.081542 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:38:41.082541 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.05s]
[0m11:38:41.082541 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:41.083526 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:41.083526 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:38:41.083526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:38:41.083526 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:41.087821 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:41.088816 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:41.090798 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:41.091802 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:41.091802 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:38:41.092801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:41.093781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:41.093781 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:41.094866 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:38:41.100963 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:41.101965 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:38:41.102963 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:38:41.102963 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:38:41.104031 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:38:41.105051 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:41.106169 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:41.106169 [debug] [MainThread]: On master: BEGIN
[0m11:38:41.106169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:41.107186 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:41.107186 [debug] [MainThread]: On master: COMMIT
[0m11:38:41.107186 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:41.107186 [debug] [MainThread]: On master: COMMIT
[0m11:38:41.108186 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:41.108186 [debug] [MainThread]: On master: Close
[0m11:38:41.108186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:41.108186 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:41.109187 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:38:41.109187 [info ] [MainThread]: 
[0m11:38:41.109187 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m11:38:41.110187 [debug] [MainThread]: Command end result
[0m11:38:41.126931 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:41.128932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:41.137276 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:41.137276 [info ] [MainThread]: 
[0m11:38:41.138267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:41.138267 [info ] [MainThread]: 
[0m11:38:41.139269 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:38:41.140268 [debug] [MainThread]: Command `dbt test` succeeded at 11:38:41.140268 after 1.30 seconds
[0m11:38:41.140268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8183DD7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F816871250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818BF76E0>]}
[0m11:38:41.141267 [debug] [MainThread]: Flushing usage events
[0m11:38:41.968802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:43.859953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F65C2F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F67A271A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F68862A50>]}


============================== 11:38:43.864610 | 48987a51-4e8c-4735-b0e2-648532372e51 ==============================
[0m11:38:43.864610 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:43.865623 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt test', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m11:38:44.061415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48987a51-4e8c-4735-b0e2-648532372e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F69F86180>]}
[0m11:38:44.114011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48987a51-4e8c-4735-b0e2-648532372e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F68AD1880>]}
[0m11:38:44.116404 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:44.363856 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:44.482924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:44.482924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:44.510658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48987a51-4e8c-4735-b0e2-648532372e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6A6D12E0>]}
[0m11:38:44.565233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:44.567357 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:44.591437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48987a51-4e8c-4735-b0e2-648532372e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F68EBDFA0>]}
[0m11:38:44.592444 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:44.592444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48987a51-4e8c-4735-b0e2-648532372e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6A725490>]}
[0m11:38:44.594710 [info ] [MainThread]: 
[0m11:38:44.594710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:44.596005 [info ] [MainThread]: 
[0m11:38:44.596005 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:44.601907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:44.667267 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:44.667267 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:44.668220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:44.680598 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:38:44.681595 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:44.681595 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:44.693643 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:38:44.694718 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:44.694718 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:44.696024 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:44.696024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:44.697901 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:44.697901 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:44.697901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:44.698996 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:38:44.698996 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:44.700000 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:44.702902 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:38:44.705084 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:44.706369 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:44.706369 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:44.707384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48987a51-4e8c-4735-b0e2-648532372e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F68F43560>]}
[0m11:38:44.708466 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:44.708466 [debug] [MainThread]: On master: BEGIN
[0m11:38:44.708466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:44.709387 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:44.709387 [debug] [MainThread]: On master: COMMIT
[0m11:38:44.709387 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:44.709387 [debug] [MainThread]: On master: COMMIT
[0m11:38:44.710496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:44.710496 [debug] [MainThread]: On master: Close
[0m11:38:44.713368 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:44.713368 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:38:44.714417 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:44.714417 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:44.725892 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:44.726876 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:44.740282 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:44.740282 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:44.741287 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:38:44.741287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:44.741287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.742268 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:44.742268 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.747690 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:44.753739 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:38:44.755992 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:44.755992 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:38:44.756991 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.04s]
[0m11:38:44.757991 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:44.758993 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:44.758993 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:38:44.760079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:38:44.760079 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:44.763107 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:44.764526 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:44.766457 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:44.767567 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:44.767567 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:38:44.767567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.768510 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.768510 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:44.768510 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.771576 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:44.772599 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:38:44.773479 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:38:44.773479 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:38:44.774574 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.01s]
[0m11:38:44.774574 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:44.774574 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:44.774574 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:38:44.775921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:38:44.775921 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:44.779975 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:44.780875 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:44.781874 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:44.782903 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:44.782903 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:38:44.782903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.783890 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:44.783890 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:44.783890 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.787148 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:44.788148 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:38:44.789146 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:38:44.789146 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:38:44.789146 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.01s]
[0m11:38:44.790151 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:44.790151 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:44.790151 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:38:44.791148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:38:44.791148 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:44.794330 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:44.794330 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:44.797453 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:44.798452 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:44.798452 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:38:44.798452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.799452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.799452 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:44.800439 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.803438 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:44.804589 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:38:44.804589 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:38:44.804589 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:38:44.805794 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:44.805794 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:44.805794 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:44.806796 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:38:44.806796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:38:44.806796 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:44.809799 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:44.810801 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:44.812782 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:44.813778 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:44.813778 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:38:44.814907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.814907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.816098 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:44.816098 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.820103 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:38:44.822097 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:38:44.823102 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:38:44.823102 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:38:44.824298 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.02s]
[0m11:38:44.824298 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:44.825319 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:44.825319 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:38:44.826502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:38:44.826502 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:44.829519 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:44.830502 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:44.831502 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:44.832503 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:44.832503 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:38:44.833500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.833500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.833500 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:44.834769 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.836032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.837031 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:38:44.838013 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:38:44.838013 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:38:44.838013 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:44.839029 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:44.839029 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:44.839029 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:38:44.840030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:38:44.840030 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:44.843010 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:44.843010 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:44.844367 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:44.845247 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:44.845247 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:38:44.845247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.846403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:44.846403 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:44.846403 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.848399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.849290 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:38:44.850519 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:38:44.850519 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:38:44.850519 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:44.851392 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:44.851392 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:44.851392 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:38:44.852438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:38:44.852438 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:44.856221 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:44.856221 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:44.859106 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:44.860222 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:44.860222 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:38:44.860222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.861223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:44.861223 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:44.861223 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.863108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.864424 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:38:44.864424 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:38:44.864424 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:38:44.865701 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:38:44.865701 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:44.865701 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:44.865701 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:38:44.866782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:38:44.866782 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:44.869534 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:44.870521 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:44.871513 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:44.872511 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:44.872511 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:38:44.873408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.873408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:44.873408 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:44.874472 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.876790 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:44.877792 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:38:44.878791 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:38:44.878791 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:38:44.879791 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.01s]
[0m11:38:44.879791 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:44.880790 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:44.880790 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:38:44.880790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:38:44.880790 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:44.883900 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:44.885170 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:44.886572 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:44.886572 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:44.887697 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:38:44.887697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.888638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.888638 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:44.888638 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.890604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.890604 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:38:44.891676 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:38:44.891676 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:38:44.891676 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:44.892683 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:44.892683 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:44.892683 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:38:44.893578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:38:44.893578 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:44.896197 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:44.897197 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:44.899203 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:44.899203 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:44.900195 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:38:44.900195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.900195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:44.901072 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:44.901072 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.902071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.903183 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:38:44.903183 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:38:44.904582 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:38:44.904582 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:44.904582 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:44.905861 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:44.905861 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:38:44.905861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:38:44.905861 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:44.908879 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:44.909735 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:44.910848 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:44.911849 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:44.911849 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:38:44.911849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.912847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:44.912847 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:44.912847 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.913785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.915055 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:38:44.916368 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:38:44.916368 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:38:44.916368 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:38:44.917257 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:44.917257 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:44.917257 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:38:44.918385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:38:44.918385 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:44.921261 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:44.922358 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:44.923362 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:44.925548 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:44.925548 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:38:44.925548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.925548 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.927553 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:44.927553 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.927553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.929557 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:38:44.929557 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:38:44.929557 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:38:44.929557 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:38:44.929557 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:44.929557 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:44.929557 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:38:44.929557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:38:44.929557 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:44.929557 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:44.929557 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:44.970550 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:44.970550 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:44.970550 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:38:44.970550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.970550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.970550 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:44.970550 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:44.970550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.970550 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:38:44.970550 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:38:44.970550 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:38:44.986307 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.06s]
[0m11:38:44.986307 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:44.986307 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:44.986307 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:38:44.986307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:38:44.986307 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:44.986307 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:44.986307 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:44.986307 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:44.986307 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:44.986307 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:38:44.986307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.986307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:44.986307 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:44.986307 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:38:45.002000 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:45.002000 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:38:45.002000 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:38:45.002000 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:38:45.002000 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:38:45.002000 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:45.002000 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:45.002000 [debug] [MainThread]: On master: BEGIN
[0m11:38:45.002000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:45.002000 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:38:45.002000 [debug] [MainThread]: On master: COMMIT
[0m11:38:45.002000 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:45.002000 [debug] [MainThread]: On master: COMMIT
[0m11:38:45.002000 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:45.002000 [debug] [MainThread]: On master: Close
[0m11:38:45.002000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:45.002000 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:45.002000 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:38:45.002000 [info ] [MainThread]: 
[0m11:38:45.002000 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m11:38:45.002000 [debug] [MainThread]: Command end result
[0m11:38:45.018117 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:45.018117 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:45.037988 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:45.037988 [info ] [MainThread]: 
[0m11:38:45.037988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:45.037988 [info ] [MainThread]: 
[0m11:38:45.037988 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:38:45.043146 [debug] [MainThread]: Command `dbt test` succeeded at 11:38:45.043146 after 1.29 seconds
[0m11:38:45.043146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F646742F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F679FF440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F68202210>]}
[0m11:38:45.043146 [debug] [MainThread]: Flushing usage events
[0m11:38:46.064437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:48.044390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1CF78AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1CD657E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D035A480>]}


============================== 11:38:48.048433 | b9a2262d-c45f-4180-8dc1-bb44db27fd7e ==============================
[0m11:38:48.048433 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:48.048433 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None'}
[0m11:38:48.260614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9a2262d-c45f-4180-8dc1-bb44db27fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D09FFA70>]}
[0m11:38:48.304695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9a2262d-c45f-4180-8dc1-bb44db27fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D09E9A60>]}
[0m11:38:48.306798 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:48.512927 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:48.600816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:48.601812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:48.628615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9a2262d-c45f-4180-8dc1-bb44db27fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D21D1F70>]}
[0m11:38:48.675973 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:48.677973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:48.702390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9a2262d-c45f-4180-8dc1-bb44db27fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D25EFE60>]}
[0m11:38:48.702390 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:48.703392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9a2262d-c45f-4180-8dc1-bb44db27fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D25BDE80>]}
[0m11:38:48.704582 [info ] [MainThread]: 
[0m11:38:48.704582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:48.704582 [info ] [MainThread]: 
[0m11:38:48.705622 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:48.709620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:48.769611 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:48.769611 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:48.770611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:48.782317 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:38:48.783312 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:48.783312 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:48.793529 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:38:48.794653 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:48.795732 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:48.796733 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:48.796733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:48.798730 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:48.798730 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:48.798730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:48.799732 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:48.799732 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:48.799732 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:48.803717 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:38:48.804860 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:48.804860 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:48.805916 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:48.805916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9a2262d-c45f-4180-8dc1-bb44db27fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D0A83500>]}
[0m11:38:48.805916 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:48.806916 [debug] [MainThread]: On master: BEGIN
[0m11:38:48.806916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:48.806916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:48.806916 [debug] [MainThread]: On master: COMMIT
[0m11:38:48.807906 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:48.807906 [debug] [MainThread]: On master: COMMIT
[0m11:38:48.807906 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:48.808900 [debug] [MainThread]: On master: Close
[0m11:38:48.810900 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:48.811901 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:38:48.811901 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:48.811901 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:48.823112 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:48.824171 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:48.839512 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:48.841876 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:48.841876 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:38:48.842885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:48.842885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:48.843884 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:48.843884 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.849094 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:38:48.852070 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:38:48.853070 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:48.853070 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:38:48.854167 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.04s]
[0m11:38:48.854167 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:48.854167 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:48.855162 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:38:48.855162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:38:48.855162 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:48.858207 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:48.859209 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:48.861209 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:48.861209 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:48.862209 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:38:48.862209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.862209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:48.863208 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:48.863208 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.865526 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:48.866550 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:38:48.867543 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:38:48.867543 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:38:48.867543 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.868543 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:48.868543 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:48.868543 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:38:48.869526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:38:48.869526 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:48.873094 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:48.874095 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:48.875177 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:48.876247 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:48.876247 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:38:48.876247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.877240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:48.877240 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:48.877240 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.880223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:48.881223 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:38:48.882240 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:38:48.882240 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:38:48.882240 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.883240 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:48.883240 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:48.883240 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:38:48.884336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:38:48.884336 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:48.886377 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:48.887361 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:48.889359 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:48.890360 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:48.890360 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:38:48.890360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.891362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:48.891362 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:48.891362 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.893363 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:48.894553 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:38:48.895686 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:38:48.895686 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:38:48.896667 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.896667 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:48.896667 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:48.897666 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:38:48.897666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:38:48.897666 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:48.900666 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:48.901667 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:48.902672 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:48.903651 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:48.903651 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:38:48.904702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.904702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:48.904702 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:48.905758 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.907772 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:48.908775 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:38:48.909774 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:38:48.909774 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:38:48.910774 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.910774 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:48.910774 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:48.911773 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:38:48.911773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:38:48.911773 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:48.915045 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:48.916130 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:48.917269 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:48.918237 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:48.918237 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:38:48.918237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.919136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:48.919136 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:48.919136 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.921132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:48.922132 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:38:48.922132 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:38:48.923132 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:38:48.923132 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.923132 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:48.924395 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:48.924395 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:38:48.925393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:38:48.925393 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:48.928528 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:48.928528 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:48.930565 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:48.931456 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:48.931456 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:38:48.931456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.932571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:48.932571 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:48.932571 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.934786 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:48.936867 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:38:48.937866 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:38:48.937866 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:38:48.937866 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.938869 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:48.938869 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:48.938869 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:38:48.939867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:38:48.939867 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:48.941850 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:48.942872 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:48.944932 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:48.945971 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:48.945971 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:38:48.946972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.946972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:48.947959 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:48.947959 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.949964 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:48.950983 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:38:48.951955 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:38:48.951955 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:38:48.952971 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:38:48.952971 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:48.952971 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:48.954076 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:38:48.954076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:38:48.954076 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:48.956787 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:48.957785 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:48.958786 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:48.959785 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:48.959785 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:38:48.960787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.960787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:48.960787 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:48.960787 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.964283 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:48.965652 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:38:48.966661 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:38:48.966661 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:38:48.966661 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.967674 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:48.967674 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:48.967674 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:38:48.968672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:38:48.968672 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:48.971215 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:48.972229 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:48.973244 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:48.974245 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:48.974245 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:38:48.974245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.975373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:48.975373 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:48.975373 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.977373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:48.978372 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:38:48.979372 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:38:48.979372 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:38:48.979372 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.980373 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:48.980373 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:48.981378 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:38:48.981378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:38:48.982373 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:48.984647 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:48.985726 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:48.986726 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:48.987726 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:48.987726 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:38:48.987726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:48.988726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:48.988726 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:48.988726 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:48.990711 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:48.991726 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:38:48.991726 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:38:48.992726 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:38:48.992726 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:48.992726 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:48.993733 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:48.993733 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:38:48.993733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:38:48.993733 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:48.997154 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:48.997154 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:48.999147 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:49.000147 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:49.000147 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:38:49.000147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:49.001147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:49.001147 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:49.001147 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:38:49.002147 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:49.004446 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:38:49.005610 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:38:49.006604 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:38:49.006604 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:38:49.006604 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:49.007595 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:49.007595 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:38:49.007595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:38:49.008604 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:49.010606 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:49.011603 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:49.013491 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:49.013491 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:49.014815 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:38:49.014815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:49.014815 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:49.014815 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:49.015892 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:49.016868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:49.017973 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:38:49.017973 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:38:49.018880 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:38:49.018880 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:38:49.018880 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:49.019973 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:49.019973 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:38:49.019973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:38:49.019973 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:49.023979 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:49.023979 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:49.062073 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:49.063074 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:49.063074 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:38:49.063074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:49.064074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:49.064074 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:49.065411 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:49.066634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:49.067628 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:38:49.068608 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:38:49.068608 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:38:49.068608 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.05s]
[0m11:38:49.069602 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:49.069602 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:49.069602 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:38:49.070619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:38:49.070619 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:49.074829 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:49.076032 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:49.077032 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:49.078034 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:49.078034 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:38:49.078034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:49.079033 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:49.079033 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:49.079033 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:38:49.085440 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:38:49.086577 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:38:49.087576 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:38:49.088493 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:38:49.088493 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:38:49.088493 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:49.090462 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:49.090462 [debug] [MainThread]: On master: BEGIN
[0m11:38:49.090462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:49.091442 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:49.091442 [debug] [MainThread]: On master: COMMIT
[0m11:38:49.091442 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:49.091442 [debug] [MainThread]: On master: COMMIT
[0m11:38:49.092441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:49.092441 [debug] [MainThread]: On master: Close
[0m11:38:49.092441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:49.092441 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:49.092441 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:38:49.092441 [info ] [MainThread]: 
[0m11:38:49.093443 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:38:49.094759 [debug] [MainThread]: Command end result
[0m11:38:49.109233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:49.110285 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:49.115618 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:49.116491 [info ] [MainThread]: 
[0m11:38:49.116491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:49.116491 [info ] [MainThread]: 
[0m11:38:49.116491 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:38:49.117491 [debug] [MainThread]: Command `dbt test` succeeded at 11:38:49.117491 after 1.21 seconds
[0m11:38:49.117491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D06E1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1CFC5F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1CE2C32C0>]}
[0m11:38:49.117491 [debug] [MainThread]: Flushing usage events
[0m11:38:49.955761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:51.907625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B59A7E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B8653C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B8652390>]}


============================== 11:38:51.911640 | 75ea0023-6e74-4c9e-9200-782243e0a30e ==============================
[0m11:38:51.911640 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:51.912624 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt test', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m11:38:52.100930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75ea0023-6e74-4c9e-9200-782243e0a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B8D9E990>]}
[0m11:38:52.153191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75ea0023-6e74-4c9e-9200-782243e0a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B647C590>]}
[0m11:38:52.154189 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:52.387321 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:52.474832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:52.476034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:52.511648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75ea0023-6e74-4c9e-9200-782243e0a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B8D4DA30>]}
[0m11:38:52.573706 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:52.575848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:52.598299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ea0023-6e74-4c9e-9200-782243e0a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BA89CA70>]}
[0m11:38:52.599188 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:52.599188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ea0023-6e74-4c9e-9200-782243e0a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B8D4DFA0>]}
[0m11:38:52.601298 [info ] [MainThread]: 
[0m11:38:52.601742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:52.601742 [info ] [MainThread]: 
[0m11:38:52.601742 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:52.609027 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stage'
[0m11:38:52.671145 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:52.671145 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:52.671145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:52.684285 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:38:52.684285 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:52.685297 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:52.695513 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:38:52.697524 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:52.698521 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:52.699553 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:52.699553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_stage, now list_warehouse_main_marts)
[0m11:38:52.701521 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:52.701521 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:52.701521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:52.701521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:52.702518 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:52.702518 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:52.704517 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:38:52.705528 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:52.705528 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:52.706514 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:52.706514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ea0023-6e74-4c9e-9200-782243e0a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BA93B920>]}
[0m11:38:52.707514 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:52.707514 [debug] [MainThread]: On master: BEGIN
[0m11:38:52.707514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:52.707514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:52.707514 [debug] [MainThread]: On master: COMMIT
[0m11:38:52.708535 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:52.708535 [debug] [MainThread]: On master: COMMIT
[0m11:38:52.708535 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:52.708535 [debug] [MainThread]: On master: Close
[0m11:38:52.712512 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:52.712512 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:38:52.712512 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:52.712512 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:52.724697 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:52.725696 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:52.736979 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:52.736979 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:52.737980 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:38:52.737980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:52.737980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.739370 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:52.739370 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.744753 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:38:52.747731 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:38:52.748732 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:52.748732 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:38:52.748732 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.04s]
[0m11:38:52.749767 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:52.749767 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:52.749767 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:38:52.750748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:38:52.750748 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:52.753747 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:52.754732 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:52.755730 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:52.756748 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:52.756748 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:38:52.757732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.758730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.758730 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:52.758730 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.762211 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:52.763215 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:38:52.764232 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:38:52.764232 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:38:52.764232 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.765232 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:52.765232 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:52.765232 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:38:52.766232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:38:52.766232 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:52.769239 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:52.770232 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:52.771215 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:52.772232 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:52.772232 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:38:52.773215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.773215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.773215 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:52.774217 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.776783 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:52.777782 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:38:52.778768 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:38:52.778768 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:38:52.778768 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.779784 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:52.779784 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:52.779784 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:38:52.780783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:38:52.780783 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:52.783781 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:52.783781 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:52.785784 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:52.786766 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:52.786766 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:38:52.786766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.787783 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.787783 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:52.788785 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.790783 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:52.791809 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:38:52.792797 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:38:52.792797 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:38:52.793797 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.793797 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:52.793797 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:52.793797 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:38:52.795223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:38:52.795223 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:52.797305 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:52.798292 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:52.799299 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:52.800602 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:52.800602 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:38:52.801578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.802289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.802289 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:52.802289 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.804820 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:52.805880 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:38:52.806877 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:38:52.806877 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:38:52.806877 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.807876 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:52.807876 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:52.807876 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:38:52.808863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:38:52.808863 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:52.812193 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:52.812193 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:52.814189 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:52.815178 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:52.815178 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:38:52.815178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.816189 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:52.816189 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:52.816189 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.818230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.819521 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:38:52.819521 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:38:52.820527 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:38:52.820527 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.821527 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:52.821527 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:52.821527 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:38:52.821527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:38:52.822541 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:52.824621 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:52.825642 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:52.826626 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:52.827626 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:52.827626 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:38:52.827626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.828647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:52.828647 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:52.828647 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.830638 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:52.833641 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:38:52.834625 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:38:52.834625 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:38:52.835640 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.835640 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:52.836660 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:52.836660 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:38:52.836660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:38:52.837661 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:52.839660 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:52.840660 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:52.843661 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:52.843661 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:52.844669 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:38:52.844669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.845881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.845881 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:52.846901 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.848882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.849898 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:38:52.849898 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:38:52.851180 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:38:52.851180 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:38:52.851180 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:52.852184 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:52.852184 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:38:52.852184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:38:52.853223 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:52.855201 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:52.856200 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:52.858201 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:52.858201 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:52.858201 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:38:52.859433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.859433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:52.859433 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:52.860473 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.862448 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:52.863449 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:38:52.864479 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:38:52.864479 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:38:52.865464 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.865464 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:52.865464 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:52.866540 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:38:52.866540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:38:52.866540 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:52.869130 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:52.870119 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:52.872114 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:52.873101 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:52.873101 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:38:52.873101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.873101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:52.874097 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:52.874097 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.875259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.876261 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:38:52.877299 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:38:52.877299 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:38:52.878292 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.878292 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:52.878292 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:52.879294 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:38:52.879294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:38:52.879294 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:52.882276 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:52.882276 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:52.883420 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:52.884561 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:52.884561 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:38:52.885556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.885556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.885556 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:52.886540 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.887564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.888548 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:38:52.888548 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:38:52.889556 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:38:52.889556 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:52.890539 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:52.890539 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:52.890539 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:38:52.890539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:38:52.891642 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:52.893647 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:52.894663 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:52.896663 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:52.896663 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:52.897649 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:38:52.897649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.897649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:52.897649 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:52.898649 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.898649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.901161 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:38:52.901161 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:38:52.902180 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:38:52.902180 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:38:52.903176 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:52.903176 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:52.904220 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:38:52.904220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:38:52.904220 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:52.908224 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:52.909233 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:52.911233 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:52.912232 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:52.913229 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:38:52.913229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.914230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.914230 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:52.914230 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.915662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.916703 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:38:52.917703 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:38:52.917703 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:38:52.918703 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:38:52.918703 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:52.918703 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:52.919702 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:38:52.919702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:38:52.919702 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:52.923162 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:52.924183 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:52.962564 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:52.964058 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:52.964058 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:38:52.964058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.965150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.965150 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:52.965150 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:52.966257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.968257 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:38:52.968257 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:38:52.969257 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:38:52.969257 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.05s]
[0m11:38:52.969257 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:52.970244 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:52.970244 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:38:52.971243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:38:52.971243 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:52.975755 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:52.978330 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:52.980831 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:52.981822 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:52.981822 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:38:52.981822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:52.982798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:52.982798 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:52.982798 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:38:52.988401 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:38:52.989420 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:38:52.990417 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:38:52.991403 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:38:52.991403 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:38:52.991403 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:52.992400 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:52.992400 [debug] [MainThread]: On master: BEGIN
[0m11:38:52.992400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:52.993558 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:52.993558 [debug] [MainThread]: On master: COMMIT
[0m11:38:52.993558 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:52.993558 [debug] [MainThread]: On master: COMMIT
[0m11:38:52.994571 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:52.994571 [debug] [MainThread]: On master: Close
[0m11:38:52.994571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:52.994571 [debug] [MainThread]: Connection 'list_warehouse_main_marts' was properly closed.
[0m11:38:52.995573 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:38:52.995573 [info ] [MainThread]: 
[0m11:38:52.995573 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:38:52.997572 [debug] [MainThread]: Command end result
[0m11:38:53.018670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:53.021783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:53.029685 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:53.030775 [info ] [MainThread]: 
[0m11:38:53.030775 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:53.031771 [info ] [MainThread]: 
[0m11:38:53.032714 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:38:53.033791 [debug] [MainThread]: Command `dbt test` succeeded at 11:38:53.033791 after 1.24 seconds
[0m11:38:53.033791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B7FAD6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B7FAEDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B8998D10>]}
[0m11:38:53.034729 [debug] [MainThread]: Flushing usage events
[0m11:38:54.051733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:55.962691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C09A38C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C105F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242BEBFEDE0>]}


============================== 11:38:55.967396 | 03ae0fee-1ba4-463e-994d-c0334cc388a4 ==============================
[0m11:38:55.967396 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:55.968457 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:38:56.162499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03ae0fee-1ba4-463e-994d-c0334cc388a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C24EA480>]}
[0m11:38:56.229984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03ae0fee-1ba4-463e-994d-c0334cc388a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C07DBAA0>]}
[0m11:38:56.233713 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:38:56.522891 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:56.621708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:56.622693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:56.649077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03ae0fee-1ba4-463e-994d-c0334cc388a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C2DD49B0>]}
[0m11:38:56.698401 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:56.699871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:56.723163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03ae0fee-1ba4-463e-994d-c0334cc388a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C24EB470>]}
[0m11:38:56.724177 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:38:56.724177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ae0fee-1ba4-463e-994d-c0334cc388a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C2DD4890>]}
[0m11:38:56.725193 [info ] [MainThread]: 
[0m11:38:56.726193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:56.726193 [info ] [MainThread]: 
[0m11:38:56.726193 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:38:56.730193 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:38:56.791986 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:56.791986 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:38:56.791986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:56.803991 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:38:56.803991 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:38:56.803991 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:56.815184 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:38:56.817184 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:38:56.818199 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:38:56.818199 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:38:56.818199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:38:56.820293 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:56.820293 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:38:56.820293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:56.821292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:38:56.821292 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:38:56.821292 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:38:56.824507 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:38:56.825541 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:38:56.825541 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:38:56.826523 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:38:56.826523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ae0fee-1ba4-463e-994d-c0334cc388a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C257F710>]}
[0m11:38:56.827531 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:56.827531 [debug] [MainThread]: On master: BEGIN
[0m11:38:56.827531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:56.827531 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:56.828522 [debug] [MainThread]: On master: COMMIT
[0m11:38:56.828522 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:56.828522 [debug] [MainThread]: On master: COMMIT
[0m11:38:56.828522 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:56.829522 [debug] [MainThread]: On master: Close
[0m11:38:56.831977 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:56.831977 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:38:56.831977 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:56.833019 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:56.844382 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:56.845366 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:56.856867 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:56.857866 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:56.857866 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:38:56.859229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:56.859229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:56.859229 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:38:56.859229 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.865240 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:38:56.868256 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:38:56.869257 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:38:56.869257 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:38:56.870256 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.04s]
[0m11:38:56.870256 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:38:56.870256 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:56.871255 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:38:56.871255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:38:56.871255 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:56.874239 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:56.875239 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:56.878256 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:56.879762 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:56.879762 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:38:56.880784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.880784 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:56.881782 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:38:56.881782 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.886766 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:38:56.887783 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:38:56.887783 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:38:56.888783 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:38:56.888783 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.02s]
[0m11:38:56.889766 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:38:56.889766 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:56.889766 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:38:56.890768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:38:56.890768 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:56.895294 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:56.896293 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:56.897293 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:56.898290 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:56.898290 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:38:56.899277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.899277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:56.899277 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:38:56.899277 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.902034 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:56.904047 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:38:56.904047 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:38:56.904047 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:38:56.905268 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.01s]
[0m11:38:56.905268 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:38:56.906366 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:56.906366 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:38:56.906366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:38:56.907366 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:56.909746 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:56.909746 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:56.911754 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:56.912752 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:56.912752 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:38:56.912752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.913753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:56.913753 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:38:56.913753 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.917132 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:56.918150 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:38:56.918150 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:38:56.919149 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:38:56.919149 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:56.920149 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:38:56.920149 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:56.920149 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:38:56.921133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:38:56.921133 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:56.923133 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:56.924352 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:56.925365 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:56.926365 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:56.926365 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:38:56.926365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.927368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:56.927368 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:38:56.927368 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.929382 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:56.930866 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:38:56.932125 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:38:56.932125 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:38:56.932125 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:56.933159 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:38:56.933159 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:56.933159 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:38:56.934136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:38:56.934136 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:56.936224 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:56.937198 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:56.938214 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:56.939717 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:56.939717 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:38:56.939717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.940720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:56.940720 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:38:56.940720 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.942722 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:56.943721 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:38:56.944737 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:38:56.944737 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:38:56.944737 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:56.945738 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:38:56.945738 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:56.945738 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:38:56.945738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:38:56.945738 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:56.949464 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:56.950489 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:56.951487 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:56.952481 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:56.952481 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:38:56.952481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.954469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:56.954469 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:38:56.954469 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.956694 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:56.957696 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:38:56.958732 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:38:56.958732 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:38:56.959712 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m11:38:56.959712 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:38:56.959712 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:56.960710 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:38:56.960710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:38:56.960710 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:56.964273 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:56.965295 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:56.966301 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:56.967567 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:56.967567 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:38:56.967567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.968577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:56.968577 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:38:56.968577 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.970677 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:56.971979 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:38:56.971979 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:38:56.973018 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:38:56.973018 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:38:56.973018 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:38:56.973992 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:56.973992 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:38:56.973992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:38:56.973992 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:56.977214 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:56.978250 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:56.979766 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:56.979766 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:56.979766 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:38:56.980789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.980789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:56.980789 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:38:56.981786 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.983771 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:38:56.984983 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:38:56.986075 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:38:56.986075 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:38:56.986075 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.01s]
[0m11:38:56.987273 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:38:56.987273 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:56.987273 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:38:56.987273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:38:56.988304 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:56.990303 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:56.991310 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:56.993302 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:56.993302 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:56.994301 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:38:56.994301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.994301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:56.995303 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:38:56.995303 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:38:56.997394 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:38:56.998388 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:38:56.998388 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:38:56.998388 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:38:56.999387 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:38:56.999387 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:38:56.999387 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:57.000387 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:38:57.000387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:38:57.000387 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:57.003612 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:57.003612 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:57.006023 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:57.006023 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:57.007024 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:38:57.007024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:57.007024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:57.008023 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:38:57.008023 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:38:57.009023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:57.010023 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:38:57.012008 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:38:57.013045 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:38:57.014155 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:38:57.014155 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:38:57.015173 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:57.015173 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:38:57.016334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:38:57.016334 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:57.019574 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:57.019574 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:57.021631 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:57.021631 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:57.022629 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:38:57.022629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:57.022629 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:57.023613 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:38:57.023613 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:38:57.024629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:57.025613 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:38:57.026612 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:38:57.027630 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:38:57.028629 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:38:57.028629 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:38:57.029629 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:57.029629 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:38:57.029629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:38:57.030629 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:57.033031 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:57.034054 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:57.036053 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:57.036053 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:57.037052 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:38:57.037052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:57.037052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:57.038035 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:38:57.038035 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:38:57.039058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:57.040058 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:38:57.041053 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:38:57.041053 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:38:57.041053 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:38:57.041053 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:38:57.042051 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:57.042051 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:38:57.042051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:38:57.043049 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:57.046045 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:57.046045 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:57.086666 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:57.087674 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:57.087674 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:38:57.087674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:57.088681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:57.088681 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:38:57.088681 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:38:57.089673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:38:57.090654 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:38:57.091671 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:38:57.091671 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:38:57.092670 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.05s]
[0m11:38:57.092670 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:38:57.092670 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:57.093672 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:38:57.094870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:38:57.094870 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:57.099009 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:57.100097 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:57.102138 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:57.102138 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:57.103098 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:38:57.103098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:57.103098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:38:57.103098 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:38:57.104503 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:38:57.111292 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:38:57.112307 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:38:57.113292 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:38:57.113292 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:38:57.113292 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:38:57.114292 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:38:57.115562 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:57.115562 [debug] [MainThread]: On master: BEGIN
[0m11:38:57.115562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:57.116560 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:57.116560 [debug] [MainThread]: On master: COMMIT
[0m11:38:57.116560 [debug] [MainThread]: Using duckdb connection "master"
[0m11:38:57.116560 [debug] [MainThread]: On master: COMMIT
[0m11:38:57.116560 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:38:57.117559 [debug] [MainThread]: On master: Close
[0m11:38:57.117559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:57.117559 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:38:57.117559 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:38:57.117559 [info ] [MainThread]: 
[0m11:38:57.117559 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:38:57.119577 [debug] [MainThread]: Command end result
[0m11:38:57.133576 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:38:57.134759 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:38:57.140940 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:38:57.140940 [info ] [MainThread]: 
[0m11:38:57.140940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:57.141938 [info ] [MainThread]: 
[0m11:38:57.141938 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:38:57.141938 [debug] [MainThread]: Command `dbt test` succeeded at 11:38:57.141938 after 1.31 seconds
[0m11:38:57.142937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C09F6D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C0AA5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C07D8E60>]}
[0m11:38:57.142937 [debug] [MainThread]: Flushing usage events
[0m11:38:58.147077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:05.606287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213CD845B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D080E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D080D880>]}


============================== 11:39:05.609309 | 130a93e6-9f3e-4bc7-af36-76c1e990d0ec ==============================
[0m11:39:05.609309 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:39:05.610305 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\dev\\tv_audience_mini_pipeline\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\delma\\.dbt', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:39:05.799329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '130a93e6-9f3e-4bc7-af36-76c1e990d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D15AFAA0>]}
[0m11:39:05.855561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '130a93e6-9f3e-4bc7-af36-76c1e990d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213CE577FE0>]}
[0m11:39:05.857959 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:39:06.086319 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:39:06.177267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:06.178170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:06.205010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '130a93e6-9f3e-4bc7-af36-76c1e990d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D270A300>]}
[0m11:39:06.252845 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:39:06.254586 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:39:06.277943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '130a93e6-9f3e-4bc7-af36-76c1e990d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D2DF7740>]}
[0m11:39:06.277943 [info ] [MainThread]: Found 4 models, 15 data tests, 444 macros
[0m11:39:06.277943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '130a93e6-9f3e-4bc7-af36-76c1e990d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D315E120>]}
[0m11:39:06.280056 [info ] [MainThread]: 
[0m11:39:06.280056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:06.280056 [info ] [MainThread]: 
[0m11:39:06.281057 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:39:06.285272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_marts'
[0m11:39:06.351011 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:39:06.352011 [debug] [ThreadPool]: On list_warehouse_main_marts: BEGIN
[0m11:39:06.352011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:06.365542 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:39:06.365542 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_marts"
[0m11:39:06.365542 [debug] [ThreadPool]: On list_warehouse_main_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_marts"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'warehouse'
  
[0m11:39:06.377120 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:39:06.378043 [debug] [ThreadPool]: On list_warehouse_main_marts: ROLLBACK
[0m11:39:06.379118 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_marts'
[0m11:39:06.379995 [debug] [ThreadPool]: On list_warehouse_main_marts: Close
[0m11:39:06.379995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse_main_marts, now list_warehouse_main_stage)
[0m11:39:06.381994 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:39:06.381994 [debug] [ThreadPool]: On list_warehouse_main_stage: BEGIN
[0m11:39:06.381994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:06.382998 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:06.382998 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stage"
[0m11:39:06.382998 [debug] [ThreadPool]: On list_warehouse_main_stage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "connection_name": "list_warehouse_main_stage"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stage'
    and lower(table_catalog) = 'warehouse'
  
[0m11:39:06.385565 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:39:06.386439 [debug] [ThreadPool]: On list_warehouse_main_stage: ROLLBACK
[0m11:39:06.387441 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stage'
[0m11:39:06.387441 [debug] [ThreadPool]: On list_warehouse_main_stage: Close
[0m11:39:06.388439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '130a93e6-9f3e-4bc7-af36-76c1e990d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213CE4EBC80>]}
[0m11:39:06.388439 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:06.388439 [debug] [MainThread]: On master: BEGIN
[0m11:39:06.388439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:06.389440 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:06.389440 [debug] [MainThread]: On master: COMMIT
[0m11:39:06.389440 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:06.389440 [debug] [MainThread]: On master: COMMIT
[0m11:39:06.390439 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:06.390439 [debug] [MainThread]: On master: Close
[0m11:39:06.394100 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:39:06.394100 [info ] [Thread-1 (]: 1 of 15 START test not_null_fact_audience_channel_std .......................... [RUN]
[0m11:39:06.394933 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:39:06.394933 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:39:06.407762 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:39:06.407762 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:39:06.420241 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:39:06.420241 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:39:06.421195 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: BEGIN
[0m11:39:06.421195 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:39:06.421195 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.422195 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"
[0m11:39:06.422195 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_marts"."fact_audience"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.431351 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:39:06.434406 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: ROLLBACK
[0m11:39:06.435469 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d'
[0m11:39:06.436598 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d: Close
[0m11:39:06.436598 [info ] [Thread-1 (]: 1 of 15 PASS not_null_fact_audience_channel_std ................................ [[32mPASS[0m in 0.04s]
[0m11:39:06.436598 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d
[0m11:39:06.437526 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:39:06.437526 [info ] [Thread-1 (]: 2 of 15 START test not_null_fact_audience_country .............................. [RUN]
[0m11:39:06.437526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_channel_std.101a7b717d, now test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e)
[0m11:39:06.437526 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:39:06.440907 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:39:06.441817 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:39:06.443913 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:39:06.443913 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:39:06.445310 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: BEGIN
[0m11:39:06.445310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.446062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.446062 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"
[0m11:39:06.446062 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_marts"."fact_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.449255 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:06.450307 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: ROLLBACK
[0m11:39:06.450307 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e'
[0m11:39:06.450307 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e: Close
[0m11:39:06.451394 [info ] [Thread-1 (]: 2 of 15 PASS not_null_fact_audience_country .................................... [[32mPASS[0m in 0.01s]
[0m11:39:06.451394 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e
[0m11:39:06.451394 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:39:06.452324 [info ] [Thread-1 (]: 3 of 15 START test not_null_fact_audience_date ................................. [RUN]
[0m11:39:06.452324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_country.58dd3f1f3e, now test.tv_audience_mini.not_null_fact_audience_date.94a03c3829)
[0m11:39:06.452324 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:39:06.455969 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:39:06.457101 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:39:06.458104 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:39:06.459099 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:39:06.459099 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: BEGIN
[0m11:39:06.460104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.460104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.460104 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"
[0m11:39:06.461011 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_date.94a03c3829"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_marts"."fact_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.462970 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:06.464097 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: ROLLBACK
[0m11:39:06.465083 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_date.94a03c3829'
[0m11:39:06.465083 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_date.94a03c3829: Close
[0m11:39:06.466191 [info ] [Thread-1 (]: 3 of 15 PASS not_null_fact_audience_date ....................................... [[32mPASS[0m in 0.01s]
[0m11:39:06.466191 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_date.94a03c3829
[0m11:39:06.466191 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:39:06.467179 [info ] [Thread-1 (]: 4 of 15 START test not_null_fact_audience_program .............................. [RUN]
[0m11:39:06.467179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_date.94a03c3829, now test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b)
[0m11:39:06.467179 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:39:06.470165 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:39:06.471190 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:39:06.473162 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:39:06.473162 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:39:06.474328 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: BEGIN
[0m11:39:06.474328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.474328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.474328 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"
[0m11:39:06.475527 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_marts"."fact_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.477536 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:39:06.478514 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: ROLLBACK
[0m11:39:06.479516 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b'
[0m11:39:06.479516 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b: Close
[0m11:39:06.480513 [info ] [Thread-1 (]: 4 of 15 PASS not_null_fact_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:39:06.480513 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b
[0m11:39:06.480513 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:39:06.481513 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_audience_viewers .............................. [RUN]
[0m11:39:06.481513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_program.5306c92f5b, now test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf)
[0m11:39:06.481513 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:39:06.484581 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:39:06.484581 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:39:06.486698 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:39:06.487697 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:39:06.487697 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: BEGIN
[0m11:39:06.487697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.488695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.488695 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"
[0m11:39:06.488695 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_marts"."fact_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.490683 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:06.492204 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: ROLLBACK
[0m11:39:06.493235 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf'
[0m11:39:06.493235 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf: Close
[0m11:39:06.493235 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:39:06.494233 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf
[0m11:39:06.494233 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:39:06.495467 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_audience_channel ............................... [RUN]
[0m11:39:06.495467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_fact_audience_viewers.11b475f4bf, now test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1)
[0m11:39:06.495467 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:39:06.498488 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:39:06.499483 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:39:06.500483 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:39:06.501481 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:39:06.501481 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: BEGIN
[0m11:39:06.501481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.502482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.502482 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"
[0m11:39:06.502482 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "warehouse"."main_stage"."stg_audience"
where channel is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.504549 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:06.506604 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: ROLLBACK
[0m11:39:06.507621 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1'
[0m11:39:06.508620 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1: Close
[0m11:39:06.508620 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_audience_channel ..................................... [[32mPASS[0m in 0.01s]
[0m11:39:06.510085 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1
[0m11:39:06.511088 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:39:06.511088 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_audience_country ............................... [RUN]
[0m11:39:06.511088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_channel.0eebcf15b1, now test.tv_audience_mini.not_null_stg_audience_country.813d4b1670)
[0m11:39:06.512117 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:39:06.514109 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:39:06.515324 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:39:06.516323 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:39:06.517323 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:39:06.517323 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: BEGIN
[0m11:39:06.517323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.518307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.518307 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"
[0m11:39:06.518307 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_country.813d4b1670"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_audience"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.520323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.521323 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: ROLLBACK
[0m11:39:06.522322 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_country.813d4b1670'
[0m11:39:06.522322 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_country.813d4b1670: Close
[0m11:39:06.522322 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_audience_country ..................................... [[32mPASS[0m in 0.01s]
[0m11:39:06.523323 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_country.813d4b1670
[0m11:39:06.523323 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:39:06.523323 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_audience_date .................................. [RUN]
[0m11:39:06.523323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_country.813d4b1670, now test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61)
[0m11:39:06.524522 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:39:06.527097 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:39:06.527097 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:39:06.530515 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:39:06.530515 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:39:06.530515 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: BEGIN
[0m11:39:06.531531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.531531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.532530 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"
[0m11:39:06.532530 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_stage"."stg_audience"
where date is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.533529 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:06.534692 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: ROLLBACK
[0m11:39:06.535818 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61'
[0m11:39:06.535818 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61: Close
[0m11:39:06.536817 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_audience_date ........................................ [[32mPASS[0m in 0.01s]
[0m11:39:06.536817 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61
[0m11:39:06.536817 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:39:06.537818 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_audience_loaded_at ............................. [RUN]
[0m11:39:06.537818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_date.3cb60fdc61, now test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5)
[0m11:39:06.537818 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:39:06.540821 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:39:06.541806 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:39:06.543958 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:39:06.545127 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:39:06.545127 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: BEGIN
[0m11:39:06.546237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.546237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.547236 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"
[0m11:39:06.547236 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loaded_at
from "warehouse"."main_stage"."stg_audience"
where loaded_at is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.551237 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:39:06.552260 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: ROLLBACK
[0m11:39:06.553237 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5'
[0m11:39:06.553237 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5: Close
[0m11:39:06.554386 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_audience_loaded_at ................................... [[32mPASS[0m in 0.02s]
[0m11:39:06.554386 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5
[0m11:39:06.554386 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:39:06.554386 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_audience_program .............................. [RUN]
[0m11:39:06.555584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_loaded_at.65099cebc5, now test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8)
[0m11:39:06.555584 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:39:06.558586 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:39:06.559586 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:39:06.560620 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:39:06.560620 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:39:06.561603 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: BEGIN
[0m11:39:06.561603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.561603 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.562584 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"
[0m11:39:06.562584 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select program
from "warehouse"."main_stage"."stg_audience"
where program is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.563600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.564810 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: ROLLBACK
[0m11:39:06.565950 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8'
[0m11:39:06.565950 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8: Close
[0m11:39:06.566933 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_audience_program .................................... [[32mPASS[0m in 0.01s]
[0m11:39:06.566933 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8
[0m11:39:06.566933 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:39:06.567951 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_audience_viewers .............................. [RUN]
[0m11:39:06.567951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_program.97d567a3c8, now test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161)
[0m11:39:06.567951 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:39:06.570950 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:39:06.571950 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:39:06.573321 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:39:06.574327 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:39:06.574327 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: BEGIN
[0m11:39:06.574327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.574327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.575438 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"
[0m11:39:06.575438 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select viewers
from "warehouse"."main_stage"."stg_audience"
where viewers is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.576454 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.577483 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: ROLLBACK
[0m11:39:06.578480 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161'
[0m11:39:06.578480 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161: Close
[0m11:39:06.579478 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_audience_viewers .................................... [[32mPASS[0m in 0.01s]
[0m11:39:06.579478 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161
[0m11:39:06.579478 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:39:06.580478 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_dim_channels_alias ............................ [RUN]
[0m11:39:06.580478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_audience_viewers.4e7873b161, now test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b)
[0m11:39:06.580478 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:39:06.583478 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:39:06.584607 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:39:06.585744 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:39:06.586744 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:39:06.586744 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: BEGIN
[0m11:39:06.586744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.588064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.588064 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"
[0m11:39:06.588064 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select alias
from "warehouse"."main_stage"."stg_dim_channels"
where alias is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.589088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.590104 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: ROLLBACK
[0m11:39:06.591107 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b'
[0m11:39:06.591107 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b: Close
[0m11:39:06.591107 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_dim_channels_alias .................................. [[32mPASS[0m in 0.01s]
[0m11:39:06.592106 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b
[0m11:39:06.592612 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:39:06.592612 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_dim_channels_channel_std ...................... [RUN]
[0m11:39:06.592612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_alias.e3e48fd22b, now test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f)
[0m11:39:06.593659 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:39:06.595900 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:39:06.595900 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:39:06.597899 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:39:06.598905 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:39:06.598905 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: BEGIN
[0m11:39:06.598905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.599893 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:06.599893 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"
[0m11:39:06.599893 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_std
from "warehouse"."main_stage"."stg_dim_channels"
where channel_std is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.600907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.601902 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: ROLLBACK
[0m11:39:06.602899 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f'
[0m11:39:06.602899 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f: Close
[0m11:39:06.602899 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_dim_channels_channel_std ............................ [[32mPASS[0m in 0.01s]
[0m11:39:06.603885 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f
[0m11:39:06.603885 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:39:06.603885 [info ] [Thread-1 (]: 14 of 15 START test not_null_stg_dim_channels_country .......................... [RUN]
[0m11:39:06.603885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_channel_std.f877b9e62f, now test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51)
[0m11:39:06.604998 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:39:06.608059 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:39:06.609068 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:39:06.646201 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:39:06.647200 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:39:06.648201 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: BEGIN
[0m11:39:06.648201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.649185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.650013 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"
[0m11:39:06.650013 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "warehouse"."main_stage"."stg_dim_channels"
where country is null



  
  
      
    ) dbt_internal_test
[0m11:39:06.651183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.652264 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: ROLLBACK
[0m11:39:06.653264 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51'
[0m11:39:06.653264 [debug] [Thread-1 (]: On test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51: Close
[0m11:39:06.653264 [info ] [Thread-1 (]: 14 of 15 PASS not_null_stg_dim_channels_country ................................ [[32mPASS[0m in 0.05s]
[0m11:39:06.654473 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51
[0m11:39:06.654473 [debug] [Thread-1 (]: Began running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:39:06.654473 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_audience__date_country_channel_std_program_ .... [RUN]
[0m11:39:06.655625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tv_audience_mini.not_null_stg_dim_channels_country.ed39871f51, now test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5)
[0m11:39:06.655625 [debug] [Thread-1 (]: Began compiling node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:39:06.659641 [debug] [Thread-1 (]: Writing injected SQL for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:39:06.660641 [debug] [Thread-1 (]: Began executing node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:39:06.662641 [debug] [Thread-1 (]: Writing runtime sql for node "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:39:06.662641 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:39:06.663629 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: BEGIN
[0m11:39:06.663629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.663629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:06.664663 [debug] [Thread-1 (]: Using duckdb connection "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"
[0m11:39:06.664663 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "tv_audience_profile", "target_name": "dev", "node_id": "test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    (date, country, channel_std, program) as unique_field,
    count(*) as n_records

from "warehouse"."main_marts"."fact_audience"
where (date, country, channel_std, program) is not null
group by (date, country, channel_std, program)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:39:06.671423 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:06.673439 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: ROLLBACK
[0m11:39:06.674666 [debug] [Thread-1 (]: Failed to rollback 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5'
[0m11:39:06.674666 [debug] [Thread-1 (]: On test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5: Close
[0m11:39:06.675842 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_audience__date_country_channel_std_program_ .......... [[32mPASS[0m in 0.02s]
[0m11:39:06.676843 [debug] [Thread-1 (]: Finished running node test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5
[0m11:39:06.677863 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:06.678874 [debug] [MainThread]: On master: BEGIN
[0m11:39:06.678874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:06.678874 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:06.678874 [debug] [MainThread]: On master: COMMIT
[0m11:39:06.679868 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:06.679868 [debug] [MainThread]: On master: COMMIT
[0m11:39:06.679868 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:06.679868 [debug] [MainThread]: On master: Close
[0m11:39:06.679868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:06.680852 [debug] [MainThread]: Connection 'list_warehouse_main_stage' was properly closed.
[0m11:39:06.680852 [debug] [MainThread]: Connection 'test.tv_audience_mini.unique_fact_audience__date_country_channel_std_program_.9687aeb8f5' was properly closed.
[0m11:39:06.680852 [info ] [MainThread]: 
[0m11:39:06.680852 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:39:06.682851 [debug] [MainThread]: Command end result
[0m11:39:06.697103 [debug] [MainThread]: Wrote artifact WritableManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\manifest.json
[0m11:39:06.699104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\dev\tv_audience_mini_pipeline\dbt_project\target\semantic_manifest.json
[0m11:39:06.703122 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\dev\tv_audience_mini_pipeline\dbt_project\target\run_results.json
[0m11:39:06.704292 [info ] [MainThread]: 
[0m11:39:06.704292 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:06.704292 [info ] [MainThread]: 
[0m11:39:06.704292 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m11:39:06.705270 [debug] [MainThread]: Command `dbt test` succeeded at 11:39:06.705270 after 1.21 seconds
[0m11:39:06.705270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D080E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D3586060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D0833E90>]}
[0m11:39:06.705270 [debug] [MainThread]: Flushing usage events
[0m11:39:07.569446 [debug] [MainThread]: An error was encountered while trying to flush usage events
